function ConcretePanel(e){"use strict";this.options=e,this.isOpen=!1,this.detail=!1,this.isPinned=!1,this.pinned=function(){return this.isPinned},this.willBePinned=function(){return this.isOpen&&!this.isPinned},this.isPinable=function(){return this.options.pinable},this.getPositionClass=function(){var t;switch(e.position){case"left":t="ccm-panel-left";break;case"right":t="ccm-panel-right"}switch(e.transition){case"slide":t+=" ccm-panel-transition-slide";break;default:t+=" ccm-panel-transition-none"}return t},this.getURL=function(){return this.options.url},this.getCurrentURL=function(){return this.options.currentUrl},this.getIdentifier=function(){return this.options.identifier},this.getDOMID=function(){return"ccm-panel-"+this.options.identifier.replace("/","-")},this.onPanelLoad=function(e){var t=$("a[data-launch-panel="+this.getIdentifier()+"]");this.setupSubPanels(),this.setupPanelDetails(),t.removeClass().addClass("ccm-launch-panel-active"),Concrete.event.publish("PanelLoad",{panel:this,element:e})},this.hide=function(e){e=e||$.noop;var t=this;this.closePanelDetail(function(){var i=this,n=$("a[data-launch-panel="+this.getIdentifier()+"]");n.removeClass(),$("#"+i.getDOMID()).removeClass("ccm-panel-active"),$("#ccm-panel-overlay").queue(function(){$(this).removeClass("ccm-panel-translucent"),$(this).dequeue()}).delay(1e3).hide(0),html.removeClass(i.getPositionClass()),html.removeClass("ccm-panel-open"),i.isOpen=!1,$(this).dequeue(),e.call(t),Concrete.event.publish("PanelClose",{panel:this})})},this.toggle=function(){this.isOpen?this.options.pinable?this.isPinned?(this.isPinned=!1,this.hide()):this.isPinned=!0:this.hide():this.show()},this.setupSubPanels=function(){var e=$("#"+this.getDOMID()),t=this;e.find("[data-launch-sub-panel-url]").unbind(".sub").on("click.sub",function(){var i=$("<div />").addClass("ccm-panel-cover").appendTo($(this).closest(".ccm-panel"));t.closePanelDetailImmediately();var n=$(this).attr("data-launch-sub-panel-url");return $("<div />",{"class":"ccm-panel-content ccm-panel-content-appearing"}).appendTo(e.find(".ccm-panel-content-wrapper")).load(n+"?cID="+CCM_CID,function(){_.delay(function(){i.remove()},250),e.find(".ccm-panel-content-visible").removeClass("ccm-panel-content-visible").addClass("ccm-panel-slide-left"),$(this).removeClass("ccm-panel-content-appearing").addClass("ccm-panel-content-visible"),t.options.currentUrl=n,t.onPanelLoad(this)}),$(this).removeClass("ccm-panel-menu-item-active"),!1}),e.find("[data-panel-navigation=back]").on("click.navigate",function(){return t.goBack(),!1})},this.goBack=function(){var e=$("#"+this.getDOMID());this.closePanelDetailImmediately(),e.queue(function(){var t=e.find(".ccm-panel-content-visible").prev();e.find(".ccm-panel-content-visible").removeClass("ccm-panel-content-visible").addClass("ccm-panel-slide-right"),t.removeClass("ccm-panel-slide-left").addClass("ccm-panel-content-visible"),e.dequeue()}).delay(500).queue(function(){e.find(".ccm-panel-slide-right").remove(),e.dequeue()})},this.showPanelConfirmationMessage=function(e,t,i){var n='<div id="ccm-panel-confirmation-'+e+'" class="ccm-ui ccm-panel-confirmation-wrapper"><div class="ccm-panel-confirmation">';n+="<p>"+t+'</p><div class="ccm-panel-confirmation-buttons"></div>',n+="</div></div>",$(n).appendTo(document.body);var o=$("#ccm-panel-confirmation-"+e);o.delay(0).queue(function(){$(this).addClass("ccm-panel-confirmation-displayed"),$(this).dequeue()});for(var s=[{"class":"btn pull-left btn-link",type:"button","data-panel-confirmation-action":"cancel",text:ccmi18n.cancel}],a=0;a<i.length;a++)s.push(i[a]);$.each(s,function(e,t){o.find(".ccm-panel-confirmation-buttons").append($("<button />",t))}),o.find("button").on("click",function(){o.delay(0).queue(function(){o.removeClass("ccm-panel-confirmation-displayed"),o.addClass("ccm-panel-confirmation-disappearing"),$(this).dequeue()}).delay(350).queue(function(){o.remove()})})},this.closePanelDetail=function(e){e=e||$.noop;var t=this;if(!this.detail)return e.call(t),!1;$("a[data-launch-panel-detail="+this.detail.identifier+"]").removeClass("ccm-panel-menu-item-active");var i=this.detail.transition;return $("div.ccm-panel-detail").queue(function(){$(this).removeClass("ccm-panel-detail-transition-"+i+"-apply"),$(this).dequeue()}).delay(550).queue(function(){$(this).remove(),$(this).dequeue()}),$("div.ccm-page").queue(function(){$(this).removeClass("ccm-panel-detail-transition-"+i+"-apply"),$(this).dequeue()}).delay(550).queue(function(){html.removeClass("ccm-panel-detail-open"),$(this).addClass("ccm-panel-detail-disable-transition"),$(this).dequeue()}).delay(1).queue(function(){$(this).removeClass("ccm-panel-detail-transition-"+i),$(this).dequeue()}).delay(1).queue(function(){$(this).removeClass("ccm-panel-detail-disable-transition"),$(this).dequeue(),e.call(t)}),$("#ccm-panel-detail-form-actions-wrapper .ccm-panel-detail-form-actions").queue(function(){$(this).css("opacity",0),$(this).dequeue(0)}).delay(550).queue(function(){$(this).remove(),$(this).dequeue()}),Concrete.event.publish("PanelCloseDetail",this.detail),this.detail=!1,$(".ccm-panel-detail").length>0?550:void 0},this.closePanelDetailImmediately=function(){return!!this.detail&&(html.removeClass("ccm-panel-detail-open"),$(".ccm-panel-detail").remove(),$(".ccm-panel-detail-form-actions").remove(),$(".ccm-page").removeClass().addClass("ccm-page"),Concrete.event.publish("PanelCloseDetail",this.detail),void(this.detail=!1))},this.openPanelDetail=function(e){var t=this,i=$.extend({transition:"none",url:!1,data:""},e),n=i.identifier;t.detail&&t.closePanelDetailImmediately(),t.detail=i;var o="ccm-panel-detail-"+n,s=$("<div />",{id:o,"class":"ccm-panel-detail"}).appendTo(document.body),a=$("<div />",{"class":"ccm-ui ccm-ui-fieldless ccm-panel-detail-content"}).appendTo(s);$("div.ccm-page").queue(function(){s.addClass("ccm-panel-detail-transition-"+i.transition),$(this).addClass("ccm-panel-detail-transition-"+i.transition),$(this).dequeue()}).delay(3).queue(function(){s.addClass("ccm-panel-detail-transition-"+i.transition+"-apply"),$(this).addClass("ccm-panel-detail-transition-"+i.transition+"-apply"),$(this).dequeue()}),html.addClass("ccm-panel-detail-open");var r=function(){Concrete.event.publish("PanelOpenDetail",{panel:i,panelObj:t,container:a})};i.url?a.load(i.url+"?cID="+CCM_CID+i.data,function(){jQuery.fn.dialog.hideLoader(),a.find(".launch-tooltip").tooltip({container:"#ccm-tooltip-holder"}),a.find("a[data-help-notification-toggle]").concreteHelpLauncher(),t.loadPanelDetailActions(a),_.defer(r)}):(jQuery.fn.dialog.hideLoader(),a.find(".launch-tooltip").tooltip({container:"#ccm-tooltip-holder"}),a.find("a[data-help-notification-toggle]").concreteHelpLauncher(),t.loadPanelDetailActions(a),_.defer(r))},this.loadPanelDetailActions=function(e){var t=this,i=e.find(".ccm-panel-detail-form-actions");i.length&&($(document.body).delay(500).queue(function(){var e=$("#ccm-panel-detail-form-actions-wrapper");e.length||(e=$("<div />",{id:"ccm-panel-detail-form-actions-wrapper","class":"ccm-ui"}),e.appendTo(document.body)),e.html("").append(i),$(this).dequeue()}).delay(5).queue(function(){$("#ccm-panel-detail-form-actions-wrapper .ccm-panel-detail-form-actions").css("opacity",1),$(this).dequeue()}),$("button[data-panel-detail-action=cancel]").on("click",function(){t.closePanelDetail()}),e.find("[data-panel-detail-form]").concreteAjaxForm(),$("button[data-panel-detail-action=submit]").on("click",function(){$("[data-panel-detail-form]").submit()}),ConcreteEvent.subscribe("AjaxFormSubmitSuccess",function(e,t){"reload"==$('[data-panel-detail-form="'+t.form+'"]').data("action-after-save")&&location.reload()}))},this.setupPanelDetails=function(){var e=$("#"+this.getDOMID()),t=this;e.find(".launch-tooltip").tooltip({container:"#ccm-tooltip-holder"}),e.find("[data-panel-menu=accordion]").each(function(){var i=$(this),n=$(this).find(">nav>span");n.text($(this).find("a[data-panel-accordion-tab-selected=true]").text()),n.unbind(".accordion").on("click.accordion",function(){i.toggleClass("ccm-panel-header-accordion-dropdown-visible")}),$(this).find(">nav ul a").unbind(".accordion").on("click.accordion",function(){var o=t.getCurrentURL();o||(o=t.getURL());var s=e.find(".ccm-panel-content");i.removeClass("ccm-panel-header-accordion-dropdown-visible"),n.html($(this).text()),s.load(o+"?cID="+CCM_CID+"&tab="+$(this).attr("data-panel-accordion-tab"),function(){t.onPanelLoad(this)})})}),e.find(".dialog-launch").dialog(),e.find("[data-panel-menu=collapsible-list-group]").each(function(){var e,t=$(this),i=t.find(".list-group-item-collapse-wrapper"),n=t.attr("data-panel-menu-id"),o=t.find(".list-group-item-collapse span");t.find(".list-group-item-collapse").unbind(".clg").on("click.clg",function(){t.hasClass("ccm-panel-list-group-item-expanded")?(o.text(ccmi18n.expand),Concrete.event.publish("PanelCollapsibleListGroupCollapse",n),i.height(0)):(e=i.show().height("").outerHeight(),i.height(0),Concrete.event.publish("PanelCollapsibleListGroupExpand",n),o.text(ccmi18n.collapse),i.height(e)),t.toggleClass("ccm-panel-list-group-item-expanded")})}),e.find("[data-launch-panel-detail]").unbind(".detail").on("click.detail",function(){jQuery.fn.dialog.showLoader(),$(".ccm-panel-menu-item-active").removeClass("ccm-panel-menu-item-active"),$(this).addClass("ccm-panel-menu-item-active");var e=$(this).attr("data-launch-panel-detail"),i={identifier:e,target:$(this)};return $(this).attr("data-panel-transition")&&(i.transition=$(this).attr("data-panel-transition")),$(this).attr("data-panel-detail-url")&&(i.url=$(this).data("panel-detail-url")),t.openPanelDetail(i),!1}),t.loadPanelDetailActions(e)},this.show=function(e){e=e||$.noop;var t=$("#"+this.getDOMID()),i=this,n=function(){html.addClass("ccm-panel-open"),t.find(".ccm-panel-content-wrapper").html(""),t.addClass("ccm-panel-active ccm-panel-loading"),$("<div/>").addClass("ccm-panel-content ccm-panel-content-visible").appendTo(t.find(".ccm-panel-content-wrapper")).load(i.getURL()+"?cID="+CCM_CID,function(){var e=this;t.delay(1).queue(function(){$(this).removeClass("ccm-panel-loading").addClass("ccm-panel-loaded"),$(this).dequeue()}),i.onPanelLoad(t),i.isOpen=!0,Concrete.event.publish("PanelOpen",{panel:i,element:e}),i.options.overlay&&ConcretePanelManager.showOverlay(i.options.translucent)}),html.addClass(i.getPositionClass())};if(this.options.primary){var o=_(ConcretePanelManager.getPanels()).findWhere({isOpen:!0});o?o.hide(function(){n.call(this)}):n.call(this)}else n.call(this);$(".ccm-toolbar-mobile-menu-button").removeClass("ccm-mobile-close"),$(".ccm-mobile-menu-overlay").slideUp()}}!function(e,t){"function"==typeof define&&define.amd?define("pnotify",["jquery"],function(i){return t(i,e)}):"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery"),global||e):e.PNotify=t(e.jQuery,e)}(this,function(e,t){var i=function(t){var n,o,s={dir1:"down",dir2:"left",push:"bottom",spacing1:36,spacing2:36,context:e("body"),modal:!1},a=e(t),r=function(){o=e("body"),l.prototype.options.stack.context=o,a=e(t),a.bind("resize",function(){n&&clearTimeout(n),n=setTimeout(function(){l.positionAll(!0)},10)})},c=function(t){var i=e("<div />",{"class":"ui-pnotify-modal-overlay"});return i.prependTo(t.context),t.overlay_close&&i.click(function(){l.removeStack(t)}),i},l=function(e){this.parseOptions(e),this.init()};return e.extend(l.prototype,{version:"3.0.0",options:{title:!1,title_escape:!1,text:!1,text_escape:!1,styling:"brighttheme",addclass:"",cornerclass:"",auto_display:!0,width:"300px",min_height:"16px",type:"notice",icon:!0,animation:"fade",animate_speed:"normal",shadow:!0,hide:!0,delay:8e3,mouse_reset:!0,remove:!0,insert_brs:!0,destroy:!0,stack:s},modules:{},runModules:function(e,t){var i;for(var n in this.modules)i="object"==typeof t&&n in t?t[n]:t,"function"==typeof this.modules[n][e]&&(this.modules[n].notice=this,this.modules[n].options="object"==typeof this.options[n]?this.options[n]:{},this.modules[n][e](this,"object"==typeof this.options[n]?this.options[n]:{},i))},state:"initializing",timer:null,animTimer:null,styles:null,elem:null,container:null,title_container:null,text_container:null,animating:!1,timerHide:!1,init:function(){var t=this;return this.modules={},e.extend(!0,this.modules,l.prototype.modules),"object"==typeof this.options.styling?this.styles=this.options.styling:this.styles=l.styling[this.options.styling],this.elem=e("<div />",{"class":"ui-pnotify "+this.options.addclass,css:{display:"none"},"aria-live":"assertive","aria-role":"alertdialog",mouseenter:function(e){if(t.options.mouse_reset&&"out"===t.animating){if(!t.timerHide)return;t.cancelRemove()}t.options.hide&&t.options.mouse_reset&&t.cancelRemove()},mouseleave:function(e){t.options.hide&&t.options.mouse_reset&&"out"!==t.animating&&t.queueRemove(),l.positionAll()}}),"fade"===this.options.animation&&this.elem.addClass("ui-pnotify-fade-"+this.options.animate_speed),this.container=e("<div />",{"class":this.styles.container+" ui-pnotify-container "+("error"===this.options.type?this.styles.error:"info"===this.options.type?this.styles.info:"success"===this.options.type?this.styles.success:this.styles.notice),role:"alert"}).appendTo(this.elem),""!==this.options.cornerclass&&this.container.removeClass("ui-corner-all").addClass(this.options.cornerclass),this.options.shadow&&this.container.addClass("ui-pnotify-shadow"),this.options.icon!==!1&&e("<div />",{"class":"ui-pnotify-icon"}).append(e("<span />",{"class":this.options.icon===!0?"error"===this.options.type?this.styles.error_icon:"info"===this.options.type?this.styles.info_icon:"success"===this.options.type?this.styles.success_icon:this.styles.notice_icon:this.options.icon})).prependTo(this.container),this.title_container=e("<h4 />",{"class":"ui-pnotify-title"}).appendTo(this.container),this.options.title===!1?this.title_container.hide():this.options.title_escape?this.title_container.text(this.options.title):this.title_container.html(this.options.title),this.text_container=e("<div />",{"class":"ui-pnotify-text","aria-role":"alert"}).appendTo(this.container),this.options.text===!1?this.text_container.hide():this.options.text_escape?this.text_container.text(this.options.text):this.text_container.html(this.options.insert_brs?String(this.options.text).replace(/\n/g,"<br />"):this.options.text),"string"==typeof this.options.width&&this.elem.css("width",this.options.width),"string"==typeof this.options.min_height&&this.container.css("min-height",this.options.min_height),"top"===this.options.stack.push?l.notices=e.merge([this],l.notices):l.notices=e.merge(l.notices,[this]),"top"===this.options.stack.push&&this.queuePosition(!1,1),this.options.stack.animation=!1,this.runModules("init"),this.options.auto_display&&this.open(),this},update:function(t){var i=this.options;return this.parseOptions(i,t),this.elem.removeClass("ui-pnotify-fade-slow ui-pnotify-fade-normal ui-pnotify-fade-fast"),"fade"===this.options.animation&&this.elem.addClass("ui-pnotify-fade-"+this.options.animate_speed),this.options.cornerclass!==i.cornerclass&&this.container.removeClass("ui-corner-all "+i.cornerclass).addClass(this.options.cornerclass),this.options.shadow!==i.shadow&&(this.options.shadow?this.container.addClass("ui-pnotify-shadow"):this.container.removeClass("ui-pnotify-shadow")),this.options.addclass===!1?this.elem.removeClass(i.addclass):this.options.addclass!==i.addclass&&this.elem.removeClass(i.addclass).addClass(this.options.addclass),this.options.title===!1?this.title_container.slideUp("fast"):this.options.title!==i.title&&(this.options.title_escape?this.title_container.text(this.options.title):this.title_container.html(this.options.title),i.title===!1&&this.title_container.slideDown(200)),this.options.text===!1?this.text_container.slideUp("fast"):this.options.text!==i.text&&(this.options.text_escape?this.text_container.text(this.options.text):this.text_container.html(this.options.insert_brs?String(this.options.text).replace(/\n/g,"<br />"):this.options.text),i.text===!1&&this.text_container.slideDown(200)),this.options.type!==i.type&&this.container.removeClass(this.styles.error+" "+this.styles.notice+" "+this.styles.success+" "+this.styles.info).addClass("error"===this.options.type?this.styles.error:"info"===this.options.type?this.styles.info:"success"===this.options.type?this.styles.success:this.styles.notice),(this.options.icon!==i.icon||this.options.icon===!0&&this.options.type!==i.type)&&(this.container.find("div.ui-pnotify-icon").remove(),this.options.icon!==!1&&e("<div />",{"class":"ui-pnotify-icon"}).append(e("<span />",{"class":this.options.icon===!0?"error"===this.options.type?this.styles.error_icon:"info"===this.options.type?this.styles.info_icon:"success"===this.options.type?this.styles.success_icon:this.styles.notice_icon:this.options.icon})).prependTo(this.container)),this.options.width!==i.width&&this.elem.animate({width:this.options.width}),this.options.min_height!==i.min_height&&this.container.animate({minHeight:this.options.min_height}),this.options.hide?i.hide||this.queueRemove():this.cancelRemove(),this.queuePosition(!0),this.runModules("update",i),this},open:function(){this.state="opening",this.runModules("beforeOpen");var e=this;return this.elem.parent().length||this.elem.appendTo(this.options.stack.context?this.options.stack.context:o),"top"!==this.options.stack.push&&this.position(!0),this.animateIn(function(){e.queuePosition(!0),e.options.hide&&e.queueRemove(),e.state="open",e.runModules("afterOpen")}),this},remove:function(i){this.state="closing",this.timerHide=!!i,this.runModules("beforeClose");var n=this;return this.timer&&(t.clearTimeout(this.timer),this.timer=null),this.animateOut(function(){if(n.state="closed",n.runModules("afterClose"),n.queuePosition(!0),n.options.remove&&n.elem.detach(),n.runModules("beforeDestroy"),n.options.destroy&&null!==l.notices){var t=e.inArray(n,l.notices);t!==-1&&l.notices.splice(t,1)}n.runModules("afterDestroy")}),this},get:function(){return this.elem},parseOptions:function(t,i){this.options=e.extend(!0,{},l.prototype.options),this.options.stack=l.prototype.options.stack;for(var n,o=[t,i],s=0;s<o.length&&(n=o[s],"undefined"!=typeof n);s++)if("object"!=typeof n)this.options.text=n;else for(var a in n)this.modules[a]?e.extend(!0,this.options[a],n[a]):this.options[a]=n[a]},animateIn:function(e){this.animating="in";var t=this;e=function(){t.animTimer&&clearTimeout(t.animTimer),"in"===t.animating&&(t.elem.is(":visible")?(this&&this.call(),t.animating=!1):t.animTimer=setTimeout(e,40))}.bind(e),"fade"===this.options.animation?(this.elem.one("webkitTransitionEnd mozTransitionEnd MSTransitionEnd oTransitionEnd transitionend",e).addClass("ui-pnotify-in"),this.elem.css("opacity"),this.elem.addClass("ui-pnotify-fade-in"),this.animTimer=setTimeout(e,650)):(this.elem.addClass("ui-pnotify-in"),e())},animateOut:function(e){this.animating="out";var t=this;e=function(){t.animTimer&&clearTimeout(t.animTimer),"out"===t.animating&&("0"!=t.elem.css("opacity")&&t.elem.is(":visible")?t.animTimer=setTimeout(e,40):(t.elem.removeClass("ui-pnotify-in"),this&&this.call(),t.animating=!1))}.bind(e),"fade"===this.options.animation?(this.elem.one("webkitTransitionEnd mozTransitionEnd MSTransitionEnd oTransitionEnd transitionend",e).removeClass("ui-pnotify-fade-in"),this.animTimer=setTimeout(e,650)):(this.elem.removeClass("ui-pnotify-in"),e())},position:function(e){var t=this.options.stack,i=this.elem;if("undefined"==typeof t.context&&(t.context=o),t){"number"!=typeof t.nextpos1&&(t.nextpos1=t.firstpos1),"number"!=typeof t.nextpos2&&(t.nextpos2=t.firstpos2),"number"!=typeof t.addpos2&&(t.addpos2=0);var n=!i.hasClass("ui-pnotify-in");if(!n||e){t.modal&&(t.overlay?t.overlay.show():t.overlay=c(t)),i.addClass("ui-pnotify-move");var s,r,l;switch(t.dir1){case"down":l="top";break;case"up":l="bottom";break;case"left":l="right";break;case"right":l="left"}s=parseInt(i.css(l).replace(/(?:\..*|[^0-9.])/g,"")),isNaN(s)&&(s=0),"undefined"!=typeof t.firstpos1||n||(t.firstpos1=s,t.nextpos1=t.firstpos1);var d;switch(t.dir2){case"down":d="top";break;case"up":d="bottom";break;case"left":d="right";break;case"right":d="left"}switch(r=parseInt(i.css(d).replace(/(?:\..*|[^0-9.])/g,"")),isNaN(r)&&(r=0),"undefined"!=typeof t.firstpos2||n||(t.firstpos2=r,t.nextpos2=t.firstpos2),("down"===t.dir1&&t.nextpos1+i.height()>(t.context.is(o)?a.height():t.context.prop("scrollHeight"))||"up"===t.dir1&&t.nextpos1+i.height()>(t.context.is(o)?a.height():t.context.prop("scrollHeight"))||"left"===t.dir1&&t.nextpos1+i.width()>(t.context.is(o)?a.width():t.context.prop("scrollWidth"))||"right"===t.dir1&&t.nextpos1+i.width()>(t.context.is(o)?a.width():t.context.prop("scrollWidth")))&&(t.nextpos1=t.firstpos1,t.nextpos2+=t.addpos2+("undefined"==typeof t.spacing2?25:t.spacing2),t.addpos2=0),"number"==typeof t.nextpos2&&(t.animation?i.css(d,t.nextpos2+"px"):(i.removeClass("ui-pnotify-move"),i.css(d,t.nextpos2+"px"),i.css(d),i.addClass("ui-pnotify-move"))),t.dir2){case"down":case"up":i.outerHeight(!0)>t.addpos2&&(t.addpos2=i.height());break;case"left":case"right":i.outerWidth(!0)>t.addpos2&&(t.addpos2=i.width())}switch("number"==typeof t.nextpos1&&(t.animation?i.css(l,t.nextpos1+"px"):(i.removeClass("ui-pnotify-move"),i.css(l,t.nextpos1+"px"),i.css(l),i.addClass("ui-pnotify-move"))),t.dir1){case"down":case"up":t.nextpos1+=i.height()+("undefined"==typeof t.spacing1?25:t.spacing1);break;case"left":case"right":t.nextpos1+=i.width()+("undefined"==typeof t.spacing1?25:t.spacing1)}}return this}},queuePosition:function(e,t){return n&&clearTimeout(n),t||(t=10),n=setTimeout(function(){l.positionAll(e)},t),this},cancelRemove:function(){return this.timer&&t.clearTimeout(this.timer),this.animTimer&&t.clearTimeout(this.animTimer),"closing"===this.state&&(this.state="open",this.animating=!1,this.elem.addClass("ui-pnotify-in"),"fade"===this.options.animation&&this.elem.addClass("ui-pnotify-fade-in")),this},queueRemove:function(){var e=this;return this.cancelRemove(),this.timer=t.setTimeout(function(){e.remove(!0)},isNaN(this.options.delay)?0:this.options.delay),this}}),e.extend(l,{notices:[],reload:i,removeAll:function(){e.each(l.notices,function(){this.remove&&this.remove(!1)})},removeStack:function(t){e.each(l.notices,function(){this.remove&&this.options.stack===t&&this.remove(!1)})},positionAll:function(t){if(n&&clearTimeout(n),n=null,l.notices&&l.notices.length)e.each(l.notices,function(){var e=this.options.stack;e&&(e.overlay&&e.overlay.hide(),e.nextpos1=e.firstpos1,e.nextpos2=e.firstpos2,e.addpos2=0,e.animation=t)}),e.each(l.notices,function(){this.position()});else{var i=l.prototype.options.stack;i&&(delete i.nextpos1,delete i.nextpos2)}},styling:{brighttheme:{container:"brighttheme",notice:"brighttheme-notice",notice_icon:"brighttheme-icon-notice",info:"brighttheme-info",info_icon:"brighttheme-icon-info",success:"brighttheme-success",success_icon:"brighttheme-icon-success",error:"brighttheme-error",error_icon:"brighttheme-icon-error"},jqueryui:{container:"ui-widget ui-widget-content ui-corner-all",notice:"ui-state-highlight",notice_icon:"ui-icon ui-icon-info",info:"",info_icon:"ui-icon ui-icon-info",success:"ui-state-default",success_icon:"ui-icon ui-icon-circle-check",error:"ui-state-error",error_icon:"ui-icon ui-icon-alert"},bootstrap3:{container:"alert",notice:"alert-warning",notice_icon:"glyphicon glyphicon-exclamation-sign",info:"alert-info",info_icon:"glyphicon glyphicon-info-sign",success:"alert-success",success_icon:"glyphicon glyphicon-ok-sign",error:"alert-danger",error_icon:"glyphicon glyphicon-warning-sign"}}}),l.styling.fontawesome=e.extend({},l.styling.bootstrap3),e.extend(l.styling.fontawesome,{notice_icon:"fa fa-exclamation-circle",info_icon:"fa fa-info",success_icon:"fa fa-check",error_icon:"fa fa-warning"}),t.document.body?r():e(r),l};return i(t)}),function(e,t){"function"==typeof define&&define.amd?define("pnotify.animate",["jquery","pnotify"],t):"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery"),require("./pnotify")):t(e.jQuery,e.PNotify)}(this,function(e,t){t.prototype.options.animate={animate:!1,in_class:"",out_class:""},t.prototype.modules.animate={init:function(e,t){this.setUpAnimations(e,t),e.attention=function(t,i){e.elem.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e.elem.removeClass(t),i&&i.call(e)}).addClass("animated "+t)}},update:function(e,t,i){t.animate!=i.animate&&this.setUpAnimations(e,t)},setUpAnimations:function(e,t){if(t.animate){e.options.animation="none",e.elem.removeClass("ui-pnotify-fade-slow ui-pnotify-fade-normal ui-pnotify-fade-fast"),e._animateIn||(e._animateIn=e.animateIn),e._animateOut||(e._animateOut=e.animateOut),e.animateIn=this.animateIn.bind(this),e.animateOut=this.animateOut.bind(this);var i=400;"slow"===e.options.animate_speed?i=600:"fast"===e.options.animate_speed?i=200:e.options.animate_speed>0&&(i=e.options.animate_speed),i/=1e3,e.elem.addClass("animated").css({"-webkit-animation-duration":i+"s","-moz-animation-duration":i+"s","animation-duration":i+"s"})}else e._animateIn&&e._animateOut&&(e.animateIn=e._animateIn,delete e._animateIn,e.animateOut=e._animateOut,delete e._animateOut,e.elem.addClass("animated"))},animateIn:function(e){this.notice.animating="in";var t=this;e=function(){this&&this.call(),t.notice.animating=!1}.bind(e),this.notice.elem.show().one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",e).removeClass(this.options.out_class).addClass("ui-pnotify-in").addClass(this.options.in_class)},animateOut:function(e){this.notice.animating="out";var t=this;e=function(){t.notice.elem.removeClass("ui-pnotify-in"),this&&this.call(),t.notice.animating=!1}.bind(e),this.notice.elem.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",e).removeClass(this.options.in_class).addClass(this.options.out_class)}}}),function(e,t){"function"==typeof define&&define.amd?define("pnotify.buttons",["jquery","pnotify"],t):"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery"),require("./pnotify")):t(e.jQuery,e.PNotify)}(this,function(e,t){t.prototype.options.buttons={closer:!0,closer_hover:!0,sticker:!0,sticker_hover:!0,show_on_nonblock:!1,labels:{close:"Close",stick:"Stick",unstick:"Unstick"},classes:{closer:null,pin_up:null,pin_down:null}},t.prototype.modules.buttons={closer:null,sticker:null,init:function(t,i){var n=this;t.elem.on({mouseenter:function(e){!n.options.sticker||t.options.nonblock&&t.options.nonblock.nonblock&&!n.options.show_on_nonblock||n.sticker.trigger("pnotify:buttons:toggleStick").css("visibility","visible"),!n.options.closer||t.options.nonblock&&t.options.nonblock.nonblock&&!n.options.show_on_nonblock||n.closer.css("visibility","visible")},mouseleave:function(e){n.options.sticker_hover&&n.sticker.css("visibility","hidden"),n.options.closer_hover&&n.closer.css("visibility","hidden")}}),this.sticker=e("<div />",{"class":"ui-pnotify-sticker","aria-role":"button","aria-pressed":t.options.hide?"false":"true",tabindex:"0",title:t.options.hide?i.labels.stick:i.labels.unstick,css:{cursor:"pointer",visibility:i.sticker_hover?"hidden":"visible"},click:function(){t.options.hide=!t.options.hide,t.options.hide?t.queueRemove():t.cancelRemove(),e(this).trigger("pnotify:buttons:toggleStick")}}).bind("pnotify:buttons:toggleStick",function(){var i=null===n.options.classes.pin_up?t.styles.pin_up:n.options.classes.pin_up,o=null===n.options.classes.pin_down?t.styles.pin_down:n.options.classes.pin_down;e(this).attr("title",t.options.hide?n.options.labels.stick:n.options.labels.unstick).children().attr("class","").addClass(t.options.hide?i:o).attr("aria-pressed",t.options.hide?"false":"true")}).append("<span />").trigger("pnotify:buttons:toggleStick").prependTo(t.container),(!i.sticker||t.options.nonblock&&t.options.nonblock.nonblock&&!i.show_on_nonblock)&&this.sticker.css("display","none"),this.closer=e("<div />",{"class":"ui-pnotify-closer","aria-role":"button",tabindex:"0",title:i.labels.close,css:{cursor:"pointer",visibility:i.closer_hover?"hidden":"visible"},click:function(){t.remove(!1),n.sticker.css("visibility","hidden"),n.closer.css("visibility","hidden")}}).append(e("<span />",{"class":null===i.classes.closer?t.styles.closer:i.classes.closer})).prependTo(t.container),(!i.closer||t.options.nonblock&&t.options.nonblock.nonblock&&!i.show_on_nonblock)&&this.closer.css("display","none")},update:function(e,t){!t.closer||e.options.nonblock&&e.options.nonblock.nonblock&&!t.show_on_nonblock?this.closer.css("display","none"):t.closer&&this.closer.css("display","block"),!t.sticker||e.options.nonblock&&e.options.nonblock.nonblock&&!t.show_on_nonblock?this.sticker.css("display","none"):t.sticker&&this.sticker.css("display","block"),this.sticker.trigger("pnotify:buttons:toggleStick"),this.closer.find("span").attr("class","").addClass(null===t.classes.closer?e.styles.closer:t.classes.closer),t.sticker_hover?this.sticker.css("visibility","hidden"):e.options.nonblock&&e.options.nonblock.nonblock&&!t.show_on_nonblock||this.sticker.css("visibility","visible"),t.closer_hover?this.closer.css("visibility","hidden"):e.options.nonblock&&e.options.nonblock.nonblock&&!t.show_on_nonblock||this.closer.css("visibility","visible")}},e.extend(t.styling.brighttheme,{closer:"brighttheme-icon-closer",pin_up:"brighttheme-icon-sticker",pin_down:"brighttheme-icon-sticker brighttheme-icon-stuck"}),e.extend(t.styling.jqueryui,{closer:"ui-icon ui-icon-close",pin_up:"ui-icon ui-icon-pin-w",pin_down:"ui-icon ui-icon-pin-s"}),e.extend(t.styling.bootstrap2,{closer:"icon-remove",pin_up:"icon-pause",pin_down:"icon-play"}),e.extend(t.styling.bootstrap3,{closer:"glyphicon glyphicon-remove",pin_up:"glyphicon glyphicon-pause",pin_down:"glyphicon glyphicon-play"}),e.extend(t.styling.fontawesome,{closer:"fa fa-times",pin_up:"fa fa-pause",pin_down:"fa fa-play"})}),function(e,t){"function"==typeof define&&define.amd?define("pnotify.callbacks",["jquery","pnotify"],t):"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery"),require("./pnotify")):t(e.jQuery,e.PNotify)}(this,function(e,t){var i=t.prototype.init,n=t.prototype.open,o=t.prototype.remove;t.prototype.init=function(){this.options.before_init&&this.options.before_init(this.options),i.apply(this,arguments),this.options.after_init&&this.options.after_init(this)},t.prototype.open=function(){var e;this.options.before_open&&(e=this.options.before_open(this)),e!==!1&&(n.apply(this,arguments),this.options.after_open&&this.options.after_open(this))},t.prototype.remove=function(e){var t;this.options.before_close&&(t=this.options.before_close(this,e)),t!==!1&&(o.apply(this,arguments),this.options.after_close&&this.options.after_close(this,e))}}),function(e,t){"function"==typeof define&&define.amd?define("pnotify.desktop",["jquery","pnotify"],t):"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery"),require("./pnotify")):t(e.jQuery,e.PNotify)}(this,function(e,t){var i,n=function(e,t){return(n="Notification"in window?function(e,t){return new Notification(e,t)}:"mozNotification"in navigator?function(e,t){return navigator.mozNotification.createNotification(e,t.body,t.icon).show()}:"webkitNotifications"in window?function(e,t){return window.webkitNotifications.createNotification(t.icon,e,t.body)}:function(e,t){return null})(e,t)};t.prototype.options.desktop={desktop:!1,fallback:!0,icon:null,tag:null},t.prototype.modules.desktop={tag:null,icon:null,genNotice:function(e,t){null===t.icon?this.icon="http://sciactive.com/pnotify/includes/desktop/"+e.options.type+".png":t.icon===!1?this.icon=null:this.icon=t.icon,null!==this.tag&&null===t.tag||(this.tag=null===t.tag?"PNotify-"+Math.round(1e6*Math.random()):t.tag),e.desktop=n(e.options.title,{icon:this.icon,body:t.text||e.options.text,tag:this.tag}),!("close"in e.desktop)&&"cancel"in e.desktop&&(e.desktop.close=function(){e.desktop.cancel()}),e.desktop.onclick=function(){
e.elem.trigger("click")},e.desktop.onclose=function(){"closing"!==e.state&&"closed"!==e.state&&e.remove()}},init:function(e,n){if(n.desktop)return i=t.desktop.checkPermission(),0!==i?void(n.fallback||(e.options.auto_display=!1)):void this.genNotice(e,n)},update:function(e,t,n){0!==i&&t.fallback||!t.desktop||this.genNotice(e,t)},beforeOpen:function(e,t){0!==i&&t.fallback||!t.desktop||e.elem.css({left:"-10000px"}).removeClass("ui-pnotify-in")},afterOpen:function(e,t){0!==i&&t.fallback||!t.desktop||(e.elem.css({left:"-10000px"}).removeClass("ui-pnotify-in"),"show"in e.desktop&&e.desktop.show())},beforeClose:function(e,t){0!==i&&t.fallback||!t.desktop||e.elem.css({left:"-10000px"}).removeClass("ui-pnotify-in")},afterClose:function(e,t){0!==i&&t.fallback||!t.desktop||(e.elem.css({left:"-10000px"}).removeClass("ui-pnotify-in"),"close"in e.desktop&&e.desktop.close())}},t.desktop={permission:function(){"undefined"!=typeof Notification&&"requestPermission"in Notification?Notification.requestPermission():"webkitNotifications"in window&&window.webkitNotifications.requestPermission()},checkPermission:function(){return"undefined"!=typeof Notification&&"permission"in Notification?"granted"===Notification.permission?0:1:"webkitNotifications"in window&&0==window.webkitNotifications.checkPermission()?0:1}},i=t.desktop.checkPermission()}),function(e,t){"function"==typeof define&&define.amd?define("pnotify.mobile",["jquery","pnotify"],t):"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery"),require("./pnotify")):t(e.jQuery,e.PNotify)}(this,function(e,t){t.prototype.options.mobile={swipe_dismiss:!0,styling:!0},t.prototype.modules.mobile={swipe_dismiss:!0,init:function(e,t){var i=this,n=null,o=null,s=null;this.swipe_dismiss=t.swipe_dismiss,this.doMobileStyling(e,t),e.elem.on({touchstart:function(t){i.swipe_dismiss&&(n=t.originalEvent.touches[0].screenX,s=e.elem.width(),e.container.css("left","0"))},touchmove:function(t){if(n&&i.swipe_dismiss){var a=t.originalEvent.touches[0].screenX;o=a-n;var r=(1-Math.abs(o)/s)*e.options.opacity;e.elem.css("opacity",r),e.container.css("left",o)}},touchend:function(){if(n&&i.swipe_dismiss){if(Math.abs(o)>40){var t=o<0?s*-2:2*s;e.elem.animate({opacity:0},100),e.container.animate({left:t},100),e.remove()}else e.elem.animate({opacity:e.options.opacity},100),e.container.animate({left:0},100);n=null,o=null,s=null}},touchcancel:function(){n&&i.swipe_dismiss&&(e.elem.animate({opacity:e.options.opacity},100),e.container.animate({left:0},100),n=null,o=null,s=null)}})},update:function(e,t){this.swipe_dismiss=t.swipe_dismiss,this.doMobileStyling(e,t)},doMobileStyling:function(t,i){i.styling?(t.elem.addClass("ui-pnotify-mobile-able"),e(window).width()<=480?(t.options.stack.mobileOrigSpacing1||(t.options.stack.mobileOrigSpacing1=t.options.stack.spacing1,t.options.stack.mobileOrigSpacing2=t.options.stack.spacing2),t.options.stack.spacing1=0,t.options.stack.spacing2=0):(t.options.stack.mobileOrigSpacing1||t.options.stack.mobileOrigSpacing2)&&(t.options.stack.spacing1=t.options.stack.mobileOrigSpacing1,delete t.options.stack.mobileOrigSpacing1,t.options.stack.spacing2=t.options.stack.mobileOrigSpacing2,delete t.options.stack.mobileOrigSpacing2)):(t.elem.removeClass("ui-pnotify-mobile-able"),t.options.stack.mobileOrigSpacing1&&(t.options.stack.spacing1=t.options.stack.mobileOrigSpacing1,delete t.options.stack.mobileOrigSpacing1),t.options.stack.mobileOrigSpacing2&&(t.options.stack.spacing2=t.options.stack.mobileOrigSpacing2,delete t.options.stack.mobileOrigSpacing2))}}}),"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var i,n,o,s,a,r=gap,c=t[e];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(c)){for(s=c.length,i=0;i<s;i+=1)a[i]=str(i,c)||"null";return o=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+r+"]":"["+a.join(",")+"]",gap=r,o}if(rep&&"object"==typeof rep)for(s=rep.length,i=0;i<s;i+=1)"string"==typeof rep[i]&&(n=rep[i],o=str(n,c),o&&a.push(quote(n)+(gap?": ":":")+o));else for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(o=str(n,c),o&&a.push(quote(n)+(gap?": ":":")+o));return o=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+r+"}":"{"+a.join(",")+"}",gap=r,o}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;n<i;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var i,n,o=e[t];if(o&&"object"==typeof o)for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n=walk(o,i),void 0!==n?o[i]=n:delete o[i]);return reviver.call(e,t,o)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e){function t(){if(e.fn.ajaxSubmit.debug){var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}}e.fn.ajaxSubmit=function(i){function n(n){function s(e){var t=e.contentWindow?e.contentWindow.document:e.contentDocument?e.contentDocument:e.document;return t}function a(){function i(){try{var e=s(m).readyState;t("state = "+e),"uninitialized"==e.toLowerCase()&&setTimeout(i,50)}catch(n){t("Server abort: ",n," (",n.name,")"),c(T),C&&clearTimeout(C),C=void 0}}var n=r.attr("target"),a=r.attr("action");k.setAttribute("target",h),o||k.setAttribute("method","POST"),a!=p.url&&k.setAttribute("action",p.url),p.skipEncodingOverride||o&&!/post/i.test(o)||r.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),p.timeout&&(C=setTimeout(function(){b=!0,c(x)},p.timeout));var l=[];try{if(p.extraData)for(var d in p.extraData)l.push(e('<input type="hidden" name="'+d+'" />').attr("value",p.extraData[d]).appendTo(k)[0]);p.iframeTarget||(f.appendTo("body"),m.attachEvent?m.attachEvent("onload",c):m.addEventListener("load",c,!1)),setTimeout(i,15),k.submit()}finally{k.setAttribute("action",a),n?k.setAttribute("target",n):r.removeAttr("target"),e(l).remove()}}function c(i){if(!g.aborted&&!_){try{E=s(m)}catch(n){t("cannot access response document: ",n),i=T}if(i===x&&g)return void g.abort("timeout");if(i==T&&g)return void g.abort("server abort");if(E&&E.location.href!=p.iframeSrc||b){m.detachEvent?m.detachEvent("onload",c):m.removeEventListener("load",c,!1);var o,a="success";try{if(b)throw"timeout";var r="xml"==p.dataType||E.XMLDocument||e.isXMLDoc(E);if(t("isXml="+r),!r&&window.opera&&(null==E.body||""==E.body.innerHTML)&&--S)return t("requeing onLoad callback, DOM not available"),void setTimeout(c,250);var l=E.body?E.body:E.documentElement;g.responseText=l?l.innerHTML:null,g.responseXML=E.XMLDocument?E.XMLDocument:E,r&&(p.dataType="xml"),g.getResponseHeader=function(e){var t={"content-type":p.dataType};return t[e]},l&&(g.status=Number(l.getAttribute("status"))||g.status,g.statusText=l.getAttribute("statusText")||g.statusText);var d=(p.dataType||"").toLowerCase(),h=/(json|script|text)/.test(d);if(h||p.textarea){var v=E.getElementsByTagName("textarea")[0];if(v)g.responseText=v.value,g.status=Number(v.getAttribute("status"))||g.status,g.statusText=v.getAttribute("statusText")||g.statusText;else if(h){var y=E.getElementsByTagName("pre")[0],k=E.getElementsByTagName("body")[0];y?g.responseText=y.textContent?y.textContent:y.innerText:k&&(g.responseText=k.textContent?k.textContent:k.innerText)}}else"xml"!=d||g.responseXML||null==g.responseText||(g.responseXML=M(g.responseText));try{$=I(g,d,p)}catch(i){a="parsererror",g.error=o=i||a}}catch(i){t("error caught: ",i),a="error",g.error=o=i||a}g.aborted&&(t("upload aborted"),a=null),g.status&&(a=g.status>=200&&g.status<300||304===g.status?"success":"error"),"success"===a?(p.success&&p.success.call(p.context,$,"success",g),u&&e.event.trigger("ajaxSuccess",[g,p])):a&&(void 0==o&&(o=g.statusText),p.error&&p.error.call(p.context,g,a,o),u&&e.event.trigger("ajaxError",[g,p,o])),u&&e.event.trigger("ajaxComplete",[g,p]),u&&!--e.active&&e.event.trigger("ajaxStop"),p.complete&&p.complete.call(p.context,g,a),_=!0,p.timeout&&clearTimeout(C),setTimeout(function(){p.iframeTarget||f.remove(),g.responseXML=null},100)}}}var l,d,p,u,h,f,m,g,v,y,b,C,k=r[0],w=!!e.fn.prop;if(n)if(w)for(d=0;d<n.length;d++)l=e(k[n[d].name]),l.prop("disabled",!1);else for(d=0;d<n.length;d++)l=e(k[n[d].name]),l.removeAttr("disabled");if(e(":input[name=submit],:input[id=submit]",k).length)return void alert('Error: Form elements must not have name or id of "submit".');if(p=e.extend(!0,{},e.ajaxSettings,i),p.context=p.context||p,h="jqFormIO"+(new Date).getTime(),p.iframeTarget?(f=e(p.iframeTarget),y=f.attr("name"),null==y?f.attr("name",h):h=y):(f=e('<iframe name="'+h+'" src="'+p.iframeSrc+'" />'),f.css({position:"absolute",top:"-1000px",left:"-1000px"})),m=f[0],g={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(i){var n="timeout"===i?"timeout":"aborted";t("aborting upload... "+n),this.aborted=1,f.attr("src",p.iframeSrc),g.error=n,p.error&&p.error.call(p.context,g,n,i),u&&e.event.trigger("ajaxError",[g,p,n]),p.complete&&p.complete.call(p.context,g,n)}},u=p.global,u&&!e.active++&&e.event.trigger("ajaxStart"),u&&e.event.trigger("ajaxSend",[g,p]),p.beforeSend&&p.beforeSend.call(p.context,g,p)===!1)return void(p.global&&e.active--);if(!g.aborted){v=k.clk,v&&(y=v.name,y&&!v.disabled&&(p.extraData=p.extraData||{},p.extraData[y]=v.value,"image"==v.type&&(p.extraData[y+".x"]=k.clk_x,p.extraData[y+".y"]=k.clk_y)));var x=1,T=2;p.forceSync?a():setTimeout(a,10);var $,E,_,S=50,M=e.parseXML||function(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!=t.documentElement.nodeName?t:null},A=e.parseJSON||function(e){return window.eval("("+e+")")},I=function(t,i,n){var o=t.getResponseHeader("content-type")||"",s="xml"===i||!i&&o.indexOf("xml")>=0,a=s?t.responseXML:t.responseText;return s&&"parsererror"===a.documentElement.nodeName&&e.error&&e.error("parsererror"),n&&n.dataFilter&&(a=n.dataFilter(a,i)),"string"==typeof a&&("json"===i||!i&&o.indexOf("json")>=0?a=A(a):("script"===i||!i&&o.indexOf("javascript")>=0)&&e.globalEval(a)),a}}}if(!this.length)return t("ajaxSubmit: skipping submit process - no element selected"),this;var o,s,a,r=this;"function"==typeof i&&(i={success:i}),o=this.attr("method"),s=this.attr("action"),a="string"==typeof s?e.trim(s):"",a=a||window.location.href||"",a&&(a=(a.match(/^([^#]+)/)||[])[1]),i=e.extend(!0,{url:a,success:e.ajaxSettings.success,type:o||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},i);var c={};if(this.trigger("form-pre-serialize",[this,i,c]),c.veto)return t("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(i.beforeSerialize&&i.beforeSerialize(this,i)===!1)return t("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var l=i.traditional;void 0===l&&(l=e.ajaxSettings.traditional);var d,p=this.formToArray(i.semantic);if(i.data&&(i.extraData=i.data,d=e.param(i.data,l)),i.beforeSubmit&&i.beforeSubmit(p,this,i)===!1)return t("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[p,this,i,c]),c.veto)return t("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var u=e.param(p,l);d&&(u=u?u+"&"+d:d),"GET"==i.type.toUpperCase()?(i.url+=(i.url.indexOf("?")>=0?"&":"?")+u,i.data=null):i.data=u;var h=[];if(i.resetForm&&h.push(function(){r.resetForm()}),i.clearForm&&h.push(function(){r.clearForm(i.includeHidden)}),!i.dataType&&i.target){var f=i.success||function(){};h.push(function(t){var n=i.replaceTarget?"replaceWith":"html";e(i.target)[n](t).each(f,arguments)})}else i.success&&h.push(i.success);i.success=function(e,t,n){for(var o=i.context||i,s=0,a=h.length;s<a;s++)h[s].apply(o,[e,t,n||r,r])};var m=e("input:file",this).length>0,g="multipart/form-data",v=r.attr("enctype")==g||r.attr("encoding")==g;return i.iframe!==!1&&(m||i.iframe||v)?i.closeKeepAlive?e.get(i.closeKeepAlive,function(){n(p)}):n(p):e.ajax(i),this.trigger("form-submit-notify",[this,i]),this},e.fn.ajaxForm=function(i){if(0===this.length){var n={s:this.selector,c:this.context};return!e.isReady&&n.s?(t("DOM not ready, queuing ajaxForm"),e(function(){e(n.s,n.c).ajaxForm(i)}),this):(t("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this)}return this.ajaxFormUnbind().bind("submit.form-plugin",function(t){t.isDefaultPrevented()||(t.preventDefault(),e(this).ajaxSubmit(i))}).bind("click.form-plugin",function(t){var i=t.target,n=e(i);if(!n.is(":submit,input:image")){var o=n.closest(":submit");if(0==o.length)return;i=o[0]}var s=this;if(s.clk=i,"image"==i.type)if(void 0!=t.offsetX)s.clk_x=t.offsetX,s.clk_y=t.offsetY;else if("function"==typeof e.fn.offset){var a=n.offset();s.clk_x=t.pageX-a.left,s.clk_y=t.pageY-a.top}else s.clk_x=t.pageX-i.offsetLeft,s.clk_y=t.pageY-i.offsetTop;setTimeout(function(){s.clk=s.clk_x=s.clk_y=null},100)})},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},e.fn.formToArray=function(t){var i=[];if(0===this.length)return i;var n=this[0],o=t?n.getElementsByTagName("*"):n.elements;if(!o)return i;var s,a,r,c,l,d,p;for(s=0,d=o.length;s<d;s++)if(l=o[s],r=l.name)if(t&&n.clk&&"image"==l.type)l.disabled||n.clk!=l||(i.push({name:r,value:e(l).val()}),i.push({name:r+".x",value:n.clk_x},{name:r+".y",value:n.clk_y}));else if(c=e.fieldValue(l,!0),c&&c.constructor==Array)for(a=0,p=c.length;a<p;a++)i.push({name:r,value:c[a]});else null!==c&&"undefined"!=typeof c&&i.push({name:r,value:c});if(!t&&n.clk){var u=e(n.clk),h=u[0];r=h.name,r&&!h.disabled&&"image"==h.type&&(i.push({name:r,value:u.val()}),i.push({name:r+".x",value:n.clk_x},{name:r+".y",value:n.clk_y}))}return i},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var i=[];return this.each(function(){var n=this.name;if(n){var o=e.fieldValue(this,t);if(o&&o.constructor==Array)for(var s=0,a=o.length;s<a;s++)i.push({name:n,value:o[s]});else null!==o&&"undefined"!=typeof o&&i.push({name:this.name,value:o})}}),e.param(i)},e.fn.fieldValue=function(t){for(var i=[],n=0,o=this.length;n<o;n++){var s=this[n],a=e.fieldValue(s,t);null===a||"undefined"==typeof a||a.constructor==Array&&!a.length||(a.constructor==Array?e.merge(i,a):i.push(a))}return i},e.fieldValue=function(t,i){var n=t.name,o=t.type,s=t.tagName.toLowerCase();if(void 0===i&&(i=!0),i&&(!n||t.disabled||"reset"==o||"button"==o||("checkbox"==o||"radio"==o)&&!t.checked||("submit"==o||"image"==o)&&t.form&&t.form.clk!=t||"select"==s&&t.selectedIndex==-1))return null;if("select"==s){var a=t.selectedIndex;if(a<0)return null;for(var r=[],c=t.options,l="select-one"==o,d=l?a+1:c.length,p=l?a:0;p<d;p++){var u=c[p];if(u.selected){var h=u.value;if(h||(h=u.attributes&&u.attributes.value&&!u.attributes.value.specified?u.text:u.value),l)return h;r.push(h)}}return r}return e(t).val()},e.fn.clearForm=function(t){return this.each(function(){e("input,select,textarea",this).clearFields(t)})},e.fn.clearFields=e.fn.clearInputs=function(e){var t=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var i=this.type,n=this.tagName.toLowerCase();t.test(i)||"textarea"==n||e&&/hidden/.test(i)?this.value="":"checkbox"==i||"radio"==i?this.checked=!1:"select"==n&&(this.selectedIndex=-1)})},e.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},e.fn.enable=function(e){return void 0===e&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.selected=function(t){return void 0===t&&(t=!0),this.each(function(){var i=this.type;if("checkbox"==i||"radio"==i)this.checked=t;else if("option"==this.tagName.toLowerCase()){var n=e(this).parent("select");t&&n[0]&&"select-one"==n[0].type&&n.find("option").selected(!1),this.selected=t}})},e.fn.ajaxSubmit.debug=!1}(jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var a=t||window.event,r=c.call(arguments,1),l=0,p=0,u=0,h=0,f=0,m=0;if(t=e.event.fix(a),t.type="mousewheel","detail"in a&&(u=a.detail*-1),"wheelDelta"in a&&(u=a.wheelDelta),"wheelDeltaY"in a&&(u=a.wheelDeltaY),"wheelDeltaX"in a&&(p=a.wheelDeltaX*-1),"axis"in a&&a.axis===a.HORIZONTAL_AXIS&&(p=u*-1,u=0),l=0===u?p:u,"deltaY"in a&&(u=a.deltaY*-1,l=u),"deltaX"in a&&(p=a.deltaX,0===u&&(l=p*-1)),0!==u||0!==p){if(1===a.deltaMode){var g=e.data(this,"mousewheel-line-height");l*=g,u*=g,p*=g}else if(2===a.deltaMode){var v=e.data(this,"mousewheel-page-height");l*=v,u*=v,p*=v}if(h=Math.max(Math.abs(u),Math.abs(p)),(!s||h<s)&&(s=h,n(a,h)&&(s/=40)),n(a,h)&&(l/=40,p/=40,u/=40),l=Math[l>=1?"floor":"ceil"](l/s),p=Math[p>=1?"floor":"ceil"](p/s),u=Math[u>=1?"floor":"ceil"](u/s),d.settings.normalizeOffset&&this.getBoundingClientRect){var y=this.getBoundingClientRect();f=t.clientX-y.left,m=t.clientY-y.top}return t.deltaX=p,t.deltaY=u,t.deltaFactor=s,t.offsetX=f,t.offsetY=m,t.deltaMode=0,r.unshift(t,l,p,u),o&&clearTimeout(o),o=setTimeout(i,200),(e.event.dispatch||e.event.handle).apply(this,r)}}function i(){s=null}function n(e,t){return d.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var o,s,a=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],c=Array.prototype.slice;if(e.event.fixHooks)for(var l=a.length;l;)e.event.fixHooks[a[--l]]=e.event.mouseHooks;var d=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=r.length;i;)this.addEventListener(r[--i],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",d.getLineHeight(this)),e.data(this,"mousewheel-page-height",d.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=r.length;i;)this.removeEventListener(r[--i],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var i=e(t),n=i["offsetParent"in e.fn?"offsetParent":"parent"]();return n.length||(n=e("body")),parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})});var Concrete=function(e,t){"use strict";function i(e,t){return e[t]}function n(e,t,o){t+="";var s="get"+t.substr(0,1).toUpperCase()+t.substr(1),a="set"+t.substr(0,1).toUpperCase()+t.substr(1);return"undefined"==typeof this[s]&&(this[s]=_.partial(i,e,t)),"undefined"==typeof this[a]&&(this[a]=_.partial(n,e,t)),e[t]=o,o}var o=t("html");return{editMode:null,event:e,createGetterSetters:function(e){var t=this;return t.getAttr=_.partial(i,e),t.setAttr=_.partial(n,e),_(e).each(function(e,i){t.setAttr(i,e)}),!0},forceRefresh:function(){o.hide(0,function(){t(this).show()})},"const":{}}}(ConcreteEvent,jQuery);!function(e){var t=null;e.fn.liveUpdate=function(t,i){return this.each(function(){new e.liveUpdate(this,t,i)})},e.liveUpdate=function(t,i,n){this.field=e(t),e(t).data("liveUpdate",this),this.list=e("#"+i),this.lutype="blocktypes","undefined"!=typeof n&&(this.lutype=n),this.list.length>0&&this.init()},e.liveUpdate.prototype={init:function(){var e=this;this.setupCache(),this.field.parents("form").on("submit.liveupdate",function(){return!1}),this.field.keyup(function(){e.filter()}),e.filter()},filter:function(){if(this.field.val()!=t){if(""==e.trim(this.field.val()))return void("blocktypes"==this.lutype?(this.list.find("li").show(),this.list.find(".ccm-panel-add-block-set").show()):"attributes"==this.lutype?(this.list.find("h5").show(),this.list.find("li").show()):"stacks"==this.lutype?(this.list.children("li").addClass("ccm-stack-available"),this.list.children("li").removeClass("ccm-stack-selected")):"intelligent-search"==this.lutype?this.list.is(":visible")&&this.list.hide():this.list.children("li,div.li").show());"intelligent-search"!=this.lutype||this.field.val().length>2?this.displayResults(this.getScores(this.field.val().toLowerCase())):"intelligent-search"==this.lutype&&this.list.is(":visible")&&this.list.hide()}t=this.field.val(),""==t&&"intelligent-search"==this.lutype&&this.list.is(":visible")&&this.list.hide()},setupCache:function(){var t=this;this.cache=[],this.rows=[];var i=this.lutype;this.list.find("li,div.li").each(function(){if("blocktypes"==i)t.cache.push(e(this).find("span").html().toLowerCase());else if("attributes"==i){var n=e(this).find("a,span").html().toLowerCase();t.cache.push(n)}else if("stacks"==i){var n=e(this).find("a,span").html().toLowerCase();t.cache.push(n)}else if("fileset"==i)t.cache.push(e(this).find("span[data-label=file-set-name]").html().toLowerCase());else if("intelligent-search"==i){var o=e(this).find("span").html();o&&t.cache.push(o.toLowerCase())}t.rows.push(e(this))}),this.cache_length=this.cache.length},displayResults:function(t){var i=this;if("blocktypes"==this.lutype)this.list.find(".ccm-panel-add-block-set").hide(),this.list.find("li,div.li").hide(),e.each(t,function(e,t){i.rows[t[1]].show(),i.rows[t[1]].closest(".ccm-panel-add-block-set").show()});else if("attributes"==this.lutype)this.list.find("h5").hide(),this.list.find("li").hide(),e.each(t,function(e,t){i.rows[t[1]].show()});else if("stacks"==this.lutype)this.list.children("li").removeClass("ccm-stack-available"),this.list.children("li").removeClass("ccm-stack-selected"),this.list.children("li").removeClass("ccm-item-selected"),e.each(t,function(e,t){i.rows[t[1]].addClass("ccm-stack-available")}),this.list.children("li.item-select-list-header").removeClass("ccm-stack-available"),e(this.list.find("li.ccm-stack-available")[0]).addClass("ccm-item-selected");else if("intelligent-search"==this.lutype){this.list.is(":visible")||this.list.fadeIn(160,"easeOutExpo"),this.list.find(".ccm-intelligent-search-results-module-onsite").hide(),this.list.find("li").hide();var n=0;e.each(t,function(e,t){$li=i.rows[t[1]],t[0]>.75&&(n++,$li.parent().parent().is(":visible")||$li.parent().parent().show(),$li.show())}),this.list.find("li a").removeClass("ccm-intelligent-search-result-selected"),this.list.find("li:visible a:first").addClass("ccm-intelligent-search-result-selected")}else this.list.children("li,div.li").hide(),e.each(t,function(e,t){i.rows[t[1]].show()})},getScores:function(e){for(var t=[],i=0;i<this.cache_length;i++){var n=this.cache[i].score(e);n>0&&t.push([n,i])}return t.sort(function(e,t){return t[0]-e[0]})}}}(jQuery),function(e,t){if("function"==typeof define&&define.amd)define(["exports","module"],t);else if("undefined"!=typeof exports&&"undefined"!=typeof module)t(exports,module);else{var i={exports:{}};t(i.exports,i),e.autosize=i.exports}}(this,function(e,t){"use strict";function i(e){function t(){var t=window.getComputedStyle(e,null);h=t.overflowY,"vertical"===t.resize?e.style.resize="none":"both"===t.resize&&(e.style.resize="horizontal"),u="content-box"===t.boxSizing?-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)):parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth),isNaN(u)&&(u=0),o()}function i(t){var i=e.style.width;e.style.width="0px",e.offsetWidth,e.style.width=i,h=t,p&&(e.style.overflowY=t),n()}function n(){var t=window.pageYOffset,i=document.body.scrollTop,n=e.style.height;e.style.height="auto";var o=e.scrollHeight+u;return 0===e.scrollHeight?void(e.style.height=n):(e.style.height=o+"px",f=e.clientWidth,document.documentElement.scrollTop=t,void(document.body.scrollTop=i))}function o(){var t=e.style.height;n();var o=window.getComputedStyle(e,null);if(o.height!==e.style.height?"visible"!==h&&i("visible"):"hidden"!==h&&i("hidden"),t!==e.style.height){var s=a("autosize:resized");e.dispatchEvent(s)}}var r=void 0===arguments[1]?{}:arguments[1],c=r.setOverflowX,l=void 0===c||c,d=r.setOverflowY,p=void 0===d||d;if(e&&e.nodeName&&"TEXTAREA"===e.nodeName&&!s.has(e)){var u=null,h=null,f=e.clientWidth,m=function(){e.clientWidth!==f&&o()},g=function(t){window.removeEventListener("resize",m,!1),e.removeEventListener("input",o,!1),e.removeEventListener("keyup",o,!1),e.removeEventListener("autosize:destroy",g,!1),e.removeEventListener("autosize:update",o,!1),s["delete"](e),Object.keys(t).forEach(function(i){e.style[i]=t[i]})}.bind(e,{height:e.style.height,resize:e.style.resize,overflowY:e.style.overflowY,overflowX:e.style.overflowX,wordWrap:e.style.wordWrap});e.addEventListener("autosize:destroy",g,!1),"onpropertychange"in e&&"oninput"in e&&e.addEventListener("keyup",o,!1),window.addEventListener("resize",m,!1),e.addEventListener("input",o,!1),e.addEventListener("autosize:update",o,!1),s.add(e),l&&(e.style.overflowX="hidden",e.style.wordWrap="break-word"),t()}}function n(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName){var t=a("autosize:destroy");e.dispatchEvent(t)}}function o(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName){var t=a("autosize:update");e.dispatchEvent(t)}}var s="function"==typeof Set?new Set:function(){var e=[];return{has:function(t){return Boolean(e.indexOf(t)>-1)},add:function(t){e.push(t)},"delete":function(t){e.splice(e.indexOf(t),1)}}}(),a=function(e){return new Event(e)};try{new Event("test")}catch(r){a=function(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!1),t}}var c=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?(c=function(e){return e},c.destroy=function(e){return e},c.update=function(e){return e}):(c=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],function(e){return i(e,t)}),e},c.destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],n),e},c.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],o),e}),t.exports=c}),function(e,t,i){"use strict";function n(t,i){this.name=o,this.el=t,this.$el=e(t),this.options=e.extend({},s,i),this.$document=e(this.$el[0].ownerDocument),this.$body=this.$document.find("body"),this.moveTrigger="MSPointerMove touchmove mousemove",this.startTrigger="MSPointerDown touchstart mousedown",this.stopTrigger="MSPointerUp touchend mouseup",this.startTriggerArray=this.startTrigger.split(" "),this.moveTriggerArray=this.moveTrigger.split(" "),this.stopTriggerArray=this.stopTrigger.split(" "),this.stopEvents=[this.stopTrigger,this.options.stopEvents].join(" "),"window"===this.options.constrainTo?this.$container=this.$document:this.options.constrainTo&&"parent"!==this.options.constrainTo?this.$container=e(this.options.constrainTo):this.$container=this.$el.parent(),this.isPointerEventCompatible()&&this.applyMSDefaults(),this.CSSEaseHash=this.getCSSEaseHash(),this.scale=1,this.started=!1,this.disabled=!1,this.activeDropRegions=[],this.resetVelocityQueue(),this.init()}var o="pep",s={initiate:function(){},start:function(){},drag:function(){},stop:function(){},rest:function(){},moveTo:!1,callIfNotStarted:["stop","rest"],startThreshold:[0,0],grid:[1,1],debug:!1,activeClass:"pep-active",multiplier:1,velocityMultiplier:2.5,shouldPreventDefault:!0,allowDragEventPropagation:!0,stopEvents:"",hardwareAccelerate:!0,useCSSTranslation:!0,disableSelect:!0,cssEaseString:"cubic-bezier(0.190, 1.000, 0.220, 1.000)",cssEaseDuration:1e3,shouldEase:!0,droppable:!1,droppableActiveClass:"pep-dpa",overlapFunction:!1,constrainTo:!1,removeMargins:!0,place:!0,deferPlacement:!1,axis:null,forceNonCSS3Movement:!1,elementsWithInteraction:"input",revert:!1,revertAfter:"stop",revertIf:function(){return!0},ignoreRightClick:!0};n.prototype.init=function(){this.options.debug&&this.buildDebugDiv(),this.options.disableSelect&&this.disableSelect(),this.options.place&&!this.options.deferPlacement&&(this.positionParent(),this.placeObject()),this.ev={},this.pos={},this.subscribe()},n.prototype.subscribe=function(){var e=this;this.onStartEvent=function(t){e.handleStart(t)},this.$el.on(this.startTrigger,this.onStartEvent),this.onStartEventOnElementsWithInteraction=function(e){e.stopPropagation()},this.$el.on(this.startTrigger,this.options.elementsWithInteraction,this.onStartEventOnElementsWithInteraction),this.onStopEvents=function(t){e.handleStop(t)},this.$document.on(this.stopEvents,this.onStopEvents),this.onMoveEvents=function(t){e.moveEvent=t},this.$document.on(this.moveTrigger,this.onMoveEvents)},n.prototype.unsubscribe=function(){this.$el.off(this.startTrigger,this.onStartEvent),this.$el.off(this.startTrigger,this.options.elementsWithInteraction,this.onStartEventOnElementsWithInteraction),this.$document.off(this.stopEvents,this.onStopEvents),this.$document.off(this.moveTrigger,this.onMoveEvents)},n.prototype.handleStart=function(t){var i=this;if(this.isValidMoveEvent(t)&&!this.disabled&&(!this.options.ignoreRightClick||3!==t.which)){this.isPointerEventCompatible()&&t.preventManipulation&&t.preventManipulation(),t=this.normalizeEvent(t),this.options.place&&this.options.deferPlacement&&(this.positionParent(),this.placeObject()),this.log({type:"event",event:t.type}),this.options.hardwareAccelerate&&!this.hardwareAccelerated&&(this.hardwareAccelerate(),this.hardwareAccelerated=!0);var n=this.options.initiate.call(this,t,this);if(n===!1)return;clearTimeout(this.restTimeout),this.$el.addClass(this.options.activeClass),this.removeCSSEasing(),this.startX=this.ev.x=t.pep.x,this.startY=this.ev.y=t.pep.y,this.initialPosition=this.initialPosition||this.$el.position(),this.startEvent=this.moveEvent=t,this.active=!0,this.options.shouldPreventDefault&&t.preventDefault(),this.options.allowDragEventPropagation||t.stopPropagation(),function o(){i.active&&(i.handleMove(),i.requestAnimationFrame(o))}(e,i)}},n.prototype.handleMove=function(){if("undefined"!=typeof this.moveEvent){var i=this.normalizeEvent(this.moveEvent),n=t.parseInt(i.pep.x/this.options.grid[0])*this.options.grid[0],o=t.parseInt(i.pep.y/this.options.grid[1])*this.options.grid[1];this.addToLIFO({
time:i.timeStamp,x:n,y:o});var s,a;if(e.inArray(i.type,this.startTriggerArray)>-1?(s=0,a=0):(s=n-this.ev.x,a=o-this.ev.y),this.dx=s,this.dy=a,this.ev.x=n,this.ev.y=o,0===s&&0===a)return void this.log({type:"event",event:"** stopped **"});var r=Math.abs(this.startX-n),c=Math.abs(this.startY-o);!this.started&&(r>this.options.startThreshold[0]||c>this.options.startThreshold[1])&&(this.started=!0,this.$el.addClass("pep-start"),this.options.start.call(this,this.startEvent,this)),this.options.droppable&&this.calculateActiveDropRegions();var l=this.options.drag.call(this,i,this);if(l===!1)return void this.resetVelocityQueue();this.log({type:"event",event:i.type}),this.log({type:"event-coords",x:this.ev.x,y:this.ev.y}),this.log({type:"velocity"}),this.doMoveTo(s,a)}},n.prototype.doMoveTo=function(e,t){var i,n,o=this.handleConstraint(e,t);"function"==typeof this.options.moveTo?(i=e>=0?"+="+Math.abs(e/this.scale)*this.options.multiplier:"-="+Math.abs(e/this.scale)*this.options.multiplier,n=t>=0?"+="+Math.abs(t/this.scale)*this.options.multiplier:"-="+Math.abs(t/this.scale)*this.options.multiplier,this.options.constrainTo&&(i=o.x!==!1?o.x:i,n=o.y!==!1?o.y:n),"x"===this.options.axis&&(n=o.y),"y"===this.options.axis&&(i=o.x),this.options.moveTo.call(this,i,n)):this.shouldUseCSSTranslation()?(e=e/this.scale*this.options.multiplier,t=t/this.scale*this.options.multiplier,this.options.constrainTo&&(e=o.x===!1?e:0,t=o.y===!1?t:0),"x"===this.options.axis&&(t=0),"y"===this.options.axis&&(e=0),this.moveToUsingTransforms(e,t)):(i=e>=0?"+="+Math.abs(e/this.scale)*this.options.multiplier:"-="+Math.abs(e/this.scale)*this.options.multiplier,n=t>=0?"+="+Math.abs(t/this.scale)*this.options.multiplier:"-="+Math.abs(t/this.scale)*this.options.multiplier,this.options.constrainTo&&(i=o.x!==!1?o.x:i,n=o.y!==!1?o.y:n),"x"===this.options.axis&&(n=o.y),"y"===this.options.axis&&(i=o.x),this.moveTo(i,n))},n.prototype.handleStop=function(t){this.active&&(this.log({type:"event",event:t.type}),this.active=!1,this.$el.removeClass("pep-start").addClass("pep-ease"),this.options.droppable&&this.calculateActiveDropRegions(),(this.started||!this.started&&e.inArray("stop",this.options.callIfNotStarted)>-1)&&this.options.stop.call(this,t,this),this.options.shouldEase?this.ease(t,this.started):this.removeActiveClass(),this.options.revert&&("stop"===this.options.revertAfter||!this.options.shouldEase)&&this.options.revertIf&&this.options.revertIf.call(this)&&this.revert(),this.started=!1,this.resetVelocityQueue())},n.prototype.ease=function(t,i){var n=(this.$el.position(),this.velocity()),o=(this.dt,n.x/this.scale*this.options.multiplier),s=n.y/this.scale*this.options.multiplier,a=this.handleConstraint(o,s,!0);this.cssAnimationsSupported()&&this.$el.css(this.getCSSEaseHash());var r=n.x>0?"+="+o:"-="+Math.abs(o),c=n.y>0?"+="+s:"-="+Math.abs(s);this.options.constrainTo&&(r=a.x!==!1?a.x:r,c=a.y!==!1?a.y:c),"x"===this.options.axis&&(c="+=0"),"y"===this.options.axis&&(r="+=0");var l=!this.cssAnimationsSupported()||this.options.forceNonCSS3Movement;"function"==typeof this.options.moveTo?this.options.moveTo.call(this,r,c):this.moveTo(r,c,l);var d=this;this.restTimeout=setTimeout(function(){d.options.droppable&&d.calculateActiveDropRegions(),(i||!i&&e.inArray("rest",d.options.callIfNotStarted)>-1)&&d.options.rest.call(d,t,d),d.options.revert&&"ease"===d.options.revertAfter&&d.options.shouldEase&&d.options.revertIf&&d.options.revertIf.call(d)&&d.revert(),d.removeActiveClass()},this.options.cssEaseDuration)},n.prototype.normalizeEvent=function(e){return e.pep={},this.isPointerEventCompatible()||!this.isTouch(e)?(e.pageX?(e.pep.x=e.pageX,e.pep.y=e.pageY):(e.pep.x=e.originalEvent.pageX,e.pep.y=e.originalEvent.pageY),e.pep.type=e.type):(e.pep.x=e.originalEvent.touches[0].pageX,e.pep.y=e.originalEvent.touches[0].pageY,e.pep.type=e.type),e},n.prototype.resetVelocityQueue=function(){this.velocityQueue=new Array(5)},n.prototype.moveTo=function(e,t,i){this.log({type:"delta",x:e,y:t}),i?this.$el.animate({top:t,left:e},0,"easeOutQuad",{queue:!1}):this.$el.stop(!0,!1).css({top:t,left:e})},n.prototype.moveToUsingTransforms=function(e,t){var i=this.matrixToArray(this.matrixString());this.cssX||(this.cssX=this.xTranslation(i)),this.cssY||(this.cssY=this.yTranslation(i)),this.cssX=this.cssX+e,this.cssY=this.cssY+t,this.log({type:"delta",x:e,y:t}),i[4]=this.cssX,i[5]=this.cssY,this.translation=this.arrayToMatrix(i),this.transform(this.translation)},n.prototype.transform=function(e){this.$el.css({"-webkit-transform":e,"-moz-transform":e,"-ms-transform":e,"-o-transform":e,transform:e})},n.prototype.xTranslation=function(e){return e=e||this.matrixToArray(this.matrixString()),parseInt(e[4],10)},n.prototype.yTranslation=function(e){return e=e||this.matrixToArray(this.matrixString()),parseInt(e[5],10)},n.prototype.matrixString=function(){var e=function(e){return!(!e||"none"===e||e.indexOf("matrix")<0)},t="matrix(1, 0, 0, 1, 0, 0)";return e(this.$el.css("-webkit-transform"))&&(t=this.$el.css("-webkit-transform")),e(this.$el.css("-moz-transform"))&&(t=this.$el.css("-moz-transform")),e(this.$el.css("-ms-transform"))&&(t=this.$el.css("-ms-transform")),e(this.$el.css("-o-transform"))&&(t=this.$el.css("-o-transform")),e(this.$el.css("transform"))&&(t=this.$el.css("transform")),t},n.prototype.matrixToArray=function(e){return e.split("(")[1].split(")")[0].split(",")},n.prototype.arrayToMatrix=function(e){return"matrix("+e.join(",")+")"},n.prototype.addToLIFO=function(e){var t=this.velocityQueue;t=t.slice(1,t.length),t.push(e),this.velocityQueue=t},n.prototype.velocity=function(){for(var e=0,t=0,i=0;i<this.velocityQueue.length-1;i++)this.velocityQueue[i]&&(e+=this.velocityQueue[i+1].x-this.velocityQueue[i].x,t+=this.velocityQueue[i+1].y-this.velocityQueue[i].y,this.dt=this.velocityQueue[i+1].time-this.velocityQueue[i].time);return{x:e*this.options.velocityMultiplier,y:t*this.options.velocityMultiplier}},n.prototype.revert=function(){this.shouldUseCSSTranslation()&&this.moveToUsingTransforms(-this.xTranslation(),-this.yTranslation()),this.moveTo(this.initialPosition.left,this.initialPosition.top)},n.prototype.requestAnimationFrame=function(e){return t.requestAnimationFrame&&t.requestAnimationFrame(e)||t.webkitRequestAnimationFrame&&t.webkitRequestAnimationFrame(e)||t.mozRequestAnimationFrame&&t.mozRequestAnimationFrame(e)||t.oRequestAnimationFrame&&t.mozRequestAnimationFrame(e)||t.msRequestAnimationFrame&&t.msRequestAnimationFrame(e)||t.setTimeout(e,1e3/60)},n.prototype.positionParent=function(){this.options.constrainTo&&!this.parentPositioned&&(this.parentPositioned=!0,"parent"===this.options.constrainTo?this.$container.css({position:"relative"}):"window"===this.options.constrainTo&&"#document"!==this.$container.get(0).nodeName&&"static"!==this.$container.css("position")&&this.$container.css({position:"static"}))},n.prototype.placeObject=function(){this.objectPlaced||(this.objectPlaced=!0,this.offset="parent"===this.options.constrainTo||this.hasNonBodyRelative()?this.$el.position():this.$el.offset(),parseInt(this.$el.css("left"),10)&&(this.offset.left=this.$el.css("left")),parseInt(this.$el.css("top"),10)&&(this.offset.top=this.$el.css("top")),this.options.removeMargins&&this.$el.css({margin:0}),this.$el.css({position:"absolute",top:this.offset.top,left:this.offset.left}))},n.prototype.hasNonBodyRelative=function(){return this.$el.parents().filter(function(){var t=e(this);return t.is("body")||"relative"===t.css("position")}).length>1},n.prototype.setScale=function(e){this.scale=e},n.prototype.setMultiplier=function(e){this.options.multiplier=e},n.prototype.removeCSSEasing=function(){this.cssAnimationsSupported()&&this.$el.css(this.getCSSEaseHash(!0))},n.prototype.disableSelect=function(){this.$el.css({"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"})},n.prototype.removeActiveClass=function(){this.$el.removeClass([this.options.activeClass,"pep-ease"].join(" "))},n.prototype.handleConstraint=function(t,n,o){var s=this.$el.position();this.pos.x=s.left,this.pos.y=s.top;var a,r,c,l,d={x:!1,y:!1};return this.log({type:"pos-coords",x:this.pos.x,y:this.pos.y}),e.isArray(this.options.constrainTo)?(this.options.constrainTo[3]!==i&&this.options.constrainTo[1]!==i&&(r=this.options.constrainTo[1]===!1?1/0:this.options.constrainTo[1],c=this.options.constrainTo[3]===!1?-(1/0):this.options.constrainTo[3]),this.options.constrainTo[0]!==!1&&this.options.constrainTo[2]!==!1&&(a=this.options.constrainTo[2]===!1?1/0:this.options.constrainTo[2],l=this.options.constrainTo[0]===!1?-(1/0):this.options.constrainTo[0]),this.pos.x+t<c&&(d.x=c),this.pos.y+n<l&&(d.y=l)):"string"==typeof this.options.constrainTo&&(c=0,l=0,r=this.$container.width()-this.$el.outerWidth(),a=this.$container.height()-this.$el.outerHeight(),this.pos.x+t<0&&(d.x=0),this.pos.y+n<0&&(d.y=0)),this.pos.x+t>r&&(d.x=r),this.pos.y+n>a&&(d.y=a),this.shouldUseCSSTranslation()&&o&&(d.x===c&&this.xTranslation()&&(d.x=c-this.xTranslation()),d.x===r&&this.xTranslation()&&(d.x=r-this.xTranslation()),d.y===l&&this.yTranslation()&&(d.y=l-this.yTranslation()),d.y===a&&this.yTranslation()&&(d.y=a-this.yTranslation())),d},n.prototype.getCSSEaseHash=function(e){"undefined"==typeof e&&(e=!1);var t;if(e)t="";else{if(this.CSSEaseHash)return this.CSSEaseHash;t=["all",this.options.cssEaseDuration+"ms",this.options.cssEaseString].join(" ")}return{"-webkit-transition":t,"-moz-transition":t,"-ms-transition":t,"-o-transition":t,transition:t}},n.prototype.calculateActiveDropRegions=function(){var t=this;this.activeDropRegions.length=0,e.each(e(this.options.droppable),function(i,n){var o=e(n);t.isOverlapping(o,t.$el)?(o.addClass(t.options.droppableActiveClass),t.activeDropRegions.push(o)):o.removeClass(t.options.droppableActiveClass)})},n.prototype.isOverlapping=function(e,t){if(this.options.overlapFunction)return this.options.overlapFunction(e,t);var i=e[0].getBoundingClientRect(),n=t[0].getBoundingClientRect();return!(i.right<n.left||i.left>n.right||i.bottom<n.top||i.top>n.bottom)},n.prototype.isTouch=function(e){return e.type.search("touch")>-1},n.prototype.isPointerEventCompatible=function(){return"MSPointerEvent"in t},n.prototype.applyMSDefaults=function(e){this.$el.css({"-ms-touch-action":"none","touch-action":"none","-ms-scroll-chaining":"none","-ms-scroll-limit":"0 0 0 0"})},n.prototype.isValidMoveEvent=function(e){return!this.isTouch(e)||this.isTouch(e)&&e.originalEvent&&e.originalEvent.touches&&1===e.originalEvent.touches.length},n.prototype.shouldUseCSSTranslation=function(){if(this.options.forceNonCSS3Movement)return!1;if("undefined"!=typeof this.useCSSTranslation)return this.useCSSTranslation;var e=!1;return e=!(!this.options.useCSSTranslation||"undefined"!=typeof Modernizr&&!Modernizr.csstransforms),this.useCSSTranslation=e,e},n.prototype.cssAnimationsSupported=function(){if("undefined"!=typeof this.cssAnimationsSupport)return this.cssAnimationsSupport;if("undefined"!=typeof Modernizr&&Modernizr.cssanimations)return this.cssAnimationsSupport=!0,!0;var e=!1,t=document.createElement("div"),n="animation",o="",s="Webkit Moz O ms Khtml".split(" "),a="";if(t.style.animationName&&(e=!0),e===!1)for(var r=0;r<s.length;r++)if(t.style[s[r]+"AnimationName"]!==i){a=s[r],n=a+"Animation",o="-"+a.toLowerCase()+"-",e=!0;break}return this.cssAnimationsSupport=e,e},n.prototype.hardwareAccelerate=function(){this.$el.css({"-webkit-perspective":1e3,perspective:1e3,"-webkit-backface-visibility":"hidden","backface-visibility":"hidden"})},n.prototype.getMovementValues=function(){return{ev:this.ev,pos:this.pos,velocity:this.velocity()}},n.prototype.buildDebugDiv=function(){var t;0===e("#pep-debug").length&&(t=e("<div></div>"),t.attr("id","pep-debug").append("<div style='font-weight:bold; background: red; color: white;'>DEBUG MODE</div>").append("<div id='pep-debug-event'>no event</div>").append("<div id='pep-debug-ev-coords'>event coords: <span class='pep-x'>-</span>, <span class='pep-y'>-</span></div>").append("<div id='pep-debug-pos-coords'>position coords: <span class='pep-x'>-</span>, <span class='pep-y'>-</span></div>").append("<div id='pep-debug-velocity'>velocity: <span class='pep-x'>-</span>, <span class='pep-y'>-</span></div>").append("<div id='pep-debug-delta'>&Delta; movement: <span class='pep-x'>-</span>, <span class='pep-y'>-</span></div>").css({position:"fixed",bottom:5,right:5,zIndex:99999,textAlign:"right",fontFamily:"Arial, sans",fontSize:10,border:"1px solid #DDD",padding:"3px",background:"white",color:"#333"}));var i=this;setTimeout(function(){i.debugElements={$event:e("#pep-debug-event"),$velocityX:e("#pep-debug-velocity .pep-x"),$velocityY:e("#pep-debug-velocity .pep-y"),$dX:e("#pep-debug-delta .pep-x"),$dY:e("#pep-debug-delta .pep-y"),$evCoordsX:e("#pep-debug-ev-coords .pep-x"),$evCoordsY:e("#pep-debug-ev-coords .pep-y"),$posCoordsX:e("#pep-debug-pos-coords .pep-x"),$posCoordsY:e("#pep-debug-pos-coords .pep-y")}},0),e("body").append(t)},n.prototype.log=function(e){if(this.options.debug)switch(e.type){case"event":this.debugElements.$event.text(e.event);break;case"pos-coords":this.debugElements.$posCoordsX.text(e.x),this.debugElements.$posCoordsY.text(e.y);break;case"event-coords":this.debugElements.$evCoordsX.text(e.x),this.debugElements.$evCoordsY.text(e.y);break;case"delta":this.debugElements.$dX.text(e.x),this.debugElements.$dY.text(e.y);break;case"velocity":var t=this.velocity();this.debugElements.$velocityX.text(Math.round(t.x)),this.debugElements.$velocityY.text(Math.round(t.y))}},n.prototype.toggle=function(e){"undefined"==typeof e?this.disabled=!this.disabled:this.disabled=!e},e.extend(e.easing,{easeOutQuad:function(e,t,i,n,o){return-n*(t/=o)*(t-2)+i},easeOutCirc:function(e,t,i,n,o){return n*Math.sqrt(1-(t=t/o-1)*t)+i},easeOutExpo:function(e,t,i,n,o){return t===o?i+n:n*(-Math.pow(2,-10*t/o)+1)+i}}),e.fn[o]=function(t){return this.each(function(){if(!e.data(this,"plugin_"+o)){var i=new n(this,t);e.data(this,"plugin_"+o,i),e.pep.peps.push(i)}})},e.pep={},e.pep.peps=[],e.pep.toggleAll=function(t){e.each(this.peps,function(e,i){i.toggle(t)})},e.pep.unbind=function(e){var t=e.data("plugin_"+o);"undefined"!=typeof t&&(t.toggle(!1),t.unsubscribe(),e.removeData("plugin_"+o))}}(jQuery,window),ccm_t=function(e){return $("input[name=ccm-string-"+e+"]").val()},ccm_parseJSON=function(e,t){e.error?alert(e.message):t()},ccm_addHeaderItem=function(e,t){var i=e.indexOf("?")!=-1?"&ts=":"?ts=";if("CSS"==t)if(navigator.userAgent.indexOf("MSIE")!=-1){var n=document.createElement("link"),o=document.getElementsByTagName("head")[0];n.type="text/css",n.rel="stylesheet",n.href=e,n.media="screen",o.appendChild(n)}else $("head").children('link[href*="'+e+'"]').length||$("head").children('link[data-source~="'+e+'"]').length||$("head").append('<link rel="stylesheet" media="screen" type="text/css" href="'+e+i+(new Date).getTime()+'" />');else"JAVASCRIPT"==t?$('script[src*="'+e+'"]').length||$('script[data-source~="'+e+'"]').length||$("head").append('<script type="text/javascript" src="'+e+i+(new Date).getTime()+'"></script>'):$("head").children(e).length||$("head").append(e)};var ccm_isBlockError=!1,ccm_blockError=!1;ccm_addError=function(e){ccm_isBlockError||(ccm_blockError="",ccm_blockError+="<ul>"),ccm_isBlockError=!0,ccm_blockError+="<li>"+e+"</li>"},ccm_resetBlockErrors=function(){ccm_isBlockError=!1,ccm_blockError=""},!function(e,t){"use strict";function i(e){var i=this;e=e||{},e=t.extend({dataType:"json",type:"post",loader:"standard",error:function(e){i.error(e,i)},complete:function(){i.complete(i)}},e),i.options=e,i.execute()}i.prototype={execute:function(){var e=this,i=e.options,n=i.success;i.success=function(t){e.success(t,e,n)},e.before(e),t.ajax(i)},before:function(e){e.options.loader&&jQuery.fn.dialog.showLoader()},errorResponseToString:function(e){var i=e.responseText;if(e.responseJSON){var n=e.responseJSON;t.isArray(n.errors)&&n.errors.length>0&&"string"==typeof n.errors[0]?i=n.errors.join("\n"):"string"==typeof n.error&&""!==n.error&&(i=n.error)}return i},error:function(e,t){ConcreteEvent.fire("AjaxRequestError",{response:e}),ConcreteAlert.dialog("Error",t.errorResponseToString(e))},validateResponse:function(e){return!e.error||(ConcreteEvent.fire("AjaxRequestError",{response:e}),ConcreteAlert.dialog("Error",e.errors.join("<br/>")),!1)},success:function(e,t,i){("json"!=t.options.dataType||t.validateResponse(e))&&i&&i(e)},complete:function(e){jQuery.fn.dialog.hideLoader()}},i.validateResponse=i.prototype.validateResponse,i.errorResponseToString=i.prototype.errorResponseToString,t.concreteAjax=function(e){new i(e)},e.ConcreteAjaxRequest=i}(this,$),!function(e,t){"use strict";function i(e,i){var n=this;return i=i||{},i=t.extend({progressiveOperation:!1,progressiveOperationTitle:"",progressiveOperationElement:"",beforeSubmit:n.before,complete:n.complete,data:{}},i),n.$form=e,i.progressiveOperation&&(i.dataType="html"),ConcreteAjaxRequest.call(n,i),n.$form}i.prototype=Object.create(ConcreteAjaxRequest.prototype),i.prototype.execute=function(){var e=this,t=e.options,i=t.success,n=t.error;e.$form.ajaxForm({type:t.type,data:t.data,url:t.url,dataType:t.dataType,beforeSubmit:function(){t.beforeSubmit(e)},error:function(t){e.error(t,e,n)},success:function(t){e.success(t,e,i)},complete:function(){t.complete(e)}})},i.prototype.handleProgressiveOperation=function(e,i){var n=this,o=n.$form.attr("action")?n.$form.attr("action"):n.options.url,s=n.$form.formToArray(!0);if(jQuery.fn.dialog.hideLoader(),n.options.progressiveOperationElement){var a=t(n.options.progressiveOperationElement);a.html(e);var r=t("#ccm-progressive-operation-progress-bar").attr("data-total-items");ccm_doProgressiveOperation(o,s,r,i,!1,a)}else t('<div id="ccm-dialog-progress-bar" />').appendTo(document.body).html(e).jqdialog({autoOpen:!1,height:200,width:400,modal:!0,title:n.options.progressiveOperationTitle,closeOnEscape:!1,open:function(e,n){t(".ui-dialog-titlebar-close",this.parentNode).hide();var a=t("#ccm-progressive-operation-progress-bar").attr("data-total-items");ccm_doProgressiveOperation(o,s,a,function(e){i(e)})}}),t("#ccm-dialog-progress-bar").jqdialog("open")},i.prototype.error=function(e,t,i){ConcreteAjaxRequest.prototype.error(e,t),i&&i(e)},i.prototype.doFinish=function(e){var t=this;ConcreteEvent.publish("AjaxFormSubmitSuccess",{response:e,form:t.$form.attr("data-dialog-form")}),e.redirectURL?window.location.href=e.redirectURL:(t.$form.attr("data-dialog-form")&&jQuery.fn.dialog.closeTop(),e.message&&ConcreteAlert.notify({message:e.message,title:e.title}))},i.prototype.success=function(e,t,i){t.validateResponse(e)&&(i?t.options.progressiveOperation?t.handleProgressiveOperation(e,function(e){i(e)}):i(e):t.options.progressiveOperation?t.handleProgressiveOperation(e,function(e){t.doFinish(e)}):t.doFinish(e))},t.fn.concreteAjaxForm=function(e){return t.each(t(this),function(n,o){new i(t(this),e)})},e.ConcreteAjaxForm=i}(this,$),!function(e,t){"use strict";function i(e,i){var n=this;return i=t.extend({iframe:!0,task:!1,dragAreaBlockID:!1,dragArea:null,bID:!1,loader:!0},i),n.options=i,i.dragAreaBlockID&&e.find("input[name=dragAreaBlockID]").val(i.dragAreaBlockID),ConcreteAjaxForm.call(n,e,i),e}i.prototype=Object.create(ConcreteAjaxForm.prototype),i.prototype.before=function(e){jQuery.fn.dialog.showLoader(),ConcreteEvent.fire("EditModeBeforeBlockSubmit",{form:e})},i.prototype.refreshBlock=function(e){var i=this,n=e.cID?e.cID:CCM_CID,o=new Concrete.getEditMode,s=o.getAreaByID(e.aID),a=s.getEnableGridContainer()?1:0,r=CCM_DISPATCHER_FILENAME+"/ccm/system/block/render";jQuery.fn.dialog.closeTop(),t.get(r,{arHandle:s.getHandle(),cID:n,bID:e.bID,arEnableGridContainer:a,placeholder:""},function(e){var n,a=Concrete.getEditMode(),r=s.inEditMode(a);if(ConcreteToolbar.disableDirectExit(),jQuery.fn.dialog.hideLoader(),"add"==i.options.task){var c=r.getElem(),l=t(e);if(!l.hasClass("ccm-block-edit")){var d=l.find(".ccm-block-edit");d.length&&(n=new Concrete.Block(d,a),n.setArea(r))}if(n||(n=new Concrete.Block(l,a),n.setArea(r)),"core_area_layout"===i.options.btHandle)c.children(".ccm-area-block-list").append(l);else{var p=t(i.options.placeholder);p.length?p.replaceWith(l):c.children(".ccm-area-block-list").prepend(l)}ConcreteAlert.notify({message:ccmi18n.addBlockMsg,title:ccmi18n.addBlock}),jQuery.fn.dialog.closeAll(),i.options.btSupportsInlineAdd&&(o.destroyInlineEditModeToolbars(),ConcreteEvent.fire("EditModeExitInlineComplete",{block:n})),ConcreteEvent.fire("EditModeAddBlockComplete",{block:n})}else{n=r.getBlockByID(i.options.bID);var u=n.replace(e);ConcreteAlert.notify({message:ccmi18n.updateBlockMsg,title:ccmi18n.updateBlock}),i.options.btSupportsInlineEdit&&(o.destroyInlineEditModeToolbars(),ConcreteEvent.fire("EditModeExitInlineComplete",{block:u})),ConcreteEvent.fire("EditModeUpdateBlockComplete",{block:u})}})},i.prototype.success=function(e,t){t.options.progressiveOperation?t.handleProgressiveOperation(e,function(e){t.refreshBlock(e)}):t.validateResponse(e)&&t.refreshBlock(e)},t.fn.concreteAjaxBlockForm=function(e){return t.each(t(this),function(n,o){new i(t(this),e)})},e.ConcreteAjaxBlockForm=i}(this,$),jQuery.cookie=function(e,t,i){if("undefined"==typeof t){var n=null;if(document.cookie&&""!=document.cookie)for(var o=document.cookie.split(";"),s=0;s<o.length;s++){var a=jQuery.trim(o[s]);if(a.substring(0,e.length+1)==e+"="){n=decodeURIComponent(a.substring(e.length+1));break}}return n}i=i||{},null===t&&(t="",i=$.extend({},i),i.expires=-1);var r="";if(i.expires&&("number"==typeof i.expires||i.expires.toUTCString)){var c;"number"==typeof i.expires?(c=new Date,c.setTime(c.getTime()+24*i.expires*60*60*1e3)):c=i.expires,r="; expires="+c.toUTCString()}var l=i.path?"; path="+i.path:"",d=i.domain?"; domain="+i.domain:"",p=i.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),r,l,d,p].join("")};var html=$("html"),ConcretePanelManager=function(){"use strict";var e=[];return{getPanels:function(){return e},showOverlay:function(e){$("#ccm-panel-overlay").clearQueue().show(0).delay(100).queue(function(){e?$(this).addClass("ccm-panel-translucent"):$(this).removeClass("ccm-panel-translucent"),$(this).dequeue()})},exitPanelMode:function(t){t=t||$.noop;for(var i=0,n=0;n<e.length;n++)e[n].isOpen&&(i++,e[n].hide(function(){i--,0==i&&t.call(null)}))},register:function(t){var i=$.extend({translucent:!0,overlay:!0,position:"left",primary:!0,transition:"slide"},t),n=new ConcretePanel(i);e.push(n);var o=$("#"+n.getDOMID());o.length||($("<div />",{id:n.getDOMID(),"class":"ccm-panel "+n.getPositionClass()}).appendTo($(document.body)),$("<div />",{"class":"ccm-panel-content-wrapper ccm-ui ccm-ui-fieldless"}).appendTo($("#"+n.getDOMID())))},getByIdentifier:function(t){for(var i=0;i<e.length;i++)if(e[i].getIdentifier()==t)return e[i]}}}();$.widget("concrete.dialog",$.ui.dialog,{_allowInteraction:function(e){return!!$(e.target).closest(".ccm-interaction-dialog").length||!!$(e.target).closest(".cke_dialog").length||this._super(e)}}),$.widget.bridge("jqdialog",$.concrete.dialog),jQuery.fn.dialog=function(){return arguments.length>0?void $(this).jqdialog(arguments[0],arguments[1],arguments[2]):$(this).is("div")?void $(this).jqdialog():$(this).each(function(){$(this).unbind("click.make-dialog").bind("click.make-dialog",function(e){var t=$(this).attr("href"),i=$(this).attr("dialog-width"),n=$(this).attr("dialog-height"),o=$(this).attr("dialog-title"),s=$(this).attr("dialog-on-open"),a=$(this).attr("dialog-class"),r=$(this).attr("dialog-on-destroy"),c=$(this).attr("dialog-on-close"),l=$(this).attr("dialog-on-direct-close");return obj={modal:!0,href:t,width:i,height:n,title:o,onOpen:s,onDestroy:r,dialogClass:a,onClose:c,onDirectClose:l},jQuery.fn.dialog.open(obj),!1})})},jQuery.fn.dialog.close=function(e){e++,$("#ccm-dialog-content"+e).jqdialog("close")},jQuery.fn.dialog.open=function(options){if("undefined"!=typeof ConcreteMenu){var activeMenu=ConcreteMenuManager.getActiveMenu();activeMenu&&activeMenu.hide()}"string"==typeof options.width?"auto"==options.width?w="auto":options.width.indexOf("%",0)>0?(w=options.width.replace("%",""),w=$(window).width()*(w/100),w+=50):w=parseInt(options.width)+50:options.width?w=parseInt(options.width)+50:w=550,"string"==typeof options.height?"auto"==options.height?h="auto":options.height.indexOf("%",0)>0?(h=options.height.replace("%",""),h=$(window).height()*(h/100),h+=100):h=parseInt(options.height)+100:options.height?h=parseInt(options.height)+100:h=400,"auto"!==h&&h>$(window).height()&&(h=$(window).height()),options.width=w,options.height=h;var defaults={modal:!0,escapeClose:!0,width:w,height:h,dialogClass:"ccm-ui ccm-ui-fieldless",resizable:!0,create:function(){$(this).parent().addClass("animated fadeIn")},open:function(){var $dialog=$(this),nd=$(".ui-dialog").length;1==nd&&($("body").attr("data-last-overflow",$("body").css("overflow")),$("body").css("overflow","hidden"));var overlays=$(".ui-widget-overlay").length;if($(".ui-widget-overlay").each(function(e,t){e+1<overlays&&$(this).removeClass("animated fadeIn").css("opacity",0)}),1==overlays&&$(".ui-widget-overlay").addClass("animated fadeIn"),jQuery.fn.dialog.activateDialogContents($dialog),$dialog.jqdialog("option","resizable")){var $wrapper=$($dialog.parent()),z=parseInt($wrapper.find(".ui-dialog-buttonpane").css("z-index"));$wrapper.find(".ui-resizable-handle").css("z-index",z+1e3)}"undefined"!=typeof options.onOpen&&("function"==typeof options.onOpen?options.onOpen($dialog):eval(options.onOpen))},beforeClose:function(){var e=$(".ui-dialog:visible").length;1==e&&$("body").css("overflow",$("body").attr("data-last-overflow"))},close:function(ev,u){options.element||$(this).jqdialog("destroy").remove(),"undefined"!=typeof options.onClose&&("function"==typeof options.onClose?options.onClose($(this)):eval(options.onClose)),"undefined"==typeof options.onDirectClose||!ev.handleObj||"keydown"!=ev.handleObj.type&&"click"!=ev.handleObj.type||("function"==typeof options.onDirectClose?options.onDirectClose():eval(options.onDirectClose)),"undefined"!=typeof options.onDestroy&&("function"==typeof options.onDestroy?options.onDestroy():eval(options.onDestroy));var overlays=$(".ui-widget-overlay").length;$(".ui-widget-overlay").each(function(e,t){e+1<overlays?$(this).css("opacity",0):$(this).css("opacity",1)})}},finalSettings={autoOpen:!1,data:{}};$.extend(finalSettings,defaults,options),finalSettings.element?($(finalSettings.element).jqdialog(finalSettings).jqdialog(),$(finalSettings.element).jqdialog("open")):(jQuery.fn.dialog.showLoader(),$.ajax({type:"GET",url:finalSettings.href,data:finalSettings.data,success:function(e){jQuery.fn.dialog.hideLoader(),$("<div />").jqdialog(finalSettings).html(e).jqdialog("open")}}))},jQuery.fn.dialog.activateDialogContents=function(e){if(e.find("button[data-dialog-action=cancel]").on("click",function(){jQuery.fn.dialog.closeTop()}),e.find("[data-dialog-form]").each(function(){var e=($(this),{});"progressive"==$(this).attr("data-dialog-form-processing")&&(e.progressiveOperation=!0,e.progressiveOperationElement="div[data-dialog-form-element=progress-bar]"),$(this).concreteAjaxForm(e)}),e.find("button[data-dialog-action=submit]").on("click",function(){e.find("[data-dialog-form]").submit()}),e.find(".dialog-buttons").length>0&&(e.jqdialog("option","buttons",[{}]),e.parent().find(".ui-dialog-buttonset").remove(),e.parent().find(".ui-dialog-buttonpane").html(""),e.find(".dialog-buttons").eq(0).removeClass().appendTo(e.parent().find(".ui-dialog-buttonpane").addClass("ccm-ui"))),e.find(".dialog-launch").dialog(),e.find(".ccm-dialog-close").on("click",function(){e.dialog("close")}),e.find(".launch-tooltip").tooltip({container:"#ccm-tooltip-holder"}),e.find(".dialog-help").length>0){e.find(".dialog-help").hide();var t=e.find(".dialog-help").html();if(ccmi18n.helpPopup){ccmi18n.helpPopup}else;var i=$('<button class="ui-dialog-titlebar-help ccm-menu-help-trigger"><i class="fa fa-info-circle"></i></button>'),n=$("#ccm-tooltip-holder");e.parent().find(".ui-dialog-titlebar").append(i),i.popover({content:function(){return t},placement:"bottom",html:!0,container:n,trigger:"click"}),i.on("shown.bs.popover",function(){var e=function(){i.popover("hide",i),e=$.noop};i.on("hide.bs.popover",function(t){i.unbind(t),e=$.noop}),$("body").mousedown(function(t){$(t.target).closest(n).length||$(t.target).closest(i).length||($(this).unbind(t),e())})})}},jQuery.fn.dialog.getTop=function(){var e=$(".ui-dialog:visible").length;return $($(".ui-dialog:visible")[e-1]).find(".ui-dialog-content")},jQuery.fn.dialog.replaceTop=function(e){$dialog=jQuery.fn.dialog.getTop(),$dialog.html(e),jQuery.fn.dialog.activateDialogContents($dialog)},jQuery.fn.dialog.showLoader=function(e){NProgress.start()},jQuery.fn.dialog.hideLoader=function(){NProgress.done()},jQuery.fn.dialog.closeTop=function(){$dialog=jQuery.fn.dialog.getTop(),$dialog.jqdialog("close")},jQuery.fn.dialog.closeAll=function(){$($(".ui-dialog-content").get().reverse()).jqdialog("close")},$.ui.dialog.prototype._focusTabbable=$.noop,PNotify.prototype.options.styling={container:"ccm-notification",notice:"ccm-notification-warning",notice_icon:"glyphicon glyphicon-exclamation-sign",info:"ccm-notification-info",info_icon:"glyphicon glyphicon-info-sign",success:"ccm-notification-success",success_icon:"glyphicon glyphicon-ok-sign",error:"ccm-notification-danger",error_icon:"glyphicon glyphicon-warning-sign",closer:"ccm-notification-closer",pin_up:!1,pin_down:!1},PNotify.prototype.options.width="400px",PNotify.prototype.options.addclass="ccm-ui",PNotify.prototype.options.animate={animate:!0,in_class:"fadeIn",out_class:"bounceOutRight"},PNotify.prototype.options.buttons.closer_hover=!1,!function(e,t){"use strict";var i={dialog:function(e,i,n){var o=t('<div id="ccm-popup-alert" class="ccm-ui"><div id="ccm-popup-alert-message" class="alert alert-danger">'+i+"</div></div>");o.dialog({title:e,width:500,height:"auto",modal:!0,close:function(){o.remove(),n&&n()}})},info:function(e){var i=t.extend({type:"info",icon:"question"},e);return this.notify(i)},error:function(e){var i=t.extend({type:"error",icon:"exclamation-circle"},e);return this.notify(i)},notify:function(e){var i=t.extend({type:"success",icon:"check",title:!1,message:!1,appendTo:!1,delay:2e3,callback:function(){}},e),n={text:i.message,icon:"fa fa-"+i.icon,type:i.type,delay:i.delay,after_close:i.callback};i.title&&(n.title=i.title),new PNotify(n)}};e.ConcreteAlert=i}(this,$),!function(e,t){"use strict";function i(e){var i=this;e=e||{},e=t.extend({width:"800",height:"450",title:"Help",href:CCM_DISPATCHER_FILENAME+"/dashboard/home?_ccm_dashboard_external=1",dialogClass:"ccm-dialog-slim ccm-dialog-help-wrapper",onOpen:function(e){i.positionArrows(e)}},e),i.options=e}i.prototype={positionArrows:function(e){e.find(".newsflow-paging-next").addClass("newsflow-paging-appended").appendTo(e.parent()),e.find(".newsflow-paging-previous").addClass("newsflow-paging-appended").appendTo(e.parent())},open:function(){var e=this;t.fn.dialog.open(e.options)}},i.loadEdition=function(e){var n=new i,o=CCM_TOOLS_PATH+"/newsflow?cID="+e;jQuery.fn.dialog.showLoader(),t.get(o,function(e){t(".newsflow-paging-appended").remove(),jQuery.fn.dialog.replaceTop(e),jQuery.fn.dialog.hideLoader(),$dialog=jQuery.fn.dialog.getTop(),n.positionArrows($dialog)})},e.ConcreteNewsflowDialog=i}(this,$),!function(e,t){"use strict";function i(e,i){var n=this;return i=i||{},i=t.extend({url:!1,data:{}},i),n.$element=e,n.options=i,n.initializeEditableFields(),n.initializeClearCommands(),n.$element}i.prototype={getAjaxURL:function(e){var t=this,i=t.options.url;return e.attr("data-url")&&(i=e.attr("data-url")),i},setupXeditableField:function(e){var t=this;e.editable({ajaxOptions:{dataType:"json"},emptytext:ccmi18n.none,showbuttons:!0,params:t.options.data,url:t.options.url,success:function(e,t){return ConcreteAjaxRequest.validateResponse(e)?{newValue:t}:""},pk:"_x"})},setupXeditableAttributeField:function(e){
var t=this;e.editable({ajaxOptions:{dataType:"json"},mode:e.data("editablemode"),emptytext:ccmi18n.none,showbuttons:!0,savenochange:!0,autotext:"never",url:t.options.url,params:function(e){var i=[];return i.push({name:"name",value:e.name}),i.push({name:"pk",value:e.pk}),_.each(t.options.data,function(e,t){"object"==typeof e?i.push({name:e.name,value:e.value}):i.push({name:t,value:e})}),_.each(e.value,function(e){i.push({name:e.name,value:e.value})}),i},success:function(e,t){return ConcreteAjaxRequest.validateResponse(e)?{newValue:e.value}:""},pk:"_x"})},setupImageField:function(e){var t=this,i=e.find(".editable-image-wrapper img");e.find(".editable-image-wrapper input").css("width",i.width()).css("height",i.height()),e.fileupload({url:t.getAjaxURL(e),dataType:"json",formData:t.options.data,start:function(){jQuery.fn.dialog.showLoader()},success:function(i){t.updateImageField(i,e)},error:function(e){ConcreteAlert.dialog("Error",e.responseText)},complete:function(e){jQuery.fn.dialog.hideLoader()}})},updateImageField:function(e,t){var i=this;ConcreteAjaxRequest.validateResponse(e)&&(t.find(".editable-image-display").html(e.imageHTML).find("img").attr("src",function(e,t){return t+"?"+(new Date).getTime()}),i.setupImageField(t),ConcreteAlert.notify({message:e.message}))},initializeEditableFields:function(){var e=this;e.$element.find("[data-editable-field-type]").each(function(){var i=t(this),n="setup"+i.attr("data-editable-field-type").charAt(0).toUpperCase()+i.attr("data-editable-field-type").slice(1)+"Field";e[n](i)})},initializeClearCommands:function(){var e=this;e.$element.on("click","[data-editable-field-command=clear]",function(){var i=t(this),n=i.closest("[data-editable-field-type]"),o="update"+n.attr("data-editable-field-type").charAt(0).toUpperCase()+n.attr("data-editable-field-type").slice(1)+"Field",s=e.options.data;s.task="clear";var a=e.getAjaxURL(n);return new ConcreteAjaxRequest({url:a,data:s,success:function(t){e[o](t,n)}}),!1}),e.$element.on("click","[data-editable-field-command=clear_attribute]",function(){var i=e.options.data,n=e.getAjaxURL(t(this)),o=t(this).attr("data-key-id"),s=[];return _.each(i,function(e,t){"object"==typeof e?s.push({name:e.name,value:e.value}):s.push({name:t,value:e})}),s.push({name:"akID",value:o}),new ConcreteAjaxRequest({url:n,data:s,success:function(e){t("[data-key-id="+o+"][data-editable-field-type=xeditableAttribute]").editable("setValue","")}}),!1})}},t.fn.concreteEditableFieldContainer=function(e){return t.each(t(this),function(n,o){new i(t(this),e)})},e.ConcreteEditableFieldContainer=i}(this,$),ccm_doPageReindexing=function(){$.get(CCM_TOOLS_PATH+"/reindex_pending_pages?ccm_token="+CCM_SECURITY_TOKEN)},!function(e,t,i){"use strict";function n(e,i){var n=this;i=i||{},i=t.extend({handle:"this",menu:!1,highlightClassName:"ccm-menu-highlight",highlightOffset:0,menuContainerClass:!1,menuActiveClass:"ccm-menu-item-active",menuActiveParentClass:"ccm-parent-menu-item-active",menuLauncherHoverClass:"ccm-menu-item-hover",menuLauncherHoverParentClass:"ccm-parent-menu-item-hover",enabled:!0,onHide:!1},i),n.$element=e,n.options=i,"none"==i.handle?n.$launcher=!1:(n.$launcher="this"==i.handle?n.$element:t(i.handle),n.$launcher.each(function(){var e=t(this);e.on("mousemove.concreteMenu",function(e){n.hoverProxy(e,t(this))})})),n.$menu=t(i.menu),n.setup(),Concrete.event.bind("EditModeBlockDragInitialization",function(){n.hide()})}n.prototype={setup:function(){var e=this,i=(e.options,o);i.$clickProxy||(i.$clickProxy=t("<div />",{id:"ccm-menu-click-proxy"}),i.$clickProxy.on("mouseout.concreteMenuProxy",function(e){var t=i.hoverMenu;t.mouseout(e)}),i.$clickProxy.on("mouseover.concreteMenuProxy",function(e){var t=i.hoverMenu;t.mouseover(e)}),i.$clickProxy.on("click.concreteMenuProxy",function(e){var t=i.hoverMenu;t.show(e)}),t(document.body).append(i.$clickProxy)),i.$highlighter||(i.$highlighter=t("<div />",{id:"ccm-menu-highlighter"}),t(document.body).append(i.$highlighter)),i.$container||(i.$container=t("<div />",{id:"ccm-popover-menu-container","class":"ccm-ui"}),t(document.body).append(i.$container))},destroy:function(){var e=this;e.hide(),e.$launcher.each(function(){t(this).unbind("mousemove.concreteMenu")})},positionAt:function(e,t){if(!t)return!1;var i=this,n=t.offset(),o={top:n.top-i.options.highlightOffset,left:n.left-i.options.highlightOffset,width:t.outerWidth()+2*i.options.highlightOffset,height:t.outerHeight()+2*i.options.highlightOffset,"border-top-left-radius":t.css("border-top-left-radius"),"border-top-right-radius":t.css("border-top-right-radius"),"border-bottom-left-radius":t.css("border-bottom-left-radius"),"border-bottom-right-radius":t.css("border-bottom-right-radius")};e.css(o)},hoverProxy:function(e,t){e.stopPropagation();var i=this,n=o,s=i.options.menuLauncherHoverClass,a=n.$clickProxy;return!(!n.enabled||n.activeMenu)&&(i.positionAt(a,t),a.removeClass().addClass(s),void(o.hoverMenu=i))},mouseover:function(e){var t=this.$launcher,i=this.options;t.addClass(i.menuLauncherHoverClass),t.parents("*").slice(0,3).addClass(i.menuLauncherHoverParentClass)},mouseout:function(e){var t=this.$launcher,i=this.options;t.removeClass(i.menuLauncherHoverClass),t.parents("*").slice(0,3).removeClass(i.menuLauncherHoverParentClass)},setupMenuOptions:function(e){e.find(".dialog-launch").dialog()},show:function(e){var n=this,s=o,a=n.options,r=n.$launcher,c=n.$element,l=s.$container,d=s.$highlighter,p=n.$menu.clone(!0,!0),u=e.pageX+2,h=e.pageY+2;p.on("contextmenu",function(){return!1}),e.stopPropagation(),d.removeClass(),n.positionAt(d,r),i.defer(function(){d.addClass(a.highlightClassName)}),c.addClass(a.menuActiveClass),c.parents("*").slice(0,3).addClass(a.menuActiveParentClass),n.setupMenuOptions(p),l.html(""),p.appendTo(l),a.menuContainerClass&&l.addClass(a.menuContainerClass),p.css("opacity",0).show();var f=p.width(),m=p.height(),g=t(window).height(),v=t(window).width(),y=f/2-5,b=m/2-5,C=["bottom","top","right","left"],k=C.slice(0);e.clientX<f+30&&(C=i(C).without("left")),v<e.clientX+f+30&&(C=i(C).without("right")),g<e.clientY+m+30&&(C=i(C).without("bottom")),e.clientY<m+30&&(C=i(C).without("top")),(v<e.clientX+y||e.clientX<y)&&(C=i(C).without("top","bottom")),(g<e.clientY+b||e.clientY<b)&&(C=i(C).without("left","right"));var w=C.shift();switch(p.removeClass(k).addClass(w),e.pageX-=2,e.pageY-=2,w){case"left":u=e.pageX-f,h=e.pageY-m/2;break;case"right":u=e.pageX,h=e.pageY-m/2;break;case"top":h=e.pageY-m,u=e.pageX-f/2;break;case"bottom":h=e.pageY,u=e.pageX-f/2}p.css({top:h,left:u}),i.defer(function(){p.css("opacity",1)}),p.find("a").click(function(e){n.hide(e)}),t(document).unbind(".concreteMenuDisable").on("click.concreteMenuDisable",function(e){n.hide(e)}),n.$menuPointer=p,o.activeMenu=n,ConcreteEvent.publish("ConcreteMenuShow",{menu:n,menuElement:p})},hide:function(e){var t=this,n=o,s={"class":"",width:0,height:0,top:0,left:0};e&&e.stopPropagation(),t.$menuPointer&&(t.$menuPointer.css("opacity",0),i.defer(function(){t.$menuPointer.hide()})),i.defer(function(){t.$element.removeClass(t.options.menuActiveClass),t.$element.parents("*").slice(0,3).removeClass(t.options.menuActiveParentClass),n.$highlighter.removeClass(),n.$container.removeClass().addClass("ccm-ui").html("")}),n.$clickProxy.css(s),n.$highlighter.css(s),o.activeMenu=!1,t.options.onHide&&t.options.onHide(t)}};var o={enabled:!0,$clickProxy:!1,$highlighter:!1,$container:!1,hoverMenu:!1,activeMenu:!1,reset:function(){this.$clickProxy.css("width",0).css("height",0),this.$container.html("")},enable:function(){this.enabled=!0,this.reset()},disable:function(){this.enabled=!1,this.reset()},getActiveMenu:function(){return this.activeMenu}};t.fn.concreteMenu=function(e){return t.each(t(this),function(i,o){new n(t(this),e)})},e.ConcreteMenu=n,e.ConcreteMenuManager=o}(this,$,_),String.prototype.score=function(e,t){if(t=t||0,0==e.length)return.9;if(e.length>this.length)return 0;for(var i=e.length;i>0;i--){var n=e.substring(0,i),o=this.indexOf(n);if(!(o<0||o+e.length>this.length+t)){var s=this.substring(o+n.length),a=null;a=i>=e.length?"":e.substring(i);var r=s.score(a,t+o);if(r>0){var c=this.length-s.length;if(0!=o){var l=0,d=this.charCodeAt(o-1);if(32==d||9==d)for(var l=o-2;l>=0;l--)d=this.charCodeAt(l),c-=32==d||9==d?1:.15;else c-=o}return c+=r*s.length,c/=this.length}}}return 0},!function(e,t,i){"use strict";var n={updatesShowMore:function(e){t(e).parent().hide(),t(e).parent().parent().find(".ccm-marketplace-update-changelog").css("max-height","none")},getMoreInformation:function(e){jQuery.fn.dialog.showLoader();var i={mpID:e};t.concreteAjax({method:"get",url:CCM_DISPATCHER_FILENAME+"/ccm/system/marketplace/connect",data:i,success:function(e){jQuery.fn.dialog.hideLoader(),e.isConnected?window.location.href=e.localURL:window.location.href=CCM_DISPATCHER_FILENAME+"/dashboard/extend/connect"}})},purchaseOrDownload:function(e){var i=e.mpID,n=e.closeTop;e.onComplete||(e.onComplete=function(e,t){jQuery.fn.dialog.closeTop()}),ConcreteEvent.subscribe("MarketplaceRequestComplete",e.onComplete),n&&jQuery.fn.dialog.closeTop(),jQuery.fn.dialog.showLoader();var o={mpID:i};t.getJSON(CCM_DISPATCHER_FILENAME+"/ccm/system/marketplace/connect",o,function(e){jQuery.fn.dialog.hideLoader(),e.isConnected?e.purchaseRequired?t.fn.dialog.open({title:ccmi18n.communityCheckout,iframe:!0,href:CCM_DISPATCHER_FILENAME+"/ccm/system/dialogs/marketplace/checkout?mpID="+i,width:"560px",modal:!1,height:"400px"}):t.fn.dialog.open({title:ccmi18n.communityDownload,href:CCM_DISPATCHER_FILENAME+"/ccm/system/dialogs/marketplace/download?mpID="+i,width:500,appendButtons:!0,modal:!1,height:400}):window.location.href=CCM_DISPATCHER_FILENAME+"/dashboard/extend/connect"})}};e.ConcreteMarketplace=n}(window,jQuery,_),!function(e,t){"use strict";t("table tr[data-search-row-url]").each(function(){t(this).hover(function(){t(this).addClass("ccm-search-select-hover")},function(){t(this).removeClass("ccm-search-select-hover")}),t(this).on("click",function(){window.location.href=t(this).attr("data-search-row-url")})})}(this,$),!function(e,t){"use strict";function i(e,i){i=i||{},i=t.extend({result:{},onLoad:!1,onUpdateResults:!1,bulkParameterName:"item",selectMode:!1,appendToOuterDialog:!1,searchMethod:"post"},i),this.$element=e,this.$results=e.find("div[data-search-element=results]"),this.$resultsTableBody=this.$results.find("tbody"),this.$resultsTableHead=this.$results.find("thead"),this.$resultsPagination=this.$results.find("div.ccm-search-results-pagination"),this.$menuTemplate=e.find("script[data-template=search-results-menu]"),this.$searchFieldRowTemplate=e.find("script[data-template=search-field-row]"),this.$headerSearchInput=e.find("div[data-header] input"),this.$advancedSearchButton=e.find("a[data-launch-dialog=advanced-search]"),this.$resetSearchButton=e.find("a[data-button-action=clear-search]"),this.options=i,e.find("script[data-template=search-form]").length&&(this._templateSearchForm=_.template(e.find("script[data-template=search-form]").html())),this._templateSearchResultsTableHead=_.template(e.find("script[data-template=search-results-table-head]").html()),this._templateSearchResultsTableBody=_.template(e.find("script[data-template=search-results-table-body]").html()),this._templateSearchResultsPagination=_.template(e.find("script[data-template=search-results-pagination]").html()),this.$menuTemplate.length&&(this._templateSearchResultsMenu=_.template(this.$menuTemplate.html())),this.$searchFieldRowTemplate.length&&(this._templateAdvancedSearchFieldRow=_.template(this.$searchFieldRowTemplate.html())),this.setupSearch(),this.setupCheckboxes(),this.setupSort(),this.setupPagination(),this.setupSelectize(),this.setupAdvancedSearch(),this.setupCustomizeColumns(),this.updateResults(i.result),i.onLoad&&i.onLoad(this)}i.prototype.setupResetButton=function(e){var t=this;e.query&&(t.$headerSearchInput.prop("disabled",!0),t.$headerSearchInput.attr("placeholder",""),t.$advancedSearchButton.html(ccmi18n_filemanager.edit),t.$resetSearchButton.show())},i.prototype.ajaxUpdate=function(e,i,n){var o=this;t.concreteAjax({url:e,data:i,method:o.options.searchMethod,success:function(e){o.scrollToTop(),n?n(e):o.updateResults(e)}})},i.prototype.scrollToTop=function(){var e=this,t=e.$element.closest(".ui-dialog-content");t.length?t.scrollTop(0):window.scrollTo(0,0)},i.prototype.getSearchData=function(){var e=this,t=e.$element.find("form[data-search-form]"),i=t.serializeArray();return i},i.prototype.setupSelectize=function(){var e=this.$element.find(".selectize-select");e.length&&e.selectize({plugins:["remove_button"]})},i.prototype.createMenu=function(e){e.concreteMenu({menu:t("[data-search-menu="+e.attr("data-launch-search-menu")+"]")})},i.prototype.setupMenus=function(e){var i=this;i._templateSearchResultsMenu&&(i.$element.find("[data-search-menu]").remove(),t.each(e.items,function(e,t){i.$results.append(i._templateSearchResultsMenu({item:t}))}),i.$element.find("tbody tr").each(function(){i.createMenu(t(this))}))},i.prototype.setupCustomizeColumns=function(){var e=this;e.$element.on("click","a[data-search-toggle=customize]",function(){var i=t(this).attr("data-search-column-customize-url");return t.fn.dialog.open({width:480,height:400,href:i,modal:!0,title:ccmi18n.customizeSearch,onOpen:function(){ConcreteEvent.subscribe("AjaxFormSubmitSuccess",function(t,i){e.updateResults(i.response.result)})}}),!1})},i.prototype.getSelectedResults=function(){var e=this,i=e.$element.find("tbody tr"),n=e.$element.find(".ccm-search-select-selected"),o=[];return n.each(function(){var n=i.index(t(this));n>-1&&o.push(e.getResult().items[n])}),o},i.prototype.showMenu=function(e,t,i){var n=new ConcreteMenu(e,{menu:t,handle:"none"});n.show(i)},i.prototype.handleSelectClick=function(e,t){var i=this;if(e.preventDefault(),t.removeClass("ccm-search-select-hover"),e.shiftKey){var n=i.$element.find(".ccm-search-select-selected"),o=i.$element.find("tbody tr").index(t);if(n.length){var s=i.$element.find("tbody tr").index(n.eq(0));s>-1&&(s>o?i.$element.find("tbody tr").slice(o,s+1).removeClass().addClass("ccm-search-select-selected"):i.$element.find("tbody tr").slice(s,o+1).removeClass().addClass("ccm-search-select-selected"))}else i.$element.find("tbody tr").slice(0,o+1).removeClass().addClass("ccm-search-select-selected");ConcreteEvent.publish("SearchSelectItems",{results:i.getSelectedResults()},i.$element)}else{if(3==e.which){t.hasClass("ccm-search-select-selected")||(i.$element.find(".ccm-search-select-selected").removeClass(),t.addClass("ccm-search-select-selected"));var a=i.getSelectedResults(),r=i.getResultMenu(a);r&&i.showMenu(t,r,e)}else t.hasClass("ccm-search-select-selected")||t.addClass("ccm-search-select-selected");ConcreteEvent.publish("SearchSelectItems",{results:i.getSelectedResults()},i.$element)}},i.prototype.getResult=function(){return this.result},i.prototype.updateResults=function(e){var i=this,n=i.options,o=null;i.result=e,i.$resultsTableHead.html(i._templateSearchResultsTableHead({columns:e.columns})),i.$resultsTableBody.html(i._templateSearchResultsTableBody({items:e.items})),i.$resultsPagination.html(i._templateSearchResultsPagination({paginationTemplate:e.paginationTemplate})),i.$advancedFields&&(i.$advancedFields.html(""),i.$advancedFields.length&&t.each(e.fields,function(e,t){i.$advancedFields.append(i._templateAdvancedSearchFieldRow({field:t}))})),i.setupResetButton(e),"multiple"==n.selectMode?i.$element.find("tbody tr").on("contextmenu",function(e){return e.preventDefault(),!1}).on("mouseover.concreteSearchResultItem",function(){i.hoverIsEnabled(t(this))&&t(this).addClass("ccm-search-select-hover")}).on("mouseout.concreteSearchResultItem",function(){i.hoverIsEnabled(t(this))&&t(this).removeClass("ccm-search-select-hover")}).on("mousedown.concreteSearchResultItem",function(e){i.handleSelectClick(e,t(this))}).on("mouseup.concreteSearchResultItem",function(e){e.metaKey||e.ctrlKey||e.shiftKey||i.$element.find(".ccm-search-select-selected").not(t(this)).removeClass()}).on("touchstart.concreteSearchResultItem",function(e){var n=t(this);o=setTimeout(function(){i.handleSelectClick(e,n),o=null},1e3)}).on("touchend.concreteSearchResultItem",function(e){o&&(clearTimeout(o),o=null)}):i.setupMenus(e),i.setupBulkActions(),n.onUpdateResults&&n.onUpdateResults(this)},i.prototype.hoverIsEnabled=function(e){return!0},i.prototype.setupAdvancedSearch=function(){var e=this;e.$advancedFields=e.$element.find("div.ccm-search-fields-advanced"),e.$element.on("click","a[data-search-toggle=advanced]",function(){return e.$advancedFields.append(e._templateAdvancedSearchFieldRow()),!1}),e.$element.on("change","select[data-search-field]",function(){var i=t(this).parent().find(".ccm-search-field-content");i.html("");var n=t(this).find(":selected").attr("data-search-field-url");n&&e.ajaxUpdate(n,!1,function(e){_.each(e.assets.css,function(e){ccm_addHeaderItem(e,"CSS")}),_.each(e.assets.javascript,function(e){ccm_addHeaderItem(e,"JAVASCRIPT")}),i.html(e.html)})}),e.$element.on("click","a[data-search-remove=search-field]",function(){var e=t(this).parent();return e.remove(),!1}),e.$advancedSearchButton.on("click",function(){var i=t(this).attr("href");return t.fn.dialog.open({width:620,height:500,href:i,modal:!0,title:ccmi18n.search,onOpen:function(){e.setupAdvancedSearchDialog()}}),!1})},i.prototype.setupAdvancedSearchDialog=function(){var e=this,i=t("div[data-container=search-fields]"),n=_.template(t("script[data-template=search-field-row]").html()),o=t("script[data-template=default-query]").html();o&&(o=JSON.parse(o)),t("button[data-button-action=add-field]").on("click",function(){i.append(n())}),e.result.query?t.each(e.result.query.fields,function(e,t){i.append(n({field:t}))}):o&&t.each(o.fields,function(e,t){i.append(n({field:t}))}),i.find("select.selectize-select").selectize({plugins:["remove_button"]}),i.on("change","select.ccm-search-choose-field",function(){var e=t(this).val(),i=t(this).parent().find("div.form-group");e&&t.concreteAjax({url:t(this).attr("data-action"),data:{field:e},success:function(e){_.each(e.assets.css,function(e){ccm_addHeaderItem(e,"CSS")}),_.each(e.assets.javascript,function(e){ccm_addHeaderItem(e,"JAVASCRIPT")}),i.html(e.element),i.find("select.selectize-select").selectize({plugins:["remove_button"]})}})}),i.on("click","a[data-search-remove=search-field]",function(e){e.preventDefault();var i=t(this).parent();i.remove()}),t("button[data-button-action=save-search-preset]").on("click.saveSearchPreset",function(){jQuery.fn.dialog.open({element:"div[data-dialog=save-search-preset]:first",modal:!0,width:320,title:"Save Preset",height:"auto"})});var s=t("form[data-form=save-preset]"),a=t("form[data-form=advanced-search]");t("button[data-button-action=save-search-preset-submit]").on("click.saveSearchPresetSubmit",function(){var e=t("form[data-form=save-preset]");e.trigger("submit")}),s.on("submit",function(){var e=a.serializeArray();return e=e.concat(s.serializeArray()),t.concreteAjax({data:e,url:s.attr("action"),success:function(e){jQuery.fn.dialog.closeAll(),ConcreteEvent.publish("SavedSearchCreated",{search:e})}}),!1}),e.setupSearch()},i.prototype.setupSort=function(){var e=this;this.$element.on("click","thead th > a",function(){return e.ajaxUpdate(t(this).attr("href")),!1})},i.prototype.refreshResults=function(){var e=this;e.$element.find("form[data-search-form]").trigger("submit")},i.prototype.setupSearch=function(){var e=this;if(e._templateSearchForm&&e.$element.find("[data-search-element=wrapper]").html(e._templateSearchForm()),e.$element.on("submit","form[data-search-form]",function(){var i=t(this).serializeArray();return i.push({name:"submitSearch",value:"1"}),e.ajaxUpdate(t(this).attr("action"),i),!1}),e.$element.find("div[data-header] form").on("submit",function(){var i=t(this).serializeArray();return i.push({name:"submitSearch",value:"1"}),e.ajaxUpdate(t(this).attr("action"),i),e.$advancedSearchButton.hide(),e.$resetSearchButton.addClass("ccm-header-reset-search-right").show(),!1}),e.options.appendToOuterDialog){var i=e.$element.closest("div.ui-dialog");i.length&&e.$element.find("div[data-header]").insertBefore(i.find(".ui-dialog-content"))}t("form[data-form=advanced-search]").concreteAjaxForm({success:function(t){e.updateResults(t),jQuery.fn.dialog.closeTop(),e.$advancedSearchButton.html(ccmi18n_filemanager.edit),e.$resetSearchButton.show(),e.$headerSearchInput.prop("disabled",!0).val(""),e.$headerSearchInput.attr("placeholder","")}}),e.$resetSearchButton.on("click",function(i){e.$element.find("div[data-header] input").val(""),i.preventDefault(),t.concreteAjax({url:t(this).attr("data-button-action-url"),success:function(t){e.updateResults(t),e.$headerSearchInput.prop("disabled",!1),e.$headerSearchInput.attr("placeholder",ccmi18n.search),e.$advancedSearchButton.html(ccmi18n.advanced).show(),e.$resetSearchButton.removeClass("ccm-header-reset-search-right").hide()}})})},i.prototype.handleSelectedBulkAction=function(e,i,n,o){var s=this,a=[];o instanceof jQuery?t.each(o,function(e,i){a.push({name:s.options.bulkParameterName+"[]",value:t(i).val()})}):t.each(o,function(e,t){a.push({name:s.options.bulkParameterName+"[]",value:t})}),"dialog"==i&&jQuery.fn.dialog.open({width:n.attr("data-bulk-action-dialog-width"),height:n.attr("data-bulk-action-dialog-height"),modal:!0,href:n.attr("data-bulk-action-url")+"?"+jQuery.param(a),title:n.attr("data-bulk-action-title")}),"ajax"==i&&t.concreteAjax({url:n.attr("data-bulk-action-url"),data:a,success:function(e){e.message&&ConcreteAlert.notify({message:e.message,title:e.title})}}),"progressive"==i&&ccm_triggerProgressiveOperation(n.attr("data-bulk-action-url"),a,n.attr("data-bulk-action-title"),function(){s.refreshResults()}),s.publish("SearchBulkActionSelect",{value:e,option:n,items:o})},i.prototype.publish=function(e,t){var i=this;ConcreteEvent.publish(e,t,i)},i.prototype.subscribe=function(e,t){var i=this;ConcreteEvent.subscribe(e,t,i)},i.prototype.setupBulkActions=function(){var e=this;e.$bulkActions=e.$element.find("select[data-bulk-action]"),e.$element.on("change","select[data-bulk-action]",function(){var i=t(this).find("option:selected"),n=i.val(),o=i.attr("data-bulk-action-type");e.handleSelectedBulkAction(n,o,i,e.$element.find("input[data-search-checkbox=individual]:checked")),e.$element.find("option").eq(0).prop("selected",!0)})},i.prototype.setupPagination=function(){var e=this;this.$element.on("click","ul.pagination a",function(){return e.ajaxUpdate(t(this).attr("href")),!1})},i.prototype.getResultMenu=function(e){var i=this;if(e.length>1&&i.options.result.bulkMenus){var n,o=i.options.result.bulkMenus.propertyName,s=i.options.result.bulkMenus.menu;if(t.each(e,function(e,t){var i=t[o];0==e?n=i:n!=i&&(n=null)}),n)return t(s)}else if(1==e.length){var s=e[0].treeNodeMenu;return t(s)}return!1},i.prototype.setupCheckboxes=function(){var e=this;e.$element.on("click","input[data-search-checkbox=select-all]",function(){e.$element.find("input[data-search-checkbox=individual]").prop("checked",t(this).is(":checked")).trigger("change")}),e.$element.on("change","input[data-search-checkbox=individual]",function(){e.$element.find("input[data-search-checkbox=individual]:checked").length?e.$bulkActions.prop("disabled",!1):e.$bulkActions.prop("disabled",!0)}),ConcreteEvent.subscribe("SearchSelectItems",function(t,i){var n=e.getResultMenu(i.results);n?e.$element.find("button.btn-menu-launcher").prop("disabled",!1):e.$element.find("button.btn-menu-launcher").prop("disabled",!0)},e.$element)},t.fn.concreteAjaxSearch=function(e){return new i(this,e)},e.ConcreteAjaxSearch=i}(this,$),ccm_triggerProgressiveOperation=function(e,t,i,n,o,s){$("#ccm-dialog-progress-bar").remove(),$.concreteAjax({loader:!1,url:e,type:"POST",data:t,dataType:"html",success:function(a){if(jQuery.fn.dialog.hideLoader(),s){s.html(a);var r=$("#ccm-progressive-operation-progress-bar").attr("data-total-items");ccm_doProgressiveOperation(e,t,r,n,o,s)}else $('<div id="ccm-dialog-progress-bar" />').appendTo(document.body).html(a).jqdialog({autoOpen:!1,height:200,width:400,modal:!0,title:i,closeOnEscape:!1,open:function(i,s){$(".ui-dialog-titlebar-close",this.parentNode).hide();var a=$("#ccm-progressive-operation-progress-bar").attr("data-total-items");ccm_doProgressiveOperation(e,t,a,n,o)}}),$("#ccm-dialog-progress-bar").jqdialog("open")}})},ccm_doProgressiveOperation=function(e,t,i,n,o,s){t.push({name:"process",value:"1"}),t.process=!0,$.ajax({url:e,dataType:"json",type:"POST",data:t,error:function(e,t,i){switch(t){case"timeout":var n=ccmi18n.requestTimeout;break;default:var n=e.responseText}s||($("#ccm-dialog-progress-bar").dialog("option","height",200),$("#ccm-dialog-progress-bar").dialog("option","closeOnEscape",!0),$(".ui-dialog-titlebar-close").show()),s?s.html('<div class="alert alert-error">'+n+"</div>"):$("#ccm-progressive-operation-progress-bar").html('<div class="alert alert-error">'+n+"</div>")},success:function(a){if(a.error){s||($("#ccm-dialog-progress-bar").dialog("option","height",200),$("#ccm-dialog-progress-bar").dialog("option","closeOnEscape",!0),$(".ui-dialog-titlebar-close").show());var r=a.message;$("#ccm-progressive-operation-progress-bar").html('<div class="alert alert-error">'+r+"</div>"),"function"==typeof o&&o(a)}else{var c=a.totalItems,l=Math.round((i-c)/i*100);$("#ccm-progressive-operation-status").html(1),i-c>0&&$("#ccm-progressive-operation-status").html(i-c),$("#ccm-progressive-operation-progress-bar div.progress-bar").width(l+"%"),c>0?setTimeout(function(){ccm_doProgressiveOperation(e,t,i,n,o)},250):setTimeout(function(){$("#ccm-progressive-operation-progress-bar div.bar").width("0%"),s||$("#ccm-dialog-progress-bar").dialog("close"),"function"==typeof n&&n(a)},1e3)}}})};var ccmCustomStyle={tabs:function(e,t){return $(".ccm-styleEditPane").hide(),$("#ccm-styleEditPane-"+t).show(),$(e.parentNode.parentNode).find("li").removeClass("ccm-nav-active"),$(e.parentNode).addClass("ccm-nav-active"),!1},resetAll:function(){return!!confirm(ccmi18n.confirmCssReset)&&(jQuery.fn.dialog.showLoader(),$("#ccm-reset-style").val(1),$("#ccmCustomCssForm").get(0).submit(),!0)},showPresetDeleteIcon:function(){$("select[name=cspID]").val()>0?$("#ccm-style-delete-preset").show():$("#ccm-style-delete-preset").hide()},deletePreset:function(){var e=$("select[name=cspID]").val();if(e>0){if(!confirm(ccmi18n.confirmCssPresetDelete))return!1;var t=$("#ccm-custom-style-refresh-action").val()+"&deleteCspID="+e+"&subtask=delete_custom_style_preset";jQuery.fn.dialog.showLoader(),$.get(t,function(e){$("#ccm-custom-style-wrapper").html(e),jQuery.fn.dialog.hideLoader()})}},initForm:function(){$("#cspFooterPreset").length>0&&$("#ccmCustomCssFormTabs input, #ccmCustomCssFormTabs select, #ccmCustomCssFormTabs textarea").bind("change click",function(){$("#cspFooterPreset").show(),$("#cspFooterNoPreset").remove(),$("#ccmCustomCssFormTabs input, #ccmCustomCssFormTabs select").unbind("change click")}),$("input[name=cspPresetAction]").click(function(){"create_new_preset"==$(this).val()&&$(this).prop("checked")?$("input[name=cspName]").attr("disabled",!1).focus():$("input[name=cspName]").val("").attr("disabled",!0)}),ccmCustomStyle.showPresetDeleteIcon(),ccmCustomStyle.lastPresetID=parseInt($("select[name=cspID]").val()),$("select[name=cspID]").change(function(){var e=parseInt($(this).val()),t=parseInt($("input[name=selectedCsrID]").val());if(ccmCustomStyle.lastPresetID==e)return!1;if(ccmCustomStyle.lastPresetID=e,jQuery.fn.dialog.showLoader(),e>0)var i=$("#ccm-custom-style-refresh-action").val()+"&cspID="+e;else var i=$("#ccm-custom-style-refresh-action").val()+"&csrID="+t;$.get(i,function(e){$("#ccm-custom-style-wrapper").html(e),jQuery.fn.dialog.hideLoader()})}),$("#ccmCustomCssForm").submit(function(){return 1==$("input[name=cspCreateNew]").prop("checked")&&""==$("input[name=cspName]").val()?($("input[name=cspName]").focus(),alert(ccmi18n.errorCustomStylePresetNoName),!1):(jQuery.fn.dialog.showLoader(),!0)}),parseInt(ccmCustomStyle.lastPresetID)||setTimeout('$("#ccmCustomCssFormTabs input").attr("disabled", false).get(0).focus()',500)},validIdCheck:function(e,t){var i=$("#"+e.value);i&&i.get(0)&&i.get(0).id!=t?$("#ccm-styles-invalid-id").css("display","block"):$("#ccm-styles-invalid-id").css("display","none")}};ccm_activateTabBar=function(e){$("#ccm-tab-content-"+e.find("li[class=active] a").attr("data-tab")).show(),e.find("a").unbind().click(function(){e.find("li").removeClass("active"),$(this).parent().addClass("active"),e.find("a").each(function(){$("#ccm-tab-content-"+$(this).attr("data-tab")).hide()});var t=$(this).attr("data-tab");return $("#ccm-tab-content-"+t).show(),!1})};var ConcreteToolbar=function(){var e,t,n=$("#ccm-toolbar"),o=$("#ccm-nav-intelligent-search"),s=$("#ccm-intelligent-search-results");return o.length&&s.css("right",$(window).width()-o.offset().left-s.width()-1),setupHelpNotifications=function(){$(".ccm-notification .dialog-launch").dialog(),$("a[data-help-notification-toggle]").concreteHelpLauncher(),$("a[data-help-launch-dialog=main]").on("click",function(e){e.preventDefault(),(new ConcreteHelpDialog).open()});var e=ConcreteHelpGuideManager.get();if(e.getGuideToLaunchOnRefresh()){var t=ConcreteHelpGuideManager.getGuide(e.getGuideToLaunchOnRefresh());t.start()}},setupPageAlerts=function(){$(document.body).on("click","a[data-dismiss-alert=page-alert]",function(e){return e.stopPropagation(),$(this).closest(".ccm-notification").queue(function(){$(this).addClass("animated fadeOut"),$(this).dequeue()}).delay(500).queue(function(){$(this).remove(),$(this).dequeue()}),!1}),$("form[data-form=workflow]").ajaxForm({dataType:"json",beforeSubmit:function(){jQuery.fn.dialog.showLoader()},success:function(e){e.redirect&&(window.location.href=e.redirect)}})},setupTooltips=function(){0==$("#ccm-tooltip-holder").length&&$("<div />").attr("id","ccm-tooltip-holder").attr("class","ccm-ui").prependTo(document.body),$(".launch-tooltip").tooltip({container:"#ccm-tooltip-holder"})},setupPanels=function(){$("<div />",{id:"ccm-panel-overlay"}).appendTo($(document.body)),$("[data-launch-panel]").each(function(){$(this).prepend('<span class="spinner"><div class="double-bounce1"></div><div class="double-bounce2"></div></span>')}),$("[data-launch-panel]").unbind().on("click",function(){var e=$(this),t=e.attr("data-launch-panel"),i=ConcretePanelManager.getByIdentifier(t);if(i.willBePinned()||e.toggleClass("ccm-launch-panel-loading"),i.isPinable()){var n=$(e.parent());(i.willBePinned()||i.pinned())&&n.toggleClass("ccm-toolbar-page-edit-mode-pinned "),i.willBePinned()?(e.attr("data-original-icon-class",e.find("i").attr("class")),e.find("i").removeClass().addClass("fa fa-lock")):e.attr("data-original-icon-class")&&(e.find("i").removeClass().addClass(e.attr("data-original-icon-class")),e.removeAttr("data-original-icon-class"))}return i.toggle(),!1}),$("html").addClass("ccm-panel-ready"),ConcreteEvent.subscribe("PanelOpen",function(e,t){var i=t.panel;"page"==i.options.identifier&&$("#"+i.getDOMID()).find("[data-launch-panel-detail='page-composer']").click(),$("a[data-toolbar-action=check-in]").on("click.close-check-in",function(){return ConcretePanelManager.exitPanelMode(),!1})}),ConcreteEvent.subscribe("PanelClose",function(e){$("a[data-toolbar-action=check-in]").unbind("click.close-check-in")})},setupIntelligentSearch=function(){o.bind("keydown.ccm-intelligent-search",function(e){if(13==e.keyCode||40==e.keyCode||38==e.keyCode){if(e.preventDefault(),e.stopPropagation(),13==e.keyCode&&$("a.ccm-intelligent-search-result-selected").length>0){var t=$("a.ccm-intelligent-search-result-selected").attr("href");t&&"#"!=t&&"javascript:void(0)"!=t?window.location.href=t:$("a.ccm-intelligent-search-result-selected").click()}var i,n=$("#ccm-intelligent-search-results li:visible");40!=e.keyCode&&38!=e.keyCode||($.each(n,function(t,o){$(o).children("a").hasClass("ccm-intelligent-search-result-selected")&&(38==e.keyCode?io=n[t-1]:io=n[t+1],i=$(io).find("a"))}),i&&i.length>0&&($("a.ccm-intelligent-search-result-selected").removeClass(),
$(i).addClass("ccm-intelligent-search-result-selected")))}}),o.liveUpdate("ccm-intelligent-search-results","intelligent-search"),o.bind("keyup.ccm-intelligent-search",function(e){doRemoteSearchCall($(this).val())}),o.bind("click",function(e){""==this.value&&s.hide()})},setupMobileNav=function(){$(".ccm-toolbar-mobile-menu-button").click(function(){$(this).toggleClass("ccm-mobile-close"),$(".ccm-mobile-menu-overlay").slideToggle()}),$(".ccm-mobile-menu-overlay .parent-ul a").click(function(e){$(this).parent("li").hasClass("last-li")||($(this).parent("li").siblings().children("ul").hide(),$(this).parent("li").children("ul").is(":visible")||($(this).next("ul").show(),e.preventDefault()))})},activateIntelligentSearchResults=function(){0==$("#ccm-intelligent-search-results div:visible").length&&$("#ccm-intelligent-search-results").hide(),$("#ccm-intelligent-search-results a").hover(function(){$("a.ccm-intelligent-search-result-selected").removeClass(),$(this).addClass("ccm-intelligent-search-result-selected")},function(){$(this).removeClass("ccm-intelligent-search-result-selected")})},doRemoteSearchCall=function(n){if(n=jQuery.trim(n),n&&n.length>2){if(n==e)return;t&&window.clearTimeout(t),e=n,t=window.setTimeout(function(){t=null,$("#ccm-intelligent-search-results-list-marketplace").parent().show(),$("#ccm-intelligent-search-results-list-help").parent().show(),$("#ccm-intelligent-search-results-list-your-site").parent().show(),$("#ccm-intelligent-search-results-list-marketplace").parent().removeClass("ccm-intelligent-search-results-module-loaded"),$("#ccm-intelligent-search-results-list-help").parent().removeClass("ccm-intelligent-search-results-module-loaded"),$("#ccm-intelligent-search-results-list-your-site").parent().removeClass("ccm-intelligent-search-results-module-loaded"),$.getJSON(CCM_DISPATCHER_FILENAME+"/ccm/system/marketplace/search",{q:e},function(e){for($("#ccm-intelligent-search-results-list-marketplace").parent().addClass("ccm-intelligent-search-results-module-loaded"),$("#ccm-intelligent-search-results-list-marketplace").html(""),i=0;i<e.length;i++){var t=e[i],n="ConcreteMarketplace.getMoreInformation("+t.mpID+")";$("#ccm-intelligent-search-results-list-marketplace").append('<li><a href="javascript:void(0)" onclick="'+n+'"><img src="'+t.img+'" />'+t.name+"</a></li>")}0==e.length&&$("#ccm-intelligent-search-results-list-marketplace").parent().hide(),0==$(".ccm-intelligent-search-result-selected").length&&($("#ccm-intelligent-search-results").find("li a").removeClass("ccm-intelligent-search-result-selected"),$("#ccm-intelligent-search-results li:visible a:first").addClass("ccm-intelligent-search-result-selected")),activateIntelligentSearchResults()}).error(function(){$("#ccm-intelligent-search-results-list-marketplace").parent().hide()}),$.getJSON(CCM_DISPATCHER_FILENAME+"/ccm/system/backend/get_remote_help",{q:e},function(e){for($("#ccm-intelligent-search-results-list-help").parent().addClass("ccm-intelligent-search-results-module-loaded"),$("#ccm-intelligent-search-results-list-help").html(""),i=0;i<e.length;i++){var t=e[i];$("#ccm-intelligent-search-results-list-help").append('<li><a href="'+t.href+'">'+t.name+"</a></li>")}0==e.length&&$("#ccm-intelligent-search-results-list-help").parent().hide(),0==$(".ccm-intelligent-search-result-selected").length&&($("#ccm-intelligent-search-results").find("li a").removeClass("ccm-intelligent-search-result-selected"),$("#ccm-intelligent-search-results li:visible a:first").addClass("ccm-intelligent-search-result-selected")),activateIntelligentSearchResults()}).error(function(){$("#ccm-intelligent-search-results-list-help").parent().hide()}),$.getJSON(CCM_DISPATCHER_FILENAME+"/ccm/system/backend/intelligent_search",{q:e},function(e){for($("#ccm-intelligent-search-results-list-your-site").parent().addClass("ccm-intelligent-search-results-module-loaded"),$("#ccm-intelligent-search-results-list-your-site").html(""),i=0;i<e.length;i++){var t=e[i];$("#ccm-intelligent-search-results-list-your-site").append('<li><a href="'+t.href+'">'+t.name+"</a></li>")}0==e.length&&$("#ccm-intelligent-search-results-list-your-site").parent().hide(),0==$(".ccm-intelligent-search-result-selected").length&&($("#ccm-intelligent-search-results").find("li a").removeClass("ccm-intelligent-search-result-selected"),$("#ccm-intelligent-search-results li:visible a:first").addClass("ccm-intelligent-search-result-selected")),activateIntelligentSearchResults()}).error(function(){$("#ccm-intelligent-search-results-list-your-site").parent().hide()})},500)}},{start:function(){n.length>0&&(n.find(".dialog-launch").dialog(),setupIntelligentSearch(),setupPanels(),setupTooltips(),setupPageAlerts(),setupHelpNotifications(),setupMobileNav())},disable:function(){$("#ccm-toolbar-disabled").remove(),$("<div />",{id:"ccm-toolbar-disabled"}).appendTo(document.body),setTimeout(function(){$("#ccm-toolbar-disabled").css("opacity",1)},10)},enable:function(){$("#ccm-toolbar-disabled").remove()},disableDirectExit:function(){var e=$("li.ccm-toolbar-page-edit a");"check-in"!=e.attr("data-launch-panel")&&"check-in"!=e.attr("data-disable-panel")&&e.attr("data-launch-panel","check-in").on("click",function(){$(this).toggleClass("ccm-launch-panel-active");var e=ConcretePanelManager.getByIdentifier("check-in");return e.toggle(),!1})}}}();!function(e,t,i){"use strict";i.expr[":"].icontains=i.expr.createPseudo(function(e){return function(t){return i(t).text().toUpperCase().indexOf(e.toUpperCase())>=0}});var n=function(){var e=function(e){var t=e.data("options"),n=i(t.templateButtonText);return e.data("$buttonText",n),n},t=function(e){var t=e.data("options"),n=i(t.templateButtonIcon);return e.data("$buttonIcon",n),n},n=function(e){var t=e.data("options"),n=i(t.templateButton);return n.addClass(t.classButtonStyle),e.data("$button",n),n},o=function(e){var t=e.data("options"),n=i(t.templateButtonGroup);return n.data("$select",e),n},s=function(e){var t=e.data("options");return i(t.templateMenu)},a=function(e,t){var n=this.data("options"),o=i(n.templateMenuItem),s=i(n.templateMenuItemLink);return s.text(i(t).text()),i(t).prop("disabled")&&(o.addClass("disabled"),s.prop("tabIndex",-1)),o.append(s)},r=function(e){var t=i.proxy(a,e);return e.find("option").map(t).toArray()},c=function(e,t){var n=e.data("options");return t>n.minItemsForSearch?i(n.templateSearchForm):i()},l=function(e,t){var n=e.data("options"),o=e.attr("id"),s=n.labelPrefix+e.attr("id"),a=i('label[for="'+o+'"]');a.attr("for",s),t.attr("id",s)},d=function(e){var t=e.data("$buttonText");t.text(e.find(":selected").text())},p=function(e){var t=e.data("$button");t.prop("disabled",e.prop("disabled"))},u=function(e){var t=e.data("$button");t.focus()},h=function(e){var t=i(e.delegateTarget);d(t),p(t),u(t)},f=function(e){e.preventDefault();var t=i(e.delegateTarget),n=i(e.currentTarget),o=t.data("$select"),s=t.find("li").index(n),a=o.find("option").eq(s);a.prop("disabled")||a.prop("selected",!0).change()},m=function(e){var t=i(this),n=t.find(".dropdown input");if(n.length)n.focus();else{var o=t.data("$select").find(":selected").index();t.find("li:eq("+o+") a").focus()}},g=function(e){var t=i(this).find("li").hide(),n=t.filter(":icontains("+i(e.target).val()+")").show(),o=i(this).find(".help-block");n.length?o.hide():o.show()},v=function(){var a=i(this),u=t(a),v=e(a),y=n(a);y.append(v),y.append(u);var b=o(a),C=r(a),k=c(a,C.length),w=s(a);k.length&&C.unshift(k),w.append(C),b.append(y),b.append(w),l(a,y),b.insertAfter(a),d(a),p(a),a.on("change",h),b.on("click","li",f),b.on("shown.bs.dropdown",m),b.on(".dropdown input",g)};return{transformSelect:v}}();i.fn.bootstrapSelectToButton=function(e){return e=i.extend({},i.fn.bootstrapSelectToButton.defaults,e),this.each(function(){i(this).data("options",e),this.style.display="none",n.transformSelect.call(this)})},i.fn.bootstrapSelectToButton.defaults={templateButton:'<button type="button" class="btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>',templateButtonIcon:'<span class="caret"></span>',templateButtonText:"<span>{text}</span>",templateButtonGroup:'<div class="btn-group"></div>',templateMenu:'<ul class="dropdown-menu"></ul>',templateMenuItem:"<li></li>",templateMenuItemLink:'<a href="#"></a>',templateSearchForm:'<div class="dropdown"><form><input class="form-control" placeholder="Search"><span class="help-block" style="display:none">No results found</span></form></div>',classButtonStyle:"btn-default",minItemsForSearch:1/0,labelPrefix:"bstb-"}}(this,this.document,this.jQuery),function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.NProgress=t()}(this,function(){function e(e,t,i){return e<t?t:e>i?i:e}function t(e){return 100*(-1+e)}function i(e,i,n){var o;return o="translate3d"===l.positionUsing?{transform:"translate3d("+t(e)+"%,0,0)"}:"translate"===l.positionUsing?{transform:"translate("+t(e)+"%,0)"}:{"margin-left":t(e)+"%"},o.transition="all "+i+"ms "+n,o}function n(e,t){var i="string"==typeof e?e:a(e);return i.indexOf(" "+t+" ")>=0}function o(e,t){var i=a(e),o=i+t;n(i,t)||(e.className=o.substring(1))}function s(e,t){var i,o=a(e);n(e,t)&&(i=o.replace(" "+t+" "," "),e.className=i.substring(1,i.length-1))}function a(e){return(" "+(e&&e.className||"")+" ").replace(/\s+/gi," ")}function r(e){e&&e.parentNode&&e.parentNode.removeChild(e)}var c={};c.version="0.2.0";var l=c.settings={minimum:.08,easing:"linear",positionUsing:"",speed:350,trickle:!0,trickleSpeed:250,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};c.configure=function(e){var t,i;for(t in e)i=e[t],void 0!==i&&e.hasOwnProperty(t)&&(l[t]=i);return this},c.status=null,c.set=function(t){var n=c.isStarted();t=e(t,l.minimum,1),c.status=1===t?null:t;var o=c.render(!n),s=o.querySelector(l.barSelector),a=l.speed,r=l.easing;return o.offsetWidth,d(function(e){""===l.positionUsing&&(l.positionUsing=c.getPositioningCSS()),p(s,i(t,a,r)),1===t?(p(o,{transition:"none",opacity:1}),o.offsetWidth,setTimeout(function(){p(o,{transition:"all "+a+"ms linear",opacity:0}),setTimeout(function(){c.remove(),e()},a)},a)):setTimeout(e,a)}),this},c.isStarted=function(){return"number"==typeof c.status},c.start=function(){c.status||c.set(0);var e=function(){setTimeout(function(){c.status&&(c.trickle(),e())},l.trickleSpeed)};return l.trickle&&e(),this},c.done=function(e){return e||c.status?c.inc(.3+.5*Math.random()).set(1):this},c.inc=function(t){var i=c.status;return i?i>1?void 0:("number"!=typeof t&&(t=i>=0&&i<.25?(3*Math.random()+3)/100:i>=.25&&i<.65?3*Math.random()/100:i>=.65&&i<.9?2*Math.random()/100:i>=.9&&i<.99?.005:0),i=e(i+t,0,.994),c.set(i)):c.start()},c.trickle=function(){return c.inc()},function(){var e=0,t=0;c.promise=function(i){return i&&"resolved"!==i.state()?(0===t&&c.start(),e++,t++,i.always(function(){t--,0===t?(e=0,c.done()):c.set((e-t)/e)}),this):this}}(),c.render=function(e){if(c.isRendered())return document.getElementById("nprogress");o(document.documentElement,"nprogress-busy");var i=document.createElement("div");i.id="nprogress",i.innerHTML=l.template;var n,s=i.querySelector(l.barSelector),a=e?"-100":t(c.status||0),d=document.querySelector(l.parent);return p(s,{transition:"all 0 linear",transform:"translate3d("+a+"%,0,0)"}),l.showSpinner||(n=i.querySelector(l.spinnerSelector),n&&r(n)),d!=document.body&&o(d,"nprogress-custom-parent"),d.appendChild(i),i},c.remove=function(){s(document.documentElement,"nprogress-busy"),s(document.querySelector(l.parent),"nprogress-custom-parent");var e=document.getElementById("nprogress");e&&r(e)},c.isRendered=function(){return!!document.getElementById("nprogress")},c.getPositioningCSS=function(){var e=document.body.style,t="WebkitTransform"in e?"Webkit":"MozTransform"in e?"Moz":"msTransform"in e?"ms":"OTransform"in e?"O":"";return t+"Perspective"in e?"translate3d":t+"Transform"in e?"translate":"margin"};var d=function(){function e(){var i=t.shift();i&&i(e)}var t=[];return function(i){t.push(i),1==t.length&&e()}}(),p=function(){function e(e){return e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(e,t){return t.toUpperCase()})}function t(e){var t=document.body.style;if(e in t)return e;for(var i,n=o.length,s=e.charAt(0).toUpperCase()+e.slice(1);n--;)if(i=o[n]+s,i in t)return i;return e}function i(i){return i=e(i),s[i]||(s[i]=t(i))}function n(e,t,n){t=i(t),e.style[t]=n}var o=["Webkit","O","Moz","ms"],s={};return function(e,t){var i,o,s=arguments;if(2==s.length)for(i in t)o=t[i],void 0!==o&&t.hasOwnProperty(i)&&n(e,i,o);else n(e,s[1],s[2])}}();return c}),function(){var e,t,i,n,o={}.hasOwnProperty,s=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},a=function(e,t){return function(){return e.apply(t,arguments)}};window.Tourist=window.Tourist||{},Tourist.Model=function(t){function i(){return e=i.__super__.constructor.apply(this,arguments)}return s(i,t),i.prototype._module="Tourist",i}(Backbone.Model),window.Tourist.Tip=window.Tourist.Tip||{},Tourist.Tip.Base=function(){function e(e){this.options=null!=e?e:{},this.onClickNext=a(this.onClickNext,this),this.onClickClose=a(this.onClickClose,this),this.el=$("<div/>"),this.initialize(e),this._bindClickEvents(),Tourist.Tip.Base._cacheTip(this)}return e.prototype._module="Tourist",_.extend(e.prototype,Backbone.Events),e.prototype.skipButtonTemplate=ccmi18n_tourist.skipButton,e.prototype.nextButtonTemplate=ccmi18n_tourist.nextButton,e.prototype.finalButtonTemplate=ccmi18n_tourist.finalButton,e.prototype.closeButtonTemplate=ccmi18n_tourist.closeButton,e.prototype.okButtonTemplate=ccmi18n_tourist.okButton,e.prototype.actionLabelTemplate=_.template('<h4 class="action-label"><%= label %></h4>'),e.prototype.actionLabels=[ccmi18n_tourist.doThis,ccmi18n_tourist.thenThis,ccmi18n_tourist.nextThis],e.prototype.highlightClass="tour-highlight",e.prototype.template=_.template('<div>\n  <div class="tour-container">\n    <%= close_button %>\n    <%= content %>\n    <p class="tour-counter <%= counter_class %>"><%= counter%></p>\n  </div>\n  <div class="tour-buttons">\n    <%= buttons %>\n  </div>\n</div>'),e.prototype.destroy=function(){return this.el.remove()},e.prototype.render=function(e){return this.hide(),e&&(this._setTarget(e.target||!1,e),this._setZIndex(""),this._renderContent(e,this._buildContentElement(e)),e.target&&this.show(),e.zIndex&&this._setZIndex(e.zIndex,e)),this},e.prototype.show=function(){},e.prototype.hide=function(){},e.prototype.setTarget=function(e,t){return this._setTarget(e,t)},e.prototype.cleanupCurrentTarget=function(){return this.target&&this.target.removeClass&&this.target.removeClass(this.highlightClass),this.target=null},e.prototype.onClickClose=function(e){return this.trigger("click:close",this,e),!1},e.prototype.onClickNext=function(e){return this.trigger("click:next",this,e),!1},e.prototype._getTipElement=function(){},e.prototype._renderContent=function(e,t){},e.prototype._bindClickEvents=function(){var e;return e=this._getTipElement(),e.delegate(".tour-close","click",this.onClickClose),e.delegate(".tour-next","click",this.onClickNext)},e.prototype._setTarget=function(e,t){return this.cleanupCurrentTarget(),e&&t&&t.highlightTarget&&e.addClass(this.highlightClass),this.target=e},e.prototype._setZIndex=function(e){var t;return t=this._getTipElement(),t.css("z-index",e||"")},e.prototype._buildContentElement=function(e){var t,i;return t=this._buildButtons(e),i=$($.parseHTML(this.template({content:e.content,buttons:t,close_button:this._buildCloseButton(e),counter:e["final"]?"":ccmi18n_tourist.stepXofY.replace(/%1\$d/g,e.index+1).replace(/%2\$d/g,e.total),counter_class:e["final"]?"final":""}))),t||i.find(".tour-buttons").addClass("no-buttons"),this._renderActionLabels(i),i},e.prototype._buildButtons=function(e){var t;return t="",e.okButton&&(t+=this.okButtonTemplate),e.skipButton&&(t+=this.skipButtonTemplate),e.nextButton&&(t+=e["final"]?this.finalButtonTemplate:this.nextButtonTemplate),t},e.prototype._buildCloseButton=function(e){return e.closeButton?this.closeButtonTemplate:""},e.prototype._renderActionLabels=function(e){var t,i,n,o,s,a,r;for(n=e.find(".action"),i=0,r=[],s=0,a=n.length;s<a;s++)t=n[s],o=$($.parseHTML(this.actionLabelTemplate({label:this.actionLabels[i]}))),o.insertBefore(t),r.push(i++);return r},e._cacheTip=function(e){return Tourist.Tip.Base._cachedTips||(Tourist.Tip.Base._cachedTips=[]),Tourist.Tip.Base._cachedTips.push(e)},e.destroy=function(){var e,t,i,n;if(Tourist.Tip.Base._cachedTips){for(n=Tourist.Tip.Base._cachedTips,t=0,i=n.length;t<i;t++)e=n[t],e.destroy();return Tourist.Tip.Base._cachedTips=null}},e}(),Tourist.Tip.Bootstrap=function(e){function i(){return t=i.__super__.constructor.apply(this,arguments)}return s(i,e),i.prototype.initialize=function(e){var t;return t={showEffect:null,hideEffect:null},this.options=_.extend(t,e),this.tip=new Tourist.Tip.BootstrapTip(this.options)},i.prototype.destroy=function(){return this.tip.destroy(),i.__super__.destroy.call(this)},i.prototype.show=function(){var e;return this.options.showEffect?(e=Tourist.Tip.Bootstrap.effects[this.options.showEffect],e.call(this,this.tip,this.tip.el)):this.tip.show()},i.prototype.hide=function(){var e;return this.options.hideEffect?(e=Tourist.Tip.Bootstrap.effects[this.options.hideEffect],e.call(this,this.tip,this.tip.el)):this.tip.hide()},i.prototype._getTipElement=function(){return this.tip.el},i.prototype._setTarget=function(e,t){return i.__super__._setTarget.call(this,e,t),this.tip.setTarget(e)},i.prototype._renderContent=function(e,t){var i,n;return n=e.my||"left center",i=e.at||"right center",this.tip.setContainer(e.container||$("#ccm-tooltip-holder")),this.tip.setContent(t),this.tip.setPosition(e.target||!1,n,i)},i}(Tourist.Tip.Base),Tourist.Tip.Bootstrap.effects={slidein:function(e,t){var i,n,o,s,a,r,c,l,d;for(i={top:80,left:80,right:-80,bottom:-80},r=e.my.split(" ")[0],r=r||"top",a=i[r],"bottom"===r&&(r="top"),"right"===r&&(r="left"),c=parseInt(t.css(r)),t.stop(),n={},n[r]=c+a,t.css(n),t.show(),n[r]=c,s=["easeOutCubic","swing","linear"],l=0,d=s.length;l<d&&(o=s[l],!$.easing[o]);l++);return t.animate(n,300,o),null}},Tourist.Tip.BootstrapTip=function(){function e(e){var t;t={offset:10,tipOffset:10},this.options=_.extend(t,e),this.el=$($.parseHTML(this.template)),this.hide()}return e.prototype.template='<div class="popover tourist-popover">\n  <div class="arrow"></div>\n  <div class="popover-content"></div>\n</div>',e.prototype.FLIP_POSITION={bottom:"top",top:"bottom",left:"right",right:"left"},e.prototype.destroy=function(){return this.el.remove()},e.prototype.show=function(){return this.el.show().addClass("visible")},e.prototype.hide=function(){return this.el.hide().removeClass("visible")},e.prototype.setTarget=function(e){return this.target=e,this._setPosition(this.target,this.my,this.at)},e.prototype.setPosition=function(e,t,i){return this.target=e,this.my=t,this.at=i,this._setPosition(this.target,this.my,this.at)},e.prototype.setContainer=function(e){return e.append(this.el)},e.prototype.setContent=function(e){return this._getContentElement().html(e)},e.prototype._getContentElement=function(){return this.el.find(".popover-content")},e.prototype._getTipElement=function(){return this.el.find(".arrow")},e.prototype._setPosition=function(e,t,i){var n,o,s,a,r,c,l,d,p,u;if(null==t&&(t="left center"),null==i&&(i="right center"),e&&(u=t.split(" "),n=u[0],r=u[1],s=this.el.css("display"),this.el.css({top:0,left:0,margin:0,display:"block"}).removeClass("top").removeClass("bottom").removeClass("left").removeClass("right").addClass(this.FLIP_POSITION[n]),e))return l=this._getTipElement().css({left:"",right:"",top:"",bottom:""}),"center"!==r&&(d={left:l[0].offsetWidth/2,right:0,top:l[0].offsetHeight/2,bottom:0},o={},o[r]=d[r]+this.options.tipOffset,o[this.FLIP_POSITION[r]]="auto",l.css(o)),c=this._caculateTargetPosition(i,e),p=this._caculateTipPosition(t,c),a=this._adjustForArrow(t,p),this.el.css(a),this.el.css({display:s})},e.prototype._caculateTargetPosition=function(e,t){var i,n;return"[object Array]"===Object.prototype.toString.call(t)?{left:t[0],top:t[1]}:(i=this._getTargetBounds(t),n=this._lookupPosition(e,i.width,i.height),{left:i.left+n[0],top:i.top+n[1]})},e.prototype._caculateTipPosition=function(e,t){var i,n,o;return o=this.el[0].offsetWidth,i=this.el[0].offsetHeight,n=this._lookupPosition(e,o,i),{left:t.left-n[0],top:t.top-n[1]}},e.prototype._adjustForArrow=function(e,t){var i,n,o,s,a,r,c;switch(c=e.split(" "),i=c[0],s=c[1],a=this._getTipElement(),r=a[0].offsetWidth,n=a[0].offsetHeight,o={top:t.top,left:t.left},i){case"top":o.top+=n+this.options.offset;break;case"bottom":o.top-=n+this.options.offset;break;case"left":o.left+=r+this.options.offset;break;case"right":o.left-=r+this.options.offset}switch(s){case"left":o.left-=r/2+this.options.tipOffset;break;case"right":o.left+=r/2+this.options.tipOffset;break;case"top":o.top-=n/2+this.options.tipOffset;break;case"bottom":o.top+=n/2+this.options.tipOffset}return o},e.prototype._lookupPosition=function(e,t,i){var n,o,s;return s=t/2,n=i/2,o={"top left":[0,0],"left top":[0,0],"top right":[t,0],"right top":[t,0],"bottom left":[0,i],"left bottom":[0,i],"bottom right":[t,i],"right bottom":[t,i],"top center":[s,0],"left center":[0,n],"right center":[t,n],"bottom center":[s,i]},o[e]},e.prototype._getTargetBounds=function(e){var t,i;return t=e[0],i="function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},$.extend({},i,e.offset())},e}(),Tourist.Tip.QTip=function(e){function t(){return this._renderTipBackground=a(this._renderTipBackground,this),i=t.__super__.constructor.apply(this,arguments)}var n,o,r,c;return s(t,e),c=6,r=14,n=10,o={top:80,left:80,right:-80,bottom:-80},t.prototype.QTIP_DEFAULTS={content:{text:" "},show:{ready:!1,delay:0,effect:function(e){var t,i,n,s,a;return i=$(this),s=e.options.position.my,s&&(s=s[s.precedance]),s=s||"top",n=o[s],"bottom"===s&&(s="top"),"right"===s&&(s="left"),a=parseInt(i.css(s)),t={},t[s]=a+n,i.css(t),i.show(),t[s]=a,i.animate(t,300,"easeOutCubic"),null},autofocus:!1},hide:{event:null,delay:0,effect:!1},position:{adjust:{method:"shift shift",scroll:!1}},style:{classes:"ui-tour-tip",tip:{height:c,width:r}},events:{},zindex:2e3},t.prototype.initialize=function(e){return e=$.extend(!0,{},this.QTIP_DEFAULTS,e),this.el.qtip(e),this.qtip=this.el.qtip("api"),this.qtip.render()},t.prototype.destroy=function(){return this.qtip&&this.qtip.destroy(),t.__super__.destroy.call(this)},t.prototype.show=function(){return this.qtip.show()},t.prototype.hide=function(){return this.qtip.hide()},t.prototype._getTipElement=function(){return $("#qtip-"+this.qtip.id)},t.prototype._setTarget=function(e,i){return t.__super__._setTarget.call(this,e,i),this.qtip.set("position.target",e||!1)},t.prototype._renderContent=function(e,t){var i,n,o=this;return n=e.my||"left center",i=e.at||"right center",this._adjustPlacement(n,i),this.qtip.set("content.text",t),this.qtip.set("position.container",e.container||$("body")),this.qtip.set("position.my",n),this.qtip.set("position.at",i),this.qtip.set("position.viewport",e.viewport||!1),this.qtip.set("position.target",e.target||!1),setTimeout(function(){return o._renderTipBackground(n.split(" ")[0])},10)},t.prototype._adjustPlacement=function(e,t){return 0===e.indexOf("top")?this._adjust(0,n):0===e.indexOf("bottom")?this._adjust(0,-n):0===e.indexOf("right")?this._adjust(-n,0):this._adjust(n,0)},t.prototype._adjust=function(e,t){return this.qtip.set("position.adjust.x",e),this.qtip.set("position.adjust.y",t)},t.prototype._renderTipBackground=function(e){var t,i;return i=$("#qtip-"+this.qtip.id+" .qtip-tip"),t=i.find(".qtip-tip-bg"),t.length||(t=$("<div/>",{"class":"icon icon-tip qtip-tip-bg"}),i.append(t)),t.removeClass("top left right bottom"),t.addClass(e)},t}(Tourist.Tip.Base),Tourist.Tip.Simple=function(e){function t(){return n=t.__super__.constructor.apply(this,arguments)}return s(t,e),t.prototype.initialize=function(e){return $("body").append(this.el)},t.prototype.show=function(){return this.el.show()},t.prototype.hide=function(){return this.el.hide()},t.prototype._getTipElement=function(){return this.el},t.prototype._renderContent=function(e,t){return this.el.html(t)},t}(Tourist.Tip.Base),Tourist.Tour=function(){function e(e){var t,i;this.options=null!=e?e:{},this.onChangeCurrentStep=a(this.onChangeCurrentStep,this),this.next=a(this.next,this),t={tipClass:"Bootstrap"},this.options=_.extend(t,this.options),this.model=new Tourist.Model({current_step:null}),i=_.extend({model:this.model},this.options.tipOptions),this.view=new Tourist.Tip[this.options.tipClass](i),this.view.bind("click:close",_.bind(this.stop,this,!0)),this.view.bind("click:next",this.next),this.model.bind("change:current_step",this.onChangeCurrentStep)}return _.extend(e.prototype,Backbone.Events),e.prototype.start=function(){return this.trigger("start",this),this.next()},e.prototype.stop=function(e){return e?this._showCancelFinalStep():this._stop()},e.prototype.showStep=function(e){var t,i;return t=this._teardownCurrentStep(),t&&(i=e),i<this.options.steps.length&&!isNaN(parseInt(i,10))&&i>=0?this._showStep(this.options.steps[i],i):i===this.options.steps.length?this._showSuccessFinalStep():this._stop()},e.prototype.next=function(){var e,t;return e=this._teardownCurrentStep(),t=0,e&&(t=e.index+1),t<this.options.steps.length?this._showStep(this.options.steps[t],t):t===this.options.steps.length?this._showSuccessFinalStep():this._stop()},e.prototype.setStepOptions=function(e){return this.options.stepOptions=e},e.prototype.onChangeCurrentStep=function(e,t){return this.view.render(t)},e.prototype._showCancelFinalStep=function(){return this._showFinalStep(!1)},e.prototype._showSuccessFinalStep=function(){return this._showFinalStep(!0)},e.prototype._teardownCurrentStep=function(){var e;return e=this.model.get("current_step"),this._teardownStep(e),e},e.prototype._stop=function(){return this._teardownCurrentStep(),this.model.set({current_step:null}),this.trigger("stop",this)},e.prototype._showFinalStep=function(e){var t,i;return t=this._teardownCurrentStep(),i=e?this.options.successStep:this.options.cancelStep,_.isFunction(i)&&(i.call(this,this,this.options.stepOptions),i=null),i?t&&t["final"]?this._stop():(i["final"]=!0,this._showStep(i,this.options.steps.length)):this._stop()},e.prototype._showStep=function(e,t){if(e)return e=_.clone(e),e.index=t,e.total=this.options.steps.length,e["final"]||(e["final"]=this.options.steps.length===t+1&&!this.options.successStep),e=_.extend(e,this._setupStep(e)),this.model.set({current_step:e})},e.prototype._setupStep=function(e){var t,i,n,o;if(!e||!e.setup)return{};if(e.bind)for(o=e.bind,i=0,n=o.length;i<n;i++)t=o[i],e[t]=_.bind(e[t],e,this,this.options.stepOptions);return e.setup.call(e,this,this.options.stepOptions)||{}},e.prototype._teardownStep=function(e){return e&&e.teardown&&e.teardown.call(e,this,this.options.stepOptions),this.view.cleanupCurrentTarget()},e}()}.call(this),!function(e,t){"use strict";function i(e){var i=this;e=e||{},e=t.extend({width:800,height:400,title:"Help",dialogClass:"ccm-dialog-slim ccm-dialog-help-wrapper"},e),i.options=e}i.prototype={open:function(){var e=this;t("#ccm-dialog-help").length?e.options.element="#ccm-dialog-help":e.options.href=CCM_DISPATCHER_FILENAME+"/ccm/system/dialogs/help/introduction",t.fn.dialog.open(e.options)}},e.ConcreteHelpDialog=i}(this,$),!function(e,t,i){"use strict";function n(e,i){var o=this;i=i||{},i=t.extend({},i),o.$element=e,o.options=i;var s=o.options.element?o.options.element:t("div[data-help-notification='"+o.$element.attr("data-help-notification-toggle")+"']");s.find("a[data-launch-guide]").on("click.concreteHelp",function(e){e.preventDefault();var i=ConcreteHelpGuideManager.getGuide(t(this).attr("data-launch-guide"));i.start()}),o.$element.on("click",function(e){e.preventDefault(),t(this).addClass("animated fadeOut"),s.addClass("animated fadeIn").show(),s.on("click","a[data-dismiss=help-single]",function(e){e.preventDefault(),n.close(s)})})}n.close=function(e){if(e||(e=t("div[data-help-notification]")),!e||!e.is(":visible"))return!1;var i=t("[data-help-notification-toggle='"+e.attr("data-help-notification")+"']");e.addClass("animated fadeOut"),i.removeClass("fadeOut").addClass("fadeIn"),e.clearQueue().delay(250).queue(function(){t(this).hide(),t(this).removeClass("animated fadeOut"),t(this).dequeue()})},t.fn.concreteHelpLauncher=function(e){return t.each(t(this),function(i,o){new n(t(this),e)})},e.ConcreteHelpLauncher=n}(this,$,_),!function(e,t){"use strict";var i={guides:{},register:function(e,t){this.guides[e]=t},getGuide:function(e){return this.guides[e]},enterToolbarGuideMode:function(){ConcreteHelpLauncher.close(),t(".ccm-dialog-help-wrapper").hide(),this.showOverlay()},showOverlay:function(){if(t(".ui-widget-overlay").length<1){t('<div class="ui-widget-overlay"></div>').hide().appendTo("body")}t(".ui-widget-overlay").addClass("animated fadeIn").show(),t("#ccm-toolbar").addClass("ccm-toolbar-tour-guide")},hideOverlay:function(){t(".ui-widget-overlay").addClass("animated fadeOut"),t(".ui-widget-overlay").delay(250).queue(function(){t(this).remove(),t(this).dequeue()}),t("#ccm-toolbar").removeClass("ccm-toolbar-tour-guide")},exitToolbarGuideMode:function(){this.hideOverlay(),t(".ccm-dialog-help-wrapper").length&&t(".ccm-dialog-help-wrapper").show()},launchGuideOnRefresh:function(e){t.cookie("ConcreteHelpActiveGuide",e,{path:CCM_REL+"/"})},clearGuideToLaunchOnRefresh:function(e){t.cookie("ConcreteHelpActiveGuide",null,{path:CCM_REL+"/"})},getGuideToLaunchOnRefresh:function(){return t.cookie("ConcreteHelpActiveGuide")},get:function(){return i}};e.ConcreteHelpGuideManager=i}(this,$),!function(e,t){"use strict";var i=ccmi18n_helpGuides.toolbar,n=[{content:'<p><span class="h5">'+i[0].title+"</span><br/>"+i[0].text+"</p>",highlightTarget:!0,nextButton:!0,closeButton:!0,target:t("[data-guide-toolbar-action=edit-page]"),my:"top left",at:"bottom center"},{content:'<p><span class="h5">'+i[1].title+"</span><br/>"+i[1].text+"</p>",highlightTarget:!0,nextButton:!0,closeButton:!0,target:t("[data-guide-toolbar-action=page-settings]"),my:"top left",at:"bottom center"},{content:'<p><span class="h5">'+i[2].title+"</span><br/>"+i[2].text+"</p>",highlightTarget:!0,nextButton:!0,closeButton:!0,target:t("[data-guide-toolbar-action=add-content]"),my:"top left",at:"bottom center"},{content:'<p><span class="h5">'+i[3].title+"</span><br/>"+i[3].text+"</p>",highlightTarget:!0,nextButton:!0,closeButton:!0,target:t("[data-guide-toolbar-action=intelligent-search]"),my:"top center",at:"bottom center"},{content:'<p><span class="h5">'+i[4].title+"</span><br/>"+i[4].text+"</p>",highlightTarget:!0,nextButton:!0,closeButton:!0,target:t("[data-guide-toolbar-action=sitemap]"),my:"top right",at:"bottom center"},{content:'<p><span class="h5">'+i[5].title+"</span><br/>"+i[5].text+"</p>",highlightTarget:!0,nextButton:!0,closeButton:!0,target:t("[data-guide-toolbar-action=dashboard]"),my:"top right",at:"bottom center"}],o=new Tourist.Tour({steps:n,tipClass:"Bootstrap",tipOptions:{showEffect:"slidein"}});o.on("start",function(){ConcreteHelpGuideManager.enterToolbarGuideMode()}),o.on("stop",function(){ConcreteHelpGuideManager.exitToolbarGuideMode()}),ConcreteHelpGuideManager.register("toolbar",o)}(window,jQuery),!function(e,t){"use strict";var i=ccmi18n_helpGuides["change-content"],n=[{content:'<p><span class="h5">'+i[0].title+"</span><br/>"+i[0].text+"</p>",highlightTarget:!1,closeButton:!0,nextButton:!1,target:t("[data-guide-toolbar-action=edit-page]"),my:"top left",at:"bottom center"}],o=new Tourist.Tour({steps:n,tipClass:"Bootstrap",tipOptions:{showEffect:"slidein"}});o.on("start",function(){ConcreteHelpGuideManager.enterToolbarGuideMode(),
ConcreteHelpGuideManager.launchGuideOnRefresh("change-content-edit-mode")}),o.on("stop",function(){ConcreteHelpGuideManager.exitToolbarGuideMode()}),ConcreteHelpGuideManager.register("change-content",o)}(window,jQuery),!function(e,t){"use strict";var i=ccmi18n_helpGuides["change-content-edit-mode"],n=t("div.ccm-area:not(.ccm-global-area)").eq(0),o=n.find(".ccm-block-edit").eq(0),s=[{content:'<p><span class="h5">'+i[0].title+"</span><br/>"+i[0].text+"</p>",highlightTarget:!1,nextButton:!0,closeButton:!0,target:t("[data-guide-toolbar-action=check-in]"),my:"top left",at:"bottom center",setup:function(e,t){ConcreteHelpGuideManager.clearGuideToLaunchOnRefresh()}},{content:'<p><span class="h5">'+i[1].title+"</span><br/>"+i[1].text+"</p>",highlightTarget:!1,nextButton:!1,closeButton:!0,target:o,my:"top left",at:"bottom center",setup:function(e,t){ConcreteEvent.subscribe("ConcreteMenuShow.changeContentEditModeTour",function(t,i){e.next()})},teardown:function(e,t){ConcreteEvent.unsubscribe("ConcreteMenuShow.changeContentEditModeTour")}},{content:'<p><span class="h5">'+i[2].title+"</span><br/>"+i[2].text+"</p>",closeButton:!0,highlightTarget:!1,nextButton:!0,setup:function(e,i){var n=t("div#ccm-popover-menu-container div.ccm-edit-mode-block-menu").eq(0);return{target:n}},teardown:function(){var e=ConcreteMenuManager.getActiveMenu();e&&e.hide()},my:"left center",at:"right center"},{content:'<p><span class="h5">'+i[3].title+"</span><br/>"+i[3].text+"</p>",highlightTarget:!0,nextButton:!0,target:t("[data-guide-toolbar-action=check-in]"),my:"top left",at:"bottom center"}],a=new Tourist.Tour({steps:s,tipClass:"Bootstrap",tipOptions:{showEffect:"slidein"}});a.on("start",function(){}),a.on("stop",function(){t(".ccm-dialog-help-wrapper").show()}),ConcreteHelpGuideManager.register("change-content-edit-mode",a)}(window,jQuery),!function(e,t){"use strict";var i=ccmi18n_helpGuides["add-content"],n=[{content:'<p><span class="h5">'+i[0].title+"</span><br/>"+i[0].text+"</p>",highlightTarget:!0,closeButton:!0,nextButton:!1,target:t("[data-guide-toolbar-action=add-content]"),my:"top left",at:"bottom center"}],o=new Tourist.Tour({steps:n,tipClass:"Bootstrap",tipOptions:{showEffect:"slidein"}});o.on("start",function(){ConcreteHelpGuideManager.enterToolbarGuideMode(),ConcreteHelpGuideManager.launchGuideOnRefresh("add-content-edit-mode")}),o.on("stop",function(){ConcreteHelpGuideManager.exitToolbarGuideMode()}),ConcreteHelpGuideManager.register("add-content",o)}(window,jQuery),!function(e,t){"use strict";var i=ccmi18n_helpGuides["add-content-edit-mode"],n=[{content:'<p><span class="h5">'+i[0].title+"</span><br/>"+i[0].text+"</p>",highlightTarget:!1,nextButton:!0,closeButton:!0,target:t("[data-guide-toolbar-action=add-content]"),my:"top left",at:"bottom center",setup:function(e,t){ConcreteHelpGuideManager.clearGuideToLaunchOnRefresh()}},{content:'<p><span class="h5">'+i[1].title+"</span><br/>"+i[1].text+"</p>",highlightTarget:!1,nextButton:!0,closeButton:!0,target:t("[data-guide-toolbar-action=add-content]"),my:"top center",at:"top center",setup:function(e,i){return{target:t("#ccm-panel-add-block .ccm-panel-content-inner")}},teardown:function(e,t){}},{content:'<p><span class="h5">'+i[2].title+"</span><br/>"+i[2].text+"</p>",highlightTarget:!1,nextButton:!0,closeButton:!0,target:t("[data-guide-toolbar-action=add-content]"),my:"left center",at:"right center",setup:function(e,i){return{target:t("#ccm-panel-add-block .ccm-panel-header-accordion")}}},{content:'<p><span class="h5">'+i[3].title+"</span><br/>"+i[3].text+"</p>",highlightTarget:!1,nextButton:!0,closeButton:!0,target:t("[data-guide-toolbar-action=add-content]"),my:"left center",at:"right center",setup:function(e,i){return{target:t("#ccm-panel-add-block input[data-input=search-blocks]")}}},{content:'<p><span class="h5">'+i[4].title+"</span><br/>"+i[4].text+"</p>",highlightTarget:!1,nextButton:!0,closeButton:!0,target:t("[data-guide-toolbar-action=add-content]"),my:"left center",at:"right center",setup:function(e,i){return{target:t("#ccm-panel-add-block .ccm-panel-add-block-draggable-block-type").eq(0)}}}],o=new Tourist.Tour({steps:n,tipClass:"Bootstrap",tipOptions:{showEffect:"slidein"}});o.on("start",function(){}),o.on("stop",function(){t(".ccm-dialog-help-wrapper").length?t(".ccm-dialog-help-wrapper").show():(jQuery.fn.dialog.showLoader(),window.location.href=t("[data-toolbar-action=check-in]").attr("href"))}),ConcreteHelpGuideManager.register("add-content-edit-mode",o)}(window,jQuery),!function(e,t){"use strict";var i=ccmi18n_helpGuides["add-page"],n=[{content:'<p><span class="h5">'+i[0].title+"</span><br/>"+i[0].text+"</p>",highlightTarget:!0,nextButton:!1,closeButton:!0,target:t("[data-guide-toolbar-action=sitemap]"),my:"top right",at:"bottom center",setup:function(e,i){t("a[data-launch-panel=sitemap]").on("click",function(){e.view.tip.hide(),ConcreteHelpGuideManager.hideOverlay()}),ConcreteEvent.subscribe("PanelOpen.concreteAddPageTour",function(t,i){setTimeout(function(){var t=i.panel.getIdentifier();"sitemap"==t&&e.next()},500)})}},{content:'<p><span class="h5">'+i[1].title+"</span><br/>"+i[1].text+"</p>",highlightTarget:!0,nextButton:!0,closeButton:!0,my:"right center",at:"left center",setup:function(e,i){return{target:t("ul.ccm-panel-sitemap-list li a").eq(0)}}},{content:'<p><span class="h5">'+i[2].title+"</span><br/>"+i[2].text+"</p>",highlightTarget:!0,nextButton:!0,closeButton:!0,my:"right center",at:"left center",setup:function(e,i){return{target:t("div#ccm-sitemap-panel-sitemap")}}}],o=new Tourist.Tour({steps:n,tipClass:"Bootstrap",tipOptions:{showEffect:"slidein"}});o.on("start",function(){ConcreteHelpGuideManager.enterToolbarGuideMode()}),o.on("stop",function(){ConcreteHelpGuideManager.exitToolbarGuideMode(),ConcreteEvent.unsubscribe("PanelOpen.concreteAddPageTour")}),ConcreteHelpGuideManager.register("add-page",o)}(window,jQuery),!function(e,t){"use strict";var i=ccmi18n_helpGuides.personalize,n=[{content:'<p><span class="h5">'+i[0].title+"</span><br/>"+i[0].text+"</p>",highlightTarget:!0,nextButton:!1,closeButton:!0,target:t("[data-guide-toolbar-action=page-settings]"),my:"top left",at:"bottom center",setup:function(e,i){t("a[data-launch-panel=page]").on("click",function(){e.view.tip.hide(),ConcreteHelpGuideManager.hideOverlay()}),ConcreteEvent.subscribe("PanelOpen.concretePersonalizeTour",function(t,i){setTimeout(function(){var t=i.panel.getIdentifier();"page"==t&&e.next()},500)})}},{content:'<p><span class="h5">'+i[1].title+"</span><br/>"+i[1].text+"</p>",highlightTarget:!0,nextButton:!1,my:"left center",closeButton:!0,at:"right center",setup:function(e,i){return t("a[data-launch-panel-detail=page-design]").on("click",function(){e.view.tip.hide()}),ConcreteEvent.subscribe("PanelOpenDetail.concretePersonalizeTour",function(t,i){setTimeout(function(){"page-design"==i.panel.identifier&&e.next()},500)}),{target:t("a[data-launch-panel-detail=page-design]").eq(0)}}},{content:'<p><span class="h5">'+i[2].title+"</span><br/>"+i[2].text+"</p>",highlightTarget:!0,nextButton:!0,closeButton:!0,my:"bottom center",at:"top center",setup:function(e,i){return{target:t("span.ccm-page-design-theme-customize")}}}],o=new Tourist.Tour({steps:n,tipClass:"Bootstrap",tipOptions:{showEffect:"slidein"}});o.on("start",function(){ConcreteHelpGuideManager.enterToolbarGuideMode()}),o.on("stop",function(){ConcreteHelpGuideManager.exitToolbarGuideMode(),ConcreteEvent.unsubscribe("PanelOpen.concretePersonalizeTour"),ConcreteEvent.unsubscribe("PanelOpenDetail.concretePersonalizeTour")}),ConcreteHelpGuideManager.register("personalize",o)}(window,jQuery),!function(e,t){"use strict";var i=ccmi18n_helpGuides.dashboard,n=[{content:'<p><span class="h5">'+i[0].title+"</span><br/>"+i[0].text+"</p>",highlightTarget:!0,nextButton:!1,closeButton:!0,target:t("[data-guide-toolbar-action=dashboard]"),my:"top right",at:"bottom center",setup:function(e,i){t("a[data-launch-panel=dashboard]").on("click",function(){e.view.tip.hide(),ConcreteHelpGuideManager.hideOverlay()}),ConcreteEvent.subscribe("PanelOpen.concreteDashboardTour",function(t,i){setTimeout(function(){var t=i.panel.getIdentifier();"dashboard"==t&&e.next()},500)})}},{content:'<p><span class="h5">'+i[1].title+"</span><br/>"+i[1].text+"</p>",highlightTarget:!1,nextButton:!0,closeButton:!0,my:"right center",at:"left center",setup:function(e,i){return{target:t("div#ccm-panel-dashboard ul.nav a[href$=sitemap]").eq(0)}}}],o=new Tourist.Tour({steps:n,tipClass:"Bootstrap",tipOptions:{showEffect:"slidein"}});o.on("start",function(){ConcreteHelpGuideManager.enterToolbarGuideMode()}),o.on("stop",function(){ConcreteHelpGuideManager.exitToolbarGuideMode(),ConcreteEvent.unsubscribe("PanelOpen.concreteDashboardTour")}),ConcreteHelpGuideManager.register("dashboard",o)}(window,jQuery),!function(e,t){"use strict";var i=ccmi18n_helpGuides["location-panel"],n=[{content:'<p><span class="h5">'+i[0].title+"</span><br/>"+i[0].text+"</p>",highlightTarget:!0,nextButton:!0,closeButton:!0,setup:function(e,i){return{target:t("#ccm-panel-detail-page-location button[name=location]")}},my:"left center",at:"right center"},{content:'<p><span class="h5">'+i[1].title+"</span><br/>"+i[1].text+"</p>",highlightTarget:!0,nextButton:!0,closeButton:!0,setup:function(e,i){return{target:t("#ccm-panel-detail-page-location p.lead").eq(1)}},my:"right center",at:"left center"}],o=new Tourist.Tour({steps:n,tipClass:"Bootstrap",tipOptions:{showEffect:"slidein"}});ConcreteHelpGuideManager.register("location-panel",o)}(window,jQuery),function(e,t,i,n){"use strict";var o=n.EditMode=function(e){this.init.call(this,e)};o.prototype={init:function(o){function s(e,t,n,o,r,l,d){if(a.getDragging())if(r.call()){c=!0;var p=l.call(t),u=p+n,h=i.toArray(arguments),f=e.getDraggerPosition();l.call(t,u),f[d]-=p-l.call(t),e.renderPosition(),i.defer(function(){s.apply(this,h)},o)}else c=!1}var a=this;o=o||{},o=t.extend({notify:!1},o),n.createGetterSetters.call(a,{dragging:!1,active:!0,nextBlockArea:null,areas:[],selectedCache:[],selectedThreshold:5,dragAreaBlacklist:[]}),a.bindEvent("PanelLoad",function(e,t){a.panelOpened(t.panel,t.element)}),a.bindEvent("PanelClose",function(e,t){"add-block"==t.panel.getIdentifier()&&a.setNextBlockArea(null),html.removeClass("ccm-panel-add-block")}),a.bindEvent("EditModeAddBlockComplete EditModeUpdateBlockComplete",function(e){i.defer(function(){a.scanBlocks()})}),a.bindEvent("EditModeBlockSaveInline",function(e,i){t("#ccm-block-form").submit(),ConcreteEvent.fire("EditModeExitInlineSaved"),ConcreteEvent.fire("EditModeExitInline",{action:"save_inline"})}),a.bindEvent("EditModeBlockEditInline",function(e,o){var s,r=o.block,c=r.getArea(),l=o.action?o.action:CCM_DISPATCHER_FILENAME+"/ccm/system/dialogs/block/edit",d=c.getEnableGridContainer()?1:0,p=c.getCustomTemplates(),u=[{name:"cID",value:r.getCID()},{name:"arHandle",value:c.getHandle()},{name:"arGridMaximumColumns",value:o.arGridMaximumColumns},{name:"arEnableGridContainer",value:d},{name:"aID",value:c.getId()},{name:"bID",value:r.getId()}],h=(r.getId(),r.getElem());if(p)for(var f in p)u[u.length]={name:"arCustomTemplates["+f+"]",value:p[f]};if(r.getAttr("menu")&&r.getAttr("menu").destroy(),o.postData)for(s in o.postData)o.postData.hasOwnProperty(s)&&u.push({name:s,value:o.postData[s]});n.event.unbind("EditModeExitInline.editmode"),a.bindEvent("EditModeExitInline.editmode",function(e,o){n.event.unbind(e),e.stopPropagation();var s=CCM_DISPATCHER_FILENAME+"/ccm/system/block/render",l={cID:r.getCID(),arEnableGridContainer:d,bID:r.getId(),arHandle:c.getHandle()};t.fn.dialog.showLoader(),o&&o.action&&"save_inline"===o.action||t.get(s,l,function(e){var t=a.getBlockByID(r.getId());if(t){var n=t.replace(e);i.defer(function(){ConcreteEvent.fire("EditModeExitInlineComplete",{block:n}),a.destroyInlineEditModeToolbars(),i.defer(function(){a.scanBlocks()})})}})}),ConcreteToolbar.disable(),t("div.ccm-area").addClass("ccm-area-inline-edit-disabled"),r.getElem().addClass("ccm-block-edit-inline-active"),t.ajax({type:"GET",url:l,data:u,success:function(e){var i=t(e);h.empty().append(i).find(".ccm-block-edit").addClass("ccm-block-edit-inline-active"),a.loadInlineEditModeToolbars(h),t.fn.dialog.hideLoader(),n.event.fire("EditModeInlineEditLoaded",{block:r,element:i})}})}),a.bindEvent("EditModeBlockAddInline",function(e,i){var o,s,r,c=i.area,l=i.selected,d=i.btID,p=i.cID,u=c.getEnableGridContainer()?1:0,h=[{name:"btask",value:"edit"},{name:"cID",value:p},{name:"arGridMaximumColumns",value:i.arGridMaximumColumns},{name:"arEnableGridContainer",value:u},{name:"arHandle",value:c.getHandle()},{name:"btID",value:d}];l?(r=l.getElem(),o=l.getBlock()):(r=c.getBlockContainer().children().last(),o=i.dragAreaBlock);var f=c.getCustomTemplates();if(f)for(var m in f)h[h.length]={name:"arCustomTemplate["+m+"]",value:f[m]};o&&(s=o.getId()),ConcreteMenuManager.disable(),ConcreteToolbar.disable(),jQuery.fn.dialog.closeAll(),t("div.ccm-area").addClass("ccm-area-inline-edit-disabled"),t.fn.dialog.showLoader(),c.getAttr("menu")&&c.getAttr("menu").destroy();var g=!1;a.bindEvent("EditModeExitInlineSaved",function(e){n.event.unbind(e),g=!0;var t=ConcretePanelManager.getByIdentifier("add-block");t&&t.pinned()&&t.show()}),a.bindEvent("EditModeExitInline",function(e){if(n.event.unsubscribe(e),!g){t("#a"+c.getId()+"-bt"+d).remove(),a.destroyInlineEditModeToolbars(),ConcreteEvent.fire("EditModeExitInlineComplete");var i=ConcretePanelManager.getByIdentifier("add-block");i&&i.pinned()&&i.show()}}),t.ajax({type:"GET",url:CCM_DISPATCHER_FILENAME+"/ccm/system/dialogs/page/add_block",data:h,success:function(e){var i=t(e),n=t('<div class="ccm-block-edit-inline-active"></div>');n.attr("id","a"+c.getId()+"-bt"+d).append(i),c.getElem().addClass("ccm-area-edit-inline-active"),r.after(n),t(function(){n.find("#ccm-block-form").concreteAjaxBlockForm({task:"add",btSupportsInlineAdd:!0,dragAreaBlockID:s,dragArea:l,placeholder:"#a"+c.getId()+"-bt"+d})}),a.loadInlineEditModeToolbars(n.find("div[data-container=inline-toolbar]"))},complete:function(){t.fn.dialog.hideLoader()}})}),n.event.bind("EditModeBlockAddToClipboard",function(e,i){var n=i.block,o=n.getArea(),s=i.token;ConcreteToolbar.disableDirectExit(),t.ajax({type:"POST",url:CCM_TOOLS_PATH+"/pile_manager",data:"cID="+n.getCID()+"&bID="+n.getId()+"&arHandle="+encodeURIComponent(o.getHandle())+"&btask=add&scrapbookName=userScrapbook&ccm_token="+encodeURIComponent(s),success:function(e){ConcreteAlert.notify({message:ccmi18n.copyBlockToScrapbookMsg,title:ccmi18n.copyBlockToScrapbook})}})}),a.bindEvent("EditModeBlockDelete",function(e,t){var i=t.block;i["delete"](t.message)}),a.bindEvent("EditModeBlockDeleteComplete",function(e,t){var i=t.block;i.finishDelete(),ConcreteEvent.fire("EditModeBlockDeleteAfterComplete",{block:i})});var r=t(e.document.body),c=!1,l=100;a.bindEvent("EditModeBlockDrag",i.throttle(function(o,d){if(a.getDragging()){var p,u=d.block,h=d.pep,f=a.getAreas();u instanceof n.Layout&&(f=[i(f).find(function(e){return u.getArea()===e})]),p=i.flatten(i(f).map(function(e){var t=e.contendingDragAreas(h,u);return t}),!0),i.defer(function(){n.event.fire("EditModeContenders",p),a.selectContender(h,u,p,d.event)}),c||(s(u,r,2,10,function(){var i=u.getDraggerPosition().y-r.scrollTop();return u.getDragging()&&t(e).height()-i<=l},t.fn.scrollTop,"y"),s(u,r,-2,10,function(){var e=u.getDraggerPosition().y-r.scrollTop();return u.getDragging()&&e<=l},t.fn.scrollTop,"y"),s(u,r,2,10,function(){var i=u.getDraggerPosition().x-r.scrollLeft();return u.getDragging()&&t(e).width()-i<=l},t.fn.scrollLeft,"x"),s(u,r,-2,10,function(){var e=u.getDraggerPosition().x-r.scrollLeft();return u.getDragging()&&e<=l},t.fn.scrollLeft,"x"))}},250,{trailing:!1})),a.bindEvent("EditModeBlockDragStop",function(e,i){n.event.fire("EditModeContenders",[]),n.event.fire("EditModeSelectableContender"),t("html").removeClass("ccm-block-dragging"),i.block instanceof n.BlockType||a.scanBlocks()}),a.bindEvent("EditModeBlockMove",function(n,o){var s=o.block,a=o.targetArea,r=o.sourceArea,c={ccm_token:e.CCM_SECURITY_TOKEN,btask:"ajax_do_arrange",area:a.getId(),sourceArea:r.getId(),block:s.getId(),blocks:[]};a=a.inEditMode(a.getEditMode()),i(a.getBlocks()).each(function(e,t){c.blocks.push(e.getId())}),s.bindMenu();var l=!1,d=setTimeout(function(){l=!0,t.fn.dialog.showLoader()},150);t.concreteAjax({url:CCM_DISPATCHER_FILENAME+"/ccm/system/page/arrange_blocks?cID="+s.getCID(),data:c,success:function(e){ConcreteToolbar.disableDirectExit(),t.fn.dialog.hideLoader(),clearTimeout(d)}})}),a.bindEvent("EditModeBlockDragStart",function(){t("html").addClass("ccm-block-dragging"),a.setDragging(!0)}),a.scanBlocks(),n.getEditMode=function(){return a},o.notify&&ConcreteAlert.notify({message:ccmi18n.editModeMsg,title:ccmi18n.editMode}),ConcreteEvent.fire("EditModeAfterInit",{editMode:a})},bindEvent:function(e,t){return n.event.bind(e,t)},reset:function(){var e=this;i(e.getAreas()).each(function(e){e.destroy()}),e.setAttr("areas",[])},scanBlocks:function(){var e,o=this;o.reset(),t("div.ccm-area").each(function(){var i=t(this);i.parent().hasClass("ccm-block-stack")||(e=new n.Area(i,o),e.scanBlocks(),o.addArea(e))}),i.invoke(o.getAreas(),"bindMenu")},panelOpened:function(e,i){var o=this,s=o.getNextBlockArea();return"add-block"!==e.getIdentifier()?null:(html.addClass("ccm-panel-add-block"),t(i).find("input[data-input=search-blocks]").liveUpdate("ccm-panel-add-blocktypes-list","blocktypes"),t(i).find("input[data-input=search-blocks]").focus(),t(i).find("a.ccm-panel-add-block-draggable-block-type").each(function(){var e,i=t(this),a=t("<a/>").addClass("ccm-panel-add-block-draggable-block-type-dragger").appendTo(i);e=new n.BlockType(t(this),o,a,s),e.setPeper(a)}),t(i).find("div.ccm-panel-add-block-stack-item").each(function(){var e,i=t(this),a=i.find("div.stack-name");e=new n.Stack(t(this),o,a,s),e.setPeper(a),t(this).find("div.block").each(function(){var i,a=t(this),r=a.find("div.block-name");i=new n.StackBlock(t(this),e,o,r,s),i.setPeper(r)})}),t(i).find("div.ccm-panel-add-clipboard-block-item").each(function(){var e=t(this);new n.DuplicateBlock(e,o,s)}),t(i).find(".ccm-panel-content").mousewheel(function(e){if(e.deltaY&&e.deltaFactor){var i=-1*e.deltaY*e.deltaFactor,n=t(this),o=i||0,s=n.scrollTop(),a=n.get(0).scrollHeight-(n.scrollTop()+n.height())-n.css("paddingTop").replace("px","");if(o)return!(o<0&&!s||o>0&&!a)&&(n.scrollTop(n.scrollTop()+o),!1)}}),e)},getAreaByID:function(e){var t=this.getAreas();return i.findWhere(t,{id:parseInt(e)})},getBlockByID:function(e){var t=this.getAreas(),n=null;return i(t).every(function(t){return!n&&(i(t.getBlocks()).every(function(t){return t.getId()!=e||(n=t,!1)}),!0)}),n},selectContender:function(e,t,o,s){var a=this;if(o=i(o).filter(function(i){return i.isSelectable(e,t,s)}),o.length<2)return n.event.fire("EditModeSelectableContender",i(o).first());var r=a.getSelectedCache(),c=a.getDragAreaBlacklist();a.getSelectedThreshold()!==r.length||i(r).without(i(r).last()).length||(c.push(i(r).last()),a.setDragAreaBlacklist(c),i.delay(function(e){var t=a.getDragAreaBlacklist();a.setDragAreaBlacklist(i(t).without(e))},5e3,i(r).last())),o=i(o).difference(c);var l=i(o).min(function(e){var t=e.centerDistanceToBlock(this);return t},t);return r.push(l),a.setSelectedCache(i(r).last(a.getSelectedThreshold())),n.event.fire("EditModeSelectableContender",l),l},addArea:function(e){var t=this;t.getAreas().push(e)},getBlocks:function(){var e=[];return i(this.getAreas()).each(function(t){e.push(t.getBlocks())}),i(e).flatten()},destroyInlineEditModeToolbars:function(){ConcreteMenuManager.enable(),t("div.ccm-area-edit-inline-active").removeClass("ccm-area-edit-inline-active"),t("div.ccm-block-edit-inline-active").remove(),t("div.ccm-area").removeClass("ccm-area-inline-edit-disabled"),t("#ccm-toolbar").css("opacity",1),t("#ccm-inline-toolbar-container").remove(),t(e).unbind("scroll.inline-toolbar"),ConcreteToolbar.enable(),t.fn.dialog.hideLoader()},loadInlineEditModeToolbars:function(i,n){t("#ccm-inline-toolbar-container").remove();var o=t("<div />",{id:"ccm-inline-toolbar-container"}).appendTo(document.body);if(n){o.append(n);var s=o.find(".ccm-inline-toolbar")}else{var s=i.find(".ccm-inline-toolbar");s.appendTo(o)}var a=t(e),r=i.offset(),c=r.left,l=c+parseInt(s.width());if(a.width()>s.width())if(l>a.width()){var d=l-(c+i.width());s.css("left",c-d)}else s.css("left",c);s.css("opacity",1),s.find(".dialog-launch").dialog();var p=r.top-o.outerHeight()-5;o.css("top",p).css("opacity",1),a.scrollTop()>p&&(t("#ccm-toolbar-disabled,#ccm-toolbar").css("opacity",0),o.addClass("ccm-inline-toolbar-affixed")),a.on("scroll.inline-toolbar",function(){o.toggleClass("ccm-inline-toolbar-affixed",a.scrollTop()>p),a.scrollTop()>p?t("#ccm-toolbar-disabled,#ccm-toolbar").css("opacity",0):t("#ccm-toolbar-disabled,#ccm-toolbar").css("opacity",1)})}}}(window,jQuery,_,Concrete),function(e,t,i,n){"use strict";var o=n.Block=function(e,t,n){this.init.apply(this,i(arguments).toArray())};o.prototype={init:function(e,o,s){var a=this;e.data("Concrete.block",a),e.children(".ccm-block-cover").length||t("<div/>").addClass("ccm-block-cover").appendTo(e),n.createGetterSetters.call(a,{id:e.data("block-id"),active:!0,handle:e.data("block-type-handle"),areaId:e.data("area-id"),cID:e.data("cid"),wraps:!!e.data("block-type-wraps"),area:null,elem:e,dragger:null,draggerOffset:{x:0,y:0},draggerPosition:{x:0,y:0},dragging:!1,rotationDeg:0,editMode:o,selected:null,stepIndex:0,peper:s||e.children(".ccm-edit-mode-inline-commands, .ccm-custom-style-container").find('a[data-inline-command="move-block"]'),pepSettings:{}}),a.id=a.getId(),i(a.getPepSettings()).extend({deferPlacement:!0,moveTo:function(){a.dragPosition(this)},initiate:function(e,t){a.pepInitiate.call(a,this,e,t)},drag:function(e,t){a.pepDrag.call(a,this,e,t)},start:function(e,t){a.pepStart.call(a,this,e,t)},stop:function(e,t){a.pepStop.call(a,this,e,t)},place:!1}),a.bindEvent("EditModeSelectableContender",function(e,t){a.getDragging()&&t instanceof n.DragArea?a.setSelected(t):a.getDragging()&&a.setSelected(null)}),a.getPeper().click(function(e){return e.preventDefault(),e.stopPropagation(),!1}).pep(a.getPepSettings())},destroy:function(){this.getPeper().unbind(),t.pep.unbind(this.getPeper()),this.setAttr("active",!1)},bindEvent:function(e,t){return n.EditMode.prototype.bindEvent.apply(this,i(arguments).toArray())},getContainer:function(){for(var e=this.getElem();!e.parent().hasClass("ccm-area-block-list")&&!e.parent().is("[data-area-id]")&&e.parent().length;)e=e.parent();return e},addToDragArea:function(e){var i,o,s=this,a=s.getArea(),r=e.getArea();a.removeBlock(s),s.getContainer().remove(),s.getWraps()?(o=t(r.getBlockTemplate()()),e.getElem().after(o),o.children().length?o.find("div.block").replaceWith(s.getElem()):o.append(s.getElem())):e.getElem().after(s.getElem()),i=e.getBlock(),i?e.getArea().addBlock(s,i):e.getArea().addBlockToIndex(s,0),s.getPeper().pep(s.getPepSettings()),s.getEditMode().scanBlocks(),n.event.fire("EditModeBlockMove",{block:s,sourceArea:a,targetArea:r})},handleAddResponse:function(e,o,s,a){var r=this,c=o.getEnableGridContainer()?1:0;if(!e.error)return t.get(CCM_DISPATCHER_FILENAME+"/ccm/system/block/render",{arHandle:e.arHandle,cID:e.cID,bID:e.bID,arEnableGridContainer:c},function(e){s?s.getContainer().after(e):o.getBlockContainer().prepend(e),t.fn.dialog.hideLoader(),i.defer(function(){r.getEditMode().scanBlocks(),r.showSuccessfulAdd(),n.forceRefresh(),a&&a()})}),!0},showSuccessfulAdd:function(){ConcreteAlert.notify({message:ccmi18n.addBlockMsg,title:ccmi18n.addBlock})},"delete":function(e){var i=this,n=i.getId(),o=i.getArea(),s=(o.getBlockByID(n),i.getCID()),a=o.getHandle(),r="cID="+s+"&ccm_token="+CCM_SECURITY_TOKEN+"&isAjax=true&btask=remove&bID="+n+"&arHandle="+encodeURIComponent(a);t.fn.dialog.open({width:460,height:"auto",href:CCM_DISPATCHER_FILENAME+"/ccm/system/dialogs/block/delete",modal:!0,data:r,title:ccmi18n.deleteBlockConfirm})},finishDelete:function(){ConcreteToolbar.disableDirectExit();var e=this,t=e.getId(),i=e.getArea(),n=i.getBlockByID(t);e.getCID(),i.getHandle();i.removeBlock(n)},replace:function(e){var i=t(e);return this.getContainer().replaceWith(i),this.getArea().scanBlocks(),this.getArea().getBlockByID(this.getId())},getMenuElem:function(){return t("div.ccm-edit-mode-block-menu",this.getElem()).first()},bindMenu:function(){var e=this,i=e.getElem(),o=i.attr("data-block-menu-handle"),s=e.getMenuElem();if("none"!==o){var a={highlightClassName:"ccm-block-highlight",menuActiveClass:"ccm-block-highlight",menu:s};e.getArea()&&e.getArea().getElem().hasClass("ccm-global-area")&&(a.menuActiveClass+=" ccm-global-area-block-highlight",a.highlightClassName+=" ccm-global-area-block-highlight"),e.setAttr("menu",new ConcreteMenu(i,a)),s.find("a[data-menu-action=edit_inline]").unbind("click.core").on("click.core",function(t){n.event.fire("EditModeBlockEditInline",{block:e,event:t})}),s.find("a[data-menu-action=block_scrapbook]").unbind("click.core").on("click.core",function(i){n.event.fire("EditModeBlockAddToClipboard",{block:e,event:i,token:t(this).data("token")})}),s.find("a[data-menu-action=delete_block]").unbind("click.core").on("click.core",function(i){n.event.fire("EditModeBlockDelete",{message:t(this).attr("data-menu-delete-message"),block:e,event:i})}),s.find("a[data-menu-action=block_design]").unbind("click.core").on("click.core",function(t){t.preventDefault(),n.event.fire("EditModeBlockEditInline",{block:e,event:t,action:CCM_DISPATCHER_FILENAME+"/ccm/system/dialogs/block/design"})})}},setArea:function(e){this.setAttr("area",e);var i=this;i.getElem().find("a[data-menu-action=block_dialog]").each(function(){var n=t(this).data("menu-href");n+=n.indexOf("?")!==-1?"&cID="+i.getCID():"?cID="+i.getCID(),n+="&arHandle="+encodeURIComponent(e.getHandle())+"&bID="+i.getId(),t(this).attr("href",n).dialog()}),i.bindMenu()},getDragger:function(){var e=this;if(!e.getAttr("dragger")){var i=t("<a />").html(e.getElem().data("dragging-avatar")||'<p><img src="/concrete/blocks/content/icon.png"><span>'+ccmi18n.content+"</span></p>").addClass("ccm-block-edit-drag ccm-panel-add-block-draggable-block-type");e.setAttr("dragger",i.css({width:e.getElem().width(),height:e.getElem().height()}))}return e.getAttr("dragger")},transform:function(e,t){var n=this,o=n.getDragger().css({"-webkit-transform":e,"-moz-transform":e,"-ms-transform":e,"-o-transform":e,transform:e}).get(0);if(o.filters&&o.filters["DXImageTransform.Microsoft.Matrix"]){var s={elements:i(t).groupBy(function(e,t){return Math.floor(t/3)})};o.filters["DXImageTransform.Microsoft.Matrix"].M11=s.elements[0][0],o.filters["DXImageTransform.Microsoft.Matrix"].M12=s.elements[0][1],o.filters["DXImageTransform.Microsoft.Matrix"].M21=s.elements[1][0],o.filters["DXImageTransform.Microsoft.Matrix"].M22=s.elements[1][1],o.style.left=-(o.offsetWidth/2)+o.clientWidth/2+"px",o.style.top=-(o.offsetHeight/2)+o.clientHeight/2+"px"}return!0},resetTransform:function(){var e="",t=this.getDragger().css({top:0,left:0,"-webkit-transform":e,"-moz-transform":e,"-ms-transform":e,"-o-transform":e,transform:e}).get(0);return t.filters&&(t.filters=[]),this.setDraggerPosition({x:0,y:0}),this.renderPosition()},multiplyMatrices:function(e,t){for(var i=[],n=0;n<e.length;n++){i[n]=[];for(var o=0;o<e[0].length;o++){for(var s=0,a=0;a<e[0].length;a++)s+=e[n][a]*t[a][o];i[n][o]=s}}return i},matrixToCss:function(e){var t=4,n=Math.pow(10,t),o=function(e){return Math.round(e*n)/n};e[0]=i(e[0]).map(o),e[1]=i(e[1]).map(o);var s=[e[0][0],e[0][1],e[1][0],e[1][1],e[0][2],e[1][2]];return"matrix("+s.join(",")+")"},endRotation:function(){var e=this,t=e.getRotationDeg();e.getDragger().animate({rotation:0},{duration:1,step:function(){}});var i=e.setStepIndex(e.getStepIndex()+1);return e.getDragger().animate({rotation:e.getRotationDeg()},{queue:!1,duration:150,step:function(n){e.getStepIndex()===i&&(e.setRotationDeg(t-n),e.renderPosition())}},"easeOutElastic"),!0},renderPosition:function(){var e,t,n=this,o=n.getDraggerPosition().x,s=n.getDraggerPosition().y,a=n.getRotationDeg()*(Math.PI/180),r=i.bind(Math.cos,Math),c=i.bind(Math.sin,Math),l=[[1,0,o],[0,1,s],[0,0,1]];return a?(e=[[r(a),c(a),0],[-c(a),r(a),0],[0,0,1]],t=n.multiplyMatrices(l,e)):t=l,this.transform(n.matrixToCss(t),t)},dragPosition:function(e){var t=this;t.setRotationDeg(Math.max(-15,Math.min(15,e.velocity().x/15))),t.endRotation();var n=i.last(e.velocityQueue),o=t.getDraggerOffset();n||(n={x:t.getDragger().offset().left,y:t.getDragger().offset().top});var s=n.x-o.x,a=n.y-o.y;return t.setDraggerPosition({x:s,y:a}),t.renderPosition(),!0},pepInitiate:function(t,o,s){var a=this;a.resetTransform(),a.setDragging(!0),a.getDragger().hide().appendTo(e.document.body).css(a.getElem().offset()),a.setDraggerOffset({x:o.clientX-a.getElem().offset().left+e.document.body.scrollLeft,y:o.clientY-a.getElem().offset().top+e.document.body.scrollTop}),a.getDragger().fadeIn(250),i.defer(function(){n.event.fire("EditModeBlockDragInitialization",{block:a,pep:s,event:o})})},pepDrag:function(e,t,o){var s=this;i.defer(function(){n.event.fire("EditModeBlockDrag",{block:s,pep:o,event:t})})},pepStart:function(e,o,s){var a=this;a.resetTransform();var r=a.getElem(),c={x:o.pageX,y:o.pageY},l={x:r.offset().left,y:r.offset().top},d={x:(l.x-c.x)/r.width(),y:(l.y-c.y)/r.height()};a.setDraggerPosition({x:l.x,y:l.y}),a.renderPosition(),a.setDraggerOffset({x:-1*(d.x*r.width()),y:-1*(d.y*r.height())}),a.getDragger().animate({width:90,height:90},{duration:250,step:function(e,i){a.setDraggerOffset({x:-1*(d.x*t(this).width()),y:-1*(d.y*t(this).height())}),a.dragPosition(s)}}),i.defer(function(){n.event.fire("EditModeBlockDragStart",{block:a,pep:s,event:o})})},pepStop:function(e,t,o){var s,a=this;a.getDragger().stop(1),a.getDragger().css({top:0,left:0}),a.dragPosition(o),(s=a.getSelected())&&a.addToDragArea(s),a.animateToElem(),i.defer(function(){n.event.fire("EditModeBlockDragStop",{block:a,pep:o,event:t})})},animateToElem:function(e){var t=this,i=e||t.getElem(),n={x:t.getDraggerPosition().x,y:t.getDragger().offset().top,width:t.getDragger().width(),height:t.getDragger().height()};t.setDragging(!1),t.getDragger().animate({ccm_perc:0},{duration:0,step:function(){}}).animate({ccm_perc:1,opacity:0},{duration:500,step:function(e,o){if("ccm_perc"===o.prop){var s={x:i.offset().left,y:i.offset().top,width:i.width(),height:i.height()},a={x:(s.x-n.x)*e,y:(s.y-n.y)*e,width:(s.width-n.width)*e,height:(s.height-n.height)*e};t.setDraggerPosition({x:n.x+a.x,y:n.y+a.y}),t.renderPosition(),t.getDragger().css({width:n.width+a.width,height:n.height+a.height})}else t.getDragger().css({opacity:e})},complete:function(){t.getDragger().remove(),t.setAttr("dragger",null)}})}}}(window,jQuery,_,Concrete),function(e,t,i,n){"use strict";var o=n.StackDisplay=function(e,t){this.init.apply(this,i(arguments).toArray())};o.prototype=i.extend(Object.create(n.Block.prototype),{init:function(e,t){var o=this;e.children(".ccm-area").children(".ccm-area-block-list").find(".ccm-edit-mode-inline-commands").remove(),n.Block.prototype.init.apply(o,i(arguments).toArray())}})}(window,jQuery,_,Concrete),function(e,t,i,n){"use strict";var o=n.Area=function(e,t){this.init.apply(this,i(arguments).toArray())};o.prototype={init:function(e,o){var s=this;e.data("Concrete.area",s),n.createGetterSetters.call(s,{id:e.data("area-id"),active:!0,blockTemplate:i(e.children("script[role=area-block-wrapper]").html()).template(),elem:e,totalBlocks:0,enableGridContainer:e.data("area-enable-grid-container"),customTemplates:e.data("area-custom-templates"),handle:e.data("area-handle"),dragAreas:[],blocks:[],editMode:o,maximumBlocks:parseInt(e.data("maximumBlocks"),10),blockTypes:e.data("accepts-block-types").toLowerCase().split(" "),blockContainer:e.children(".ccm-area-block-list")}),s.id=s.getId(),s.setTotalBlocks(0),s.bindEvent("EditModeBlockAddInline.area",function(e,t){t.area===s&&s.setTotalBlocks(s.getTotalBlocks()+1)}),s.bindEvent("EditModeAddBlocksToArea.area",function(e,i){if(i.area===s){
s.getEditMode().setNextBlockArea(s);var n=t('[data-launch-panel="add-block"]');n.click()}})},inEditMode:function(e){return e.getAreaByID(this.getId())},destroy:function(){var e=this;e.getAttr("menu")&&e.getAttr("menu").destroy(),n.event.unbind(".ccm-area-a"+this.getId()),e.reset()},reset:function(){var e=this;i(e.getDragAreas()).each(function(e){e.destroy()}),i(e.getBlocks()).each(function(e){e.destroy()}),e.setBlocks([]),e.setDragAreas([]),e.setTotalBlocks(0)},bindEvent:function(e,t){return n.EditMode.prototype.bindEvent.call(this,e+".ccm-area-a"+this.getId(),t)},scanBlocks:function(){var e,i,o=this;o.reset(),o.addDragArea(null),t("div.ccm-block-edit[data-area-id="+o.getId()+"]",this.getElem()).each(function(){var s=t(this),a=s.data("block-type-handle");e="core_area_layout"===a?n.Layout:"core_stack_display"===a?n.StackDisplay:n.Block,i=new e(s,o.getEditMode()),i.setArea(o),o.addBlock(i)})},getBlockByID:function(e){var t=this;return i.findWhere(t.getBlocks(),{id:e})},getMenuElem:function(){var e=this;return t("[data-area-menu=area-menu-a"+e.getId()+"]")},bindMenu:function(){var e,o=this,s=o.getElem(),a=o.getTotalBlocks(),r=o.getMenuElem();e=a>0?"#area-menu-footer-"+o.getId():"div[data-area-menu-handle="+o.getId()+"]",o.getAttr("menu")&&o.getAttr("menu").destroy();var c={handle:e,highlightClassName:"ccm-area-highlight",menuActiveClass:"ccm-area-highlight",menu:t("[data-area-menu="+s.attr("data-launch-area-menu")+"]")};o.getElem().hasClass("ccm-global-area")&&(c.menuActiveClass+=" ccm-global-area-highlight",c.highlightClassName+=" ccm-global-area-highlight"),o.setAttr("menu",new ConcreteMenu(s,c)),r.find("a[data-menu-action=add-inline]").off("click.edit-mode").on("click.edit-mode",function(e){var s=!1;return i.each(o.getBlocks(),function(e){s=e}),n.event.fire("EditModeBlockAddInline",{area:o,cID:CCM_CID,btID:t(this).data("block-type-id"),arGridMaximumColumns:t(this).attr("data-area-grid-maximum-columns"),event:e,dragAreaBlock:s,btHandle:t(this).data("block-type-handle")}),!1}),r.find("a[data-menu-action=edit-container-layout]").off("click.edit-mode").on("click.edit-mode",function(e){var o=t(this),s=parseInt(t(this).attr("data-container-layout-block-id")),a=n.getEditMode(),r=i.findWhere(a.getBlocks(),{id:s});return n.event.fire("EditModeBlockEditInline",{block:r,arGridMaximumColumns:o.attr("data-area-grid-maximum-columns"),event:e}),!1}),r.find("a[data-menu-action=edit-container-layout-style]").off("click.edit-mode").on("click.edit-mode",function(e){e.preventDefault();var o=(t(this),parseInt(t(this).attr("data-container-layout-block-id"))),s=n.getEditMode(),a=i.findWhere(s.getBlocks(),{id:o});n.event.fire("EditModeBlockEditInline",{block:a,event:e,action:CCM_DISPATCHER_FILENAME+"/ccm/system/dialogs/block/design"})}),r.find("a[data-menu-action=area-add-block]").off("click.edit-mode").on("click.edit-mode",function(e){var t=o.getMaximumBlocks();return t<0||t>o.getTotalBlocks()?n.event.fire("EditModeAddBlocksToArea",{area:o}):ConcreteAlert.error({message:ccmi18n.fullArea}),!1}),o.bindEvent("ConcreteMenuShow",function(e,t){if(t.menu==o.getAttr("menu")){var i=o.getMaximumBlocks(),n=t.menu.$menuPointer.find("a[data-menu-action=area-add-block]").parent();i<0||i>o.getTotalBlocks()?n.show():n.hide()}}),r.find("a[data-menu-action=edit-area-design]").off("click.edit-mode").on("click.edit-mode",function(e){e.preventDefault(),ConcreteToolbar.disable(),o.getElem().addClass("ccm-area-inline-edit-disabled");var i={arHandle:o.getHandle(),cID:CCM_CID};o.bindEvent("EditModeExitInline",function(e){n.event.unsubscribe(e),o.getEditMode().destroyInlineEditModeToolbars()}),t.ajax({type:"GET",url:CCM_DISPATCHER_FILENAME+"/ccm/system/dialogs/area/design",data:i,success:function(e){var i=o.getElem();o.getEditMode().loadInlineEditModeToolbars(i,e),t.fn.dialog.hideLoader()}})})},acceptsBlockType:function(e){return i(this.getBlockTypes()).contains(e.toLowerCase())},addBlock:function(e,t){var n=this;return t?this.addBlockToIndex(e,i(n.getBlocks()).indexOf(t)+1):this.addBlockToIndex(e,n.getBlocks().length)},setTotalBlocks:function(e){this.setAttr("totalBlocks",e),this.getElem().attr("data-total-blocks",e)},addBlockToIndex:function(e,t){var i=this.getTotalBlocks(),n=this.getBlocks(),o=i-t;if(e.setArea(this),this.setTotalBlocks(i+1),o>0){for(var s=[],a=0;a<n.length;a++)a>=t?s[a+1]=n[a]:s[a]=n[a];s[t]=e,this.setBlocks(s)}else this.getBlocks()[t]=e;return this.addDragArea(e),e.getElem().attr("data-area-id",this.getId()),!0},removeBlock:function(e){var t=this,n=t.getTotalBlocks();t.getElem().removeClass("ccm-parent-menu-item-active"),e.getContainer().remove(),t.setBlocks(i(t.getBlocks()).without(e)),t.setTotalBlocks(n-1);var o=i.first(i(t.getDragAreas()).filter(function(t){return t.getBlock()===e}));return o&&(o.getElem().remove(),t.setDragAreas(i(t.getDragAreas()).without(o))),t.getTotalBlocks()||t.bindMenu(),!0},addDragArea:function(e){var o,s,a=this;if(e)o=t('<div class="ccm-area-drag-area"/>'),s=new n.DragArea(o,a,e),e.getContainer().after(o);else{if(a.getDragAreas().length)throw new Error("No block supplied");o=t('<div class="ccm-area-drag-area"/>'),s=new n.DragArea(o,a,e),a.getBlockContainer().prepend(o)}return a.getElem().parent().is("#ccm-stack-container")||o.text(i(ccmi18n.emptyArea).template({area_handle:a.getElem().data("area-display-name")})),a.getDragAreas().push(s),s},contendingDragAreas:function(e,t){var o=this,s=o.getMaximumBlocks();return t instanceof n.Stack||"core_stack_display"===t.getHandle()?i(o.getDragAreas()).filter(function(i){return i.isContender(e,t)}):s>0&&o.getBlocks().length>=s||!i(o.getBlockTypes()).contains(t.getHandle())?[]:i(o.getDragAreas()).filter(function(i){return i.isContender(e,t)})}}}(window,jQuery,_,Concrete),function(e,t,i,n){"use strict";var o=n.Layout=function(e,t){this.init.apply(this,i(arguments).toArray())};o.prototype=i.extend(Object.create(n.Block.prototype),{init:function(e,i){var o=this;o.bindEvent("EditModeInlineEditLoaded.editmode",function(e,t){t.block===o&&o.bindDrag()}),n.Block.prototype.init.call(o,e,i,t()),e.children(".ccm-block-cover").remove()},bindDrag:function(){var e=this,i=t('a[data-layout-command="move-block"]').parent();t.pep.unbind(i),i.pep(e.getPepSettings())},addToDragArea:function(){n.Block.prototype.addToDragArea.apply(this,i.toArray(arguments));var e=t("#ccm-inline-toolbar-container");e.css({top:this.getElem().offset().top-e.outerHeight()-5})}})}(window,jQuery,_,Concrete),function(e,t,i,n){"use strict";var o=n.DragArea=function(e,t,n){this.init.apply(this,i.toArray(arguments))};o.prototype={init:function(e,t,o){var s=this;n.createGetterSetters.call(s,{block:o,active:!0,elem:e,area:t,isContender:!1,isSelectable:!1,animationLength:500}),s.bindEvent("EditModeContenders",function(e,t){s.setIsContender(i.contains(t,s))}),s.bindEvent("EditModeSelectableContender",function(e,t){s.setIsSelectable(t===s)})},destroy:function(){var e=this;e.getElem().remove()},bindEvent:function(e,t){return n.EditMode.prototype.bindEvent.apply(this,i(arguments).toArray())},getActive:function(){return this.getArea().getActive()&&this.getAttr("active")},isSelectable:function(e,t){return e.isOverlapping(t.getDragger(),this.getElem())},setIsSelectable:function(e){var t=this;return e&&!t.getIsSelectable()?(t.getArea().getElem().addClass("ccm-parent-menu-item-active"),t.getElem().addClass("ccm-area-drag-area-selectable")):!e&&t.getIsSelectable()&&(t.getArea().getElem().removeClass("ccm-parent-menu-item-active"),t.getElem().removeClass("ccm-area-drag-area-selectable")),t.setAttr("isSelectable",e),!0},isContender:function(e,t){var n=this;return i.identity(e),n.getBlock()!==t},setIsContender:function(e){var t=this;return e&&!t.getIsContender()?i.defer(function(){t.getElem().addClass("ccm-area-drag-area-contender")}):!e&&t.getIsContender()&&i.defer(function(){t.getElem().removeClass("ccm-area-drag-area-contender")}),t.setAttr("isContender",e),!0},centerDistanceToBlock:function(e){var t=this,i=e.getDragger(),n={x:i.offset().left+i.width()/2,y:i.offset().top+i.height()/2},o=t.getElem(),s={x:o.offset().left+o.width()/2,y:o.offset().top+o.height()/2};return Math.sqrt(Math.pow(Math.abs(n.x-s.x),2)+Math.pow(Math.abs(n.y-s.y),2))}}}(window,jQuery,_,Concrete),function(e,t,i,n){"use strict";var o=n.BlockType=function(e,t,n,o){this.init.apply(this,i(arguments).toArray())};o.prototype=i.extend(Object.create(n.Block.prototype),{init:function(e,t,o,s){var a=this;if(n.Block.prototype.init.apply(a,i(arguments).toArray()),a.setAttr("defaultArea",s||null),s){s.getBlockTypes();s.acceptsBlockType(a.getHandle())?a.handleDefaultArea():a.removeElement()}},handleDefaultArea:function(){var e=this;t.pep.unbind(e.getPeper()),e.getPeper().click(function(t){return e.handleClick(),!1}).css({cursor:"pointer"})},removeElement:function(){var e=this.getPeper().closest(".ccm-panel-content-inner");this.getPeper().closest("li").remove(),e.children(".ccm-panel-add-block-set").each(function(){var e=t(this).children("ul");e.children().length||t(this).remove()})},handleClick:function(){var e=this,t=e.getAttr("defaultArea");ConcretePanelManager.exitPanelMode(function(){i.defer(function(){e.addToDragArea(i.last(t.getDragAreas()))})})},pepStart:function(e,t,o){var s,a=this;n.Block.prototype.pepStart.call(this,e,t,o),a.setAttr("closedPanel",i(ConcretePanelManager.getPanels()).find(function(e){return e.isOpen})),(s=a.getAttr("closedPanel"))&&s.hide()},pepStop:function(e,t,o){var s,a,r=this;(s=r.getSelected())?r.addToDragArea(s):(a=r.getAttr("closedPanel"))&&a.show(),i.defer(function(){n.event.fire("EditModeBlockDragStop",{block:r,pep:o,event:t})}),r.getDragger().remove(),r.setAttr("dragger",null)},addToDragArea:function(e){var n=this,o=n.getElem(),s=o.data("btid"),a=o.data("cid"),r=e.getArea(),c=r.getHandle(),l=r.getEnableGridContainer()?1:0,d=0,p=e.getBlock(),u=!!o.data("supports-inline-add"),h=!!o.data("has-add-template");if(p&&(d=p.getId()),jQuery.fn.dialog.closeAll(),h)if(u)ConcreteEvent.fire("EditModeBlockAddInline",{selected:e,area:e.getArea(),cID:a,arEnableGridContainer:l,btID:s,dragAreaBlockID:d});else{var f=r.getCustomTemplates(),m="";if(f)for(var g in f)m+="&arCustomTemplates["+g+"]="+f[g];t.fn.dialog.open({onOpen:function(){t(function(){var i=t('<div style="display:none" />');e.getElem().after(i),t("#ccm-block-form").concreteAjaxBlockForm({task:"add",dragAreaBlockID:d,dragArea:e,placeholder:i})})},onDestroy:function(){var e=ConcretePanelManager.getByIdentifier("add-block");e&&e.pinned()&&e.show()},width:parseInt(o.data("dialog-width"),10),height:parseInt(o.data("dialog-height"),10)+20,title:o.data("dialog-title"),href:CCM_DISPATCHER_FILENAME+"/ccm/system/dialogs/page/add_block?cID="+a+"&btID="+s+"&arHandle="+encodeURIComponent(c)+m})}else{var v={cID:a,arHandle:c,btID:s,mode:"edit",processBlock:1,add:1,ccm_token:CCM_SECURITY_TOKEN,arCustomTemplates:r.getCustomTemplates(),dragAreaBlockID:d},f=r.getCustomTemplates();if(f)for(var g in f)v[v.length]={name:"arCustomTemplates["+g+"]",value:f[g]};t.getJSON(CCM_DISPATCHER_FILENAME+"/ccm/system/dialogs/page/add_block/submit",v,function(e){t.fn.dialog.showLoader(),ConcreteToolbar.disableDirectExit(),t.get(CCM_DISPATCHER_FILENAME+"/ccm/system/block/render",{arHandle:r.getHandle(),cID:a,bID:e.bID,arEnableGridContainer:l},function(e){p?p.getContainer().after(e):r.getBlockContainer().prepend(e),t.fn.dialog.hideLoader(),i.defer(function(){n.getEditMode().scanBlocks()});var o=ConcretePanelManager.getByIdentifier("add-block");o&&o.pinned()&&o.show()})})}}})}(window,jQuery,_,Concrete),function(e,t,i,n){"use strict";var o=n.Stack=function(e,t,n){this.init.apply(this,i(arguments).toArray())};o.prototype=i.extend(Object.create(n.BlockType.prototype),{removeElement:function(){this.getElem().remove()},addToDragArea:function(e){var i=this,n=i.getElem(),o=e.getArea(),s=o.getHandle(),a=0,r=e.getBlock();r&&(a=r.getId()),jQuery.fn.dialog.closeAll();var c={cID:n.data("cid"),arHandle:s,stID:n.data("sid"),atask:"add_stack",ccm_token:CCM_SECURITY_TOKEN};a&&(c.dragAreaBlockID=a),t.fn.dialog.showLoader(),t.getJSON(CCM_DISPATCHER_FILENAME,c,function(e){i.handleAddResponse(e,o,r)})},showSuccessfulAdd:function(){ConcreteAlert.notify({message:ccmi18n.addBlockStackMsg,title:ccmi18n.addBlockStack})}})}(window,jQuery,_,Concrete),function(e,t,i,n){"use strict";var o=n.DuplicateBlock=function(e,t,n){this.init.apply(this,i.toArray(arguments))};o.prototype=i.extend(Object.create(n.BlockType.prototype),{init:function(e,t,i){var o=this;n.BlockType.prototype.init.call(o,e,t,e.find(".block-content"),i)},handleDefaultArea:function(){var e=this;t.pep.unbind(e.getPeper()),e.getPeper().click(function(t){return e.handleClick(),!1}).css({cursor:"pointer"}).children(".block-name").css({cursor:"pointer"})},removeElement:function(){this.getElem().remove()},addToDragArea:function(e){var i=this,n=i.getElem(),o=n.data("btid"),s=e.getArea(),a=s.getHandle(),r=0,c=n.data("cid"),l=e.getBlock(),d=n.data("pcid");l&&(r=l.getId()),ConcretePanelManager.exitPanelMode(),jQuery.fn.dialog.closeAll(),jQuery.fn.dialog.showLoader();var p={cID:c,arHandle:a,btID:o,mode:"edit",processBlock:1,add:1,btask:"alias_existing_block",pcID:[d],ccm_token:CCM_SECURITY_TOKEN};r&&(p.dragAreaBlockID=r),t.getJSON(CCM_DISPATCHER_FILENAME,p,function(e){i.handleAddResponse(e,s,l,function(){ConcreteEvent.fire("EditModeAddClipboardComplete",{block:i})})})}})}(window,jQuery,_,Concrete),function(e,t,i,n){"use strict";var o=n.StackBlock=function(e,t,n,o){this.init.apply(this,i.toArray(arguments))};o.prototype=i.extend(Object.create(n.BlockType.prototype),{init:function(e,t,i,o,s){n.BlockType.prototype.init.call(this,e,i,o,s),this.setAttr("stack",t)},removeElement:function(){t.pep.unbind(this.getPeper())},addToDragArea:function(e){var i=this,n=i.getElem(),o=n.data("btid"),s=e.getArea(),a=s.getHandle(),r=0,c=e.getBlock();c&&(r=c.getId()),ConcretePanelManager.exitPanelMode();var l={cID:CCM_CID,bID:n.data("block-id"),arHandle:a,btID:o,mode:"edit",processBlock:1,add:1,btask:"alias_existing_block",pcID:[n.data("cID")],ccm_token:CCM_SECURITY_TOKEN};r&&(l.dragAreaBlockID=r),t.getJSON(CCM_DISPATCHER_FILENAME,l,function(e){i.handleAddResponse(e,s,c)})}})}(window,jQuery,_,Concrete),function(e,t){"use strict";function i(e,i){var n=this;i=t.extend({},i||{}),ConcreteMenu.call(n,e,i)}i.prototype=Object.create(ConcreteMenu.prototype),i.prototype.setupMenuOptions=function(e){var i=this,n=ConcreteMenu.prototype,o=i.$element.closest("tr").data("collection-id");n.setupMenuOptions(e);var s=e.find("a[data-action=rename]");s.attr("href",s.data("href-template").replace("__folderID__",o)),e.find("a[data-action=delete]").on("click",function(){return t("#ccm-dialog-delete-stackfolder").find("input[name=stackfolderID]").val(o).end().dialog({modal:!0,width:320,height:"auto",resizable:!1}),!1})},t.fn.concreteStackMenu=function(e){return t.each(t(this),function(n,o){new i(t(this),e)})},e.ConcreteStackMenu=i}(this,$);