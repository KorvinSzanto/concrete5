!function(e,t){"use strict";function n(e,n){var o=this;n=t.extend({},n),ConcreteAjaxSearch.call(o,e,n)}n.prototype=Object.create(ConcreteAjaxSearch.prototype),n.launchDialog=function(e,n){var o=t(window).width()-53;t.fn.dialog.open({width:o,height:"100%",href:CCM_DISPATCHER_FILENAME+"/ccm/system/dialogs/express/entry/search/"+e,modal:!0,title:ccmi18n_express.entriesTitle,onClose:function(){ConcreteEvent.fire("ExpressEntrySelectorClose")},onOpen:function(){ConcreteEvent.unsubscribe("SelectExpressEntry"),ConcreteEvent.subscribe("SelectExpressEntry",function(e,t){jQuery.fn.dialog.closeTop(),n(t)})}})},n.getEntryDetails=function(e,n){t.ajax({type:"post",dataType:"json",url:CCM_DISPATCHER_FILENAME+"/ccm/system/express/entry/get_json",data:{exEntryID:e},error:function(e){ConcreteAlert.dialog("Error",e.responseText)},success:function(e){n(e)}})},t.fn.concreteExpressPageAjaxSearch=function(e){return t.each(t(this),function(o,s){new n(t(this),e)})},e.ConcreteExpressEntryAjaxSearch=n}(window,$),!function(e,t){"use strict";function n(e,n){var o=this,n=t.extend({chooseText:ccmi18n_express.chooseEntry,loadingText:ccmi18n.loadingText,inputName:"entryID",entityID:!1,entryID:0},n);o.$element=e,o.options=n,o._chooseTemplate=_.template(o.chooseTemplate,{options:o.options}),o._loadingTemplate=_.template(o.loadingTemplate),o._entryLoadedTemplate=_.template(o.entryLoadedTemplate),o.$element.append(o._chooseTemplate),o.$element.on("click","a[data-express-entry-selector-link=choose]",function(e){e.preventDefault(),ConcreteExpressEntryAjaxSearch.launchDialog(n.entityID,function(e){o.loadEntry(e.exEntryID)})}),o.options.exEntryID&&o.loadEntry(o.options.exEntryID)}n.prototype={chooseTemplate:'<div class="ccm-item-selector"><input type="hidden" name="<%=options.inputName%>" value="0" /><a href="#" data-express-entry-selector-link="choose"><%=options.chooseText%></a></div>',loadingTemplate:'<div class="ccm-item-selector"><div class="ccm-item-selector-choose"><input type="hidden" name="<%=options.inputName%>" value="<%=exEntryID%>"><i class="fa fa-spin fa-spinner"></i> <%=options.loadingText%></div></div>',entryLoadedTemplate:'<div class="ccm-item-selector"><div class="ccm-item-selector-item-selected"><input type="hidden" name="<%=inputName%>" value="<%=entry.exEntryID%>" /><a data-express-entry-selector-action="clear" href="#" class="ccm-item-selector-clear"><i class="fa fa-close"></i></a><div class="ccm-item-selector-item-selected-title"><%=entry.label%></div></div></div>',loadEntry:function(e){var t=this;t.$element.html(t._loadingTemplate({options:t.options,exEntryID:e})),ConcreteExpressEntryAjaxSearch.getEntryDetails(e,function(e){var n=e.entries[0];t.$element.html(t._entryLoadedTemplate({inputName:t.options.inputName,entry:n})),t.$element.on("click","a[data-express-entry-selector-action=clear]",function(e){e.preventDefault(),t.$element.html(t._chooseTemplate)})})}},t.fn.concreteExpressEntrySelector=function(e){return t.each(t(this),function(o,s){new n(t(this),e)})},e.ConcreteExpressEntrySelector=n}(this,$);