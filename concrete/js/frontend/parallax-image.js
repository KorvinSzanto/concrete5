!function(e,t){"use strict";var i=function(i,s){this.$element=t(i),this.$image=null,this.image=null,this.settings=t.fn.extend({variation:0,speed:.25,window:e},s),this.settings.variation&&(this.settings.speed=this.settings.variation/this.$element.height()/5),this.$window=t(this.settings.window)};i.prototype={init:function(){var i=this,s=t("<div/>").addClass("parallax-image-container"),n=new Image;n.onload=function(){i.image=n,i.$image=t(n).addClass("parallaxic-image"),i.bindListeners(),e.setTimeout(function(){i.handleResize(),i.render(),s.append(i.$image.hide().fadeIn())},0)},n.src=this.$element.data("background-image"),this.$element.addClass("parallaxic-container").prepend(s)},bindListeners:function(){var e=this;this.$window.on("resize",function(t){e.handleResize(),e.render()}).on("scroll",function(t){e.handleScroll(),e.render()})},handleResize:function(){var e=this.getFrame();e.determineScale(this),e.determineOffsetLeft(this),this.handleScroll()},handleScroll:function(){var e;this.isVisible()&&(e=this.getFrame(),e.determineOffsetTop(this),e.determineParallax(this))},isVisible:function(){var e=this.$window.scrollTop(),t=this.$window.height(),i=this.$element.offset().top,s=this.$element.height();return e+t>i&&e<i+s},render:function(){this.getFrame().render(this)},getFrame:function(){return this.frame||(this.frame=new s),this.frame}};var s=function(){this.scale=1,this.offset={x:0,y:0}};s.prototype={determineScale:function(e){var t,i=e.image.height,s=e.image.width,n=e.$window.height(),a=e.$element.height(),h=e.$element.width(),r=e.settings.speed,l=r*(n+a),o=a+l;s<h||i>o?(t=h/s,i*t>=o?this.scale=t:this.scale=o/i):this.scale=o/i,this.scale=Math.ceil(1e3*this.scale)/1e3},determineOffsetLeft:function(e){var t=e.image.width,i=e.$element.width(),s=t*this.scale,n=s-t+(i-s);this.offset.x=n/2},determineOffsetTop:function(e){var t=e.image.height,i=t*this.scale,s=i-t;this.offset.y=s/2},determineParallax:function(e){var t,i=e.settings.speed,s=e.$element,n=s.offset(),a=e.$window.scrollTop();t=a-n.top,this.offset.y+=t*i},render:function(e){var t="";t+="translate3d("+this.offset.x+"px,"+this.offset.y+"px, 0) ",t+="scale3d("+this.scale+","+this.scale+","+this.scale+")",e.$image.get(0).style.transform=t}},t.fn.parallaxize=function(e){var s,n=t(this);return n.data("parallax")?s=n.data("parallax"):(s=new i(this,e),t(this).data("parallax",s),s.init()),s}}(this,jQuery);